Title: Excel VBA Expert Tutorial
Channel: Learn Skills Daily
Video ID: tGHLa1TnhLc
URL: https://www.youtube.com/watch?v=tGHLa1TnhLc
Duration: 1:14:26
Level: EXPERT
======================================================================

Table of Contents:
- 0:00 Start
- 0:03 Worksheets Methods
- 3:28 DateSerial and Format
- 13:32 Sheet Template Generator
- 20:21 Move
- 23:40 PrintOut and PrintPreview
- 25:51 Practice (Part 1)
- 34:20 Practice (Part 2)
- 35:54 Practice (Part 3)
- 37:38 Practice (Part 4)
- 41:11 Practice (Part 5)
- 51:48 Practice (Part 6)
- 54:18 Custom Functions (Part 1)
- 1:01:01 Custom Functions (Part 2)
- 1:04:32 Custom Functions (Part 3)
- 1:14:07 Wrapping Up

Key Topics Covered:

1. WORKSHEET METHODS
- Add, Delete, Copy worksheets
- Rename worksheets
- Move worksheets within workbook
- Hide/Unhide worksheets
- Protect/Unprotect worksheets

2. DATE FUNCTIONS
- DateSerial function for creating dates
- Format function for date formatting
- Working with months and years
- Date calculations and manipulation

3. SHEET TEMPLATE GENERATOR
- Creating automated sheet templates
- Generating multiple sheets programmatically
- Naming conventions for sheets
- Looping through months/periods

4. MOVE AND COPY OPERATIONS
- Moving sheets between positions
- Copying sheets to new locations
- Before and After parameters
- Working with sheet references

5. PRINTING
- PrintOut method for direct printing
- PrintPreview method
- Setting print areas
- Page setup options

6. CUSTOM FUNCTIONS (User-Defined Functions)
- Creating custom functions in VBA
- Function vs Sub procedures
- Passing parameters to functions
- Return values from functions
- Using custom functions in worksheets
- Practical examples of UDFs

7. ADVANCED PRACTICE EXERCISES
- Combining multiple VBA concepts
- Real-world automation scenarios
- Error handling and debugging
- Code optimization techniques

======================================================================
FULL TRANSCRIPT:

### Result
"Chelsea Dohemann: In the next few\nexamples, we're going to want to be able to take content from multiple\ndifferent sources and then paste it on some kind of extra sheet at the\nend, just for consolidation purposes. Or maybe you want to be able to take\na sheet that's sort of like a template sheet, and then you want to be able to\nreproduce it 12 times for every month of the year or 10 times for every year\nin a decade or something like that in order to be able to create specialized\nversions of that particular template. If you want it to be able to do that,\nyou're going to have to start to play with sheets and know how to use\nthe coding that's required to do. So we've already seen the\nfeature called worksheets.name. Now you're going to need\nto specify exactly which worksheets you're talking about. So let's go ahead and add a couple so\nthat we actually have something to name. There's also a method\ncalled worksheets dot. And if you execute it, you'll see\nthat you have another sheet that's actually being added into our workbook. Now this sheet is called sheet three,\nbut technically it's not worksheet three. It's actually worksheet one. It's worksheet one, because that's\nthe order that it is an Excel. There are a couple of different\nways that we can refer to a sheet. What we can do is we can say\nworksheets worksheets, one, that's going to refer to whatever the very\nfirst worksheet is in my workbook. And then I could say select. Now that's going to select the very\nfirst ordered worksheet in my workbook. If I wanted to select the\nsecond one, I would use two. Now I've selected the second one, or if\nI want to actually use the name of the worksheet in those parentheses, I can\nactually put in the name of the worksheet. Instead in different cases, you\nwant to be able to know that both of these are possible. And that is selected the sheet called\nnumber two, which of course isn't actually number two, but that's what it's called. If I wanted to rename this, I\ncould say worksheets, and we'll say, we want to rename this one. That's currently called number two and\nI'll refer to it by its numerical value. It's the third sheet in order. So I'll say worksheets three\nand the name is something else. And that changes the name\nof my worksheet here. Now, if I want it to be able to copy\nand paste to these worksheets over and over and over again, what we're\ngoing to be doing is using a couple of features, including after what\nwe're going to be doing is using the worksheet stock add feature. And then later on, we're going to be\nseeing the worksheets dot copy feature, and we're going to need to do that\nactually within a macro, but these are the basics of that particular printer. And if at some point I decided\nlater on that I wanted to delete one of my worksheets. I could of course say worksheets. And we'll say, it's the very first\none in order that we want to delete worksheets one delete, and I will get\nthis little window that pops up that says, are you sure you want to do that? That's a normal Excel window. Yes, I'm sure I'm going to go\nahead and click on delete if you haven't done so already. Why don't you run over the principles\nof worksheets dot, add worksheets, select the few different naming\nconventions that we have for specifying a specific worksheet, renaming that\nworksheet and deleting a worksheet. Why don't you go ahead and give\nit a shot and come on back. So the next particular large exercise\nthat we're going to be employing, we're going to need to know a couple\nof other little extra helpful tidbits. These are functions, essentially. They're going to be able\nto figure something out. There's one called date cereal. And there's one called format. Now, normally both of these do\ndeal with numbers, specifically dates in both of these cases. And we're going to figure out\nright now how to actually use them. Now, these are simple examples. And if you open up the file called\ndate, serial and format, that's going to walk you through how\nto actually use both of these. There are little guides on here\nthat give you an example of code that could be used to exemplify each\none of these particular functions. Although I'm not going to be focusing\non those little help windows right now, cause we're going to be doing it together. So let's say for instance, that I\nneed to be able to populate all the dates in the given month, or maybe\nI just need to populate exactly 30 dates in this particular month. For whatever reason I have, what\nI can do is create a macro that is going to cycle through all the\ndates in order in this particular. No, I, in my spreadsheet here, there\nare a couple of functions here that are just checking and seeing which month\nit is right now and what year it is. So basically I want my macro to be able\nto pick up the current month value and the current year value, and then be\nable to cycle through the different days that might be in this particular month. And let's just say, we're\ngoing to focus on 30 for now. Maybe whatever our practices requires\nus to actually only have 30 days. So I'm going to be creating\na four next statement. That's going to be able to cycle\nthrough and make the first date and then make the second date and then\nmake us the third date of the month, et cetera, all the way through, until 30. So I am going to have a for next\nloop, and this is going to look like this four X equals one to 30. We're just going to keep it simple for. And then we're going to start\nusing a tactic that allows Excel to figure out exactly where it\nshould place a particular value. So I'm going to say in a particular\nrange, we'll start with cell D five. We want it to, uh, insert a value\nin that particular cell, but in this second iteration of this, for next loop,\nI want to go to the next cell down. And after that, I want to\ngo to the next cell down. So in this case, what I'm going to\nbe doing is Eugene, my range tool. And since I'm counting up\narose here, I can actually get it to count up rows for me. Now, of course, I could\nalso use cells here. I just happened to be using range\nbecause we're talking about rows. Those are numerical. And so I can count them up, but\nif I needed to count up columns, I would probably use cells instead. Anyway. So, uh, we're looking at range. All of these values do\nhappen to be in column D. So I'm going to go ahead and put that in. Now I'm starting with D four, but I'm not\ngoing to type that in here because I'm going to allow VBA to figure out what D. And then the combination of four plus X. So in this first case, the first\ntime I go through my iteration, X is going to be equal to one. So this is going to start on D\nfive, which is four plus one. And then the second time it goes through\nit, it's going to go to D six, which is X equals two D starting with four plus two. So it would be D six. And then the second time it would\nbe D seven and the third time it would be D eight, et cetera. So I'm actually going to let VBA here,\nfigure out what cell it should be placing this particular value in by\ncounting up using my, for next loop. And then I'm going to say the\nvalue in that particular cell should be a particular numerical\nvalue in this case, a date. And I'm going to use a function\ncalled date serial, which allows me to put in portions of the date that\nI can rely on like month and year. And then I can allow my, for next loop\nto actually loop through the values for days by saying that it equals X. So the first time it enters it in, it's\ngoing to be the first date of the month. And the second time it will be the\nsecond date of the month, et cetera. Now here's how the date\nserial function works. I do need to put in of course, the\nname, which is date serial, and then I'm going to open up my parentheses and\nyou'll see here in the hint window that it says the year has to be an integer. So maybe I want to pick up that integer\nfrom my actual spreadsheet here. If I want to do that, I'm\nprobably going to end up storing that content in a variable. So I'm going to need to\ncreate a couple of variables. First of all, let's start off with\nex that's going to be for next. And then let's say we're going\nto store the information for month and year, both as integers. And that's how they show up\nin my data set here in Excel. So that's going to be fine. So dim and we'll call it\nmonth value as integer, and then we'll make another\none for a year value. And then we can actually declare\nwhat these are going to be in our particular circumstance. Our current month value is\nalways going to be here. Our current year value is\nalways going to be here so I can just do a simple plugin here. So month value is going\nto be range cell B five, the value of that cell and your value. It's going to be range C5. And the value in that. So it's going to be grabbing\nthose integers and storing them in these particular variables. And then what I can do is\nactually use these variables in my date, serial function. And my date serial function requires me\nto first plug in the year as an integer. Now, the good thing is that I actually\nalready have that stored in that variable that we created in plugged in. So I'm going to say, use my year value\nas the year, and then it needs the month. So I'll say here's my\nmonth value as the month. And then the day, this can be my X. So I do need to put in a next X at the\nend, which I do have, and I'm going to go ahead and run this and it should\npopulate all the days of the month. And there we go nicely, just like. Now let's say I want to be able to\nformat these in a particular way. Maybe I even want to get these\ndates to show up as day as in Wednesday and then the date and\nthen the month, and then the year. And for whatever reason, I'm going to need\nto group this content later on, I'm going to need to actually use it as text values. So I don't want to Excel converting\nit into numerical values. I don't want the serial number\nassociated with it anymore. This date, serial function, this actually\ndoes take into account this serial number and it stores the serial number. And you'll notice that because if\nyou click on any of these cells, go to your home tab and go back\nto general, you'll see that the serial number is actually associated\nwith that particular date value. That's what we're used to\nseeing, but maybe I want to be able to store these as text. If I want to do that, then\nI'm going to need to use a different kind of a function. And this is going to\nbe the format function. Now I'm going to create a couple\nof variables here, cause I'm going to be doing a for next loop again. I have my X and that is\ngoing to be an integer. And then I'm actually going\nto get my spreadsheet to pull the date from right here. That's just going to make it\neasier for our example right now. So I am going to create a variable\nthat's meant to store the date. So I'm going to say date value as\ndate and yes, date is a data type. It's one of the data types\nthat we talked about earlier. And then I could say for X equaling, 1, 2\n30, just like before, and then I am going to need to grab this date value here. So let's go ahead and state\nthe very first date value here. So I could say date value equals\nthe range of whatever cell we're in. We know it's going to be\nsomewhere in column D. And we're going to let the for next\nloop figure out for us what the row is by using four plus X, just\nlike we did in the last example. So that's actually going to\nstore the date value that was already in that particular cell. And you don't have to put spaces in here. I just prefer to see them like that. And then what I'm going to do is\nactually use that content to paste in the range, that same range, so D whatever four-plus exes, and I\nwanted to use this format function. Now the format function is going\nto be able to use the date value. And then I get to specify exactly\nhow I want to format this date value. And we'll say it's long date. I do need the end of my next loop. And there it is at the bottom. I do have my next X that already came in\nwith this macro before we even got it. Okay. And if I run this, this is going to\ndisplay for me all of the long date versions of each one of these dates, but\nyou will notice that in these cells, I don't actually have this serial number. This has now been converted to text. So the difference between using date\nserial and using format is that date serial actually maintains dates as a\nparticular serial number and format allows you to convert them into text values. Just pretty cool. Why don't you go ahead and give this\na shot, finish out your macro here, test it out and make sure that indeed\nthese are being stored as text values. And when you're done, come on\nback for the next couple examples. We're going to have to become a little\nbit more familiar with the copy method. Now, in this case, we're\ntalking about the copy method. That is a method of\nthe worksheets objects. Uh, the deal with the copy method\nis that it actually inherently also includes a paste method. Uh, if you copy it, you\nare going to paste it. And so they're built into the same tool. So if you want to copy a particular\nsheet and place it somewhere, you are going to need to specify\nexactly where you want to place it. And so now we start to get methods that\nhave these specifications afterwards, in which we specify exactly how we\nwant this method to behave in this particular case, we choose exactly where\nwe want it to be pasted, essentially. So in this case, before worksheet\nfour, or in the second case here after worksheet two, these are called arguments\nof methods and we're going to be using them in the next example, right here,\nyou're going to want to open up the file called sheet template generator. And essentially what we're going to be\ndoing here is taking this very first sheet, which is a template sheet. If you will, this is a design that I want\nto be able to create over and over and over again for every month of the year. Now I'm going to create a for next loop\nin order to be able to create 12 of these. And in order to name them after\nI've created them, I'm going to use the date serial and format\nfunctions, which are gonna allow me to cycle through months of the year. So if you open up your visual basic for\napplications window, you'll see that there's already some macro code here. Now I'm going to go ahead\nand do this from scratch. But if you don't want\nto, you don't have to. And I'm going to start off by declaring\nmy variable, which is going to be X. And this is going to be an integer\nvariable because it's going to be used in my, for next loop. So for X equals one to 12,\nbecause I want to create 12 of them for every month of the year. And then I'll say worksheets\nspecifically the very first one. I want to copy it. And after I've copied it, I want to\nplace it in a specific spot, which in this case is going to be after\nworksheet, whichever worksheets. So the first time I go through this, I\nwant to paste it after worksheet one. The second time I do this, I'm going to\nwant to paste it after worksheet two. So think about it like this. If I already have a sheet in here and\nI'm going to be pacing this after sheet one, that basically makes this thing\nthat I'm pasting now worksheet two. So that's now become worksheet two. So if I want to select that worksheet that\nI've just actually put in there, I'm going to have to say, okay, worksheets select. And what most people would do is\nput in the number two here, but I do want this to be able to count up. So it can actually put in a name for\nevery single one of these sheets. So I'm going to say X, but it got\npushed to the second spot there. And the second time I do this is\ngoing to get pushed to the third spot. And the third time I did, this is\ngoing to get pushed to the fourth spot. So I'm just going to say X plus\none, and that's going to figure out exactly which spot it should be in. And I'll see that the name of that word. And this is going to be determined by\nthe date serial and the format functions. The nice thing about the date\ncereal is that it actually uses serial numbers, which is it allows\nit to be able to cycle through numbers and count up pretty quickly. So if I want this sheet to be named by the\nmonth, this particular sheet corresponds to, I could say that the very first time I\ngo through this, I want to name the sheet. After January, January is\nassociated with the number one. And if this is the first time that I'm\ngoing through it, X is associated with the number one to number one, it's\nassociated with the number one as well. So my date serial is going to require\nme to put in a year, but I'm not actually going to end up using the year. Cause all I care about is the month. So I'm just going to put in the\nyear there and it doesn't really matter what year you're using. You could put in year one again, like\nI said, it doesn't matter cause I'm never going to be using the year. I'm only going to end up using the month\nand I'm only using the date cereal because it's a lot it's able to cycle through\nnumbers here that are associated with. Or with days or with years. Okay. So, uh, in my month spot, however,\nI am going to put X there. So the very first time this happens,\nthis state is going to correspond with some kind of a date in January. And the second time it goes through\nit, it's going to correspond with a date in February and the\nthird time with March, et cetera. And I need to put in a day there as well. But again, I don't care about that one. So I don't care about\nyour don't care about day. So I'm just putting one for those. You guys could put whatever\nyou want for those. The only one that I\nreally care about is X. And now that I've actually determined\na date that is in January the first time this happens and February\nthe second time it happens and March the third time it happened. Now I need to make my format function,\ngrab this serial number and be able to extract from it the month. So if you remember from our last lesson\non the format function, it was able to take a serial number associated\nwith the date and then populate. Um, a particular display for that date. And the last case, we just asked it to\nshow the long date, but you can also say, Hey, I want you to show just the month. Now, if you're going to do that,\nyou would simply put in quotations, just like we did last time. But I would use this little coding. Three M's is going to\nbe an abbreviated month. And if you wanted to do four\nM's, that would put the fully spelled out version of the months. You can do whichever one you\nlike, I'm going to do four M's. And that is actually going to pull the\nmonth information from my date serial. So it's cycling, cycling through the first\ntime it goes through it's grabbing January and then the format function is actually\nextracting the word January from this. And I'm using that to name my\nworksheet that I just put in there. Okay. And I'm going to do this\nover and over and over again. So I'm putting in the next act. And then at the very end, when\nwe are all done, I'm going to say, okay, take that template. That very first sheet\nthere, worksheets one. And I want you to delete it. I don't want that one because\nit's not going to have a label that makes any sense. It's just still going to say sheet one. And all I care about is the ones that\nare actually named after the months. All right. So here we go. Now we're going to go ahead and run this. I'm going to go ahead and click on play. And when I do, so Excel is going to say,\nare you sure you want to delete that very first sheet that you can't undo that? And I'm going to say yes. I'm sure. Go ahead and click on delete. And there we go. Now I have 12 months, one for every\nsingle month of the year, and they are all designed based on my template. If you haven't done. So take a second to code your macro\nover here on the right hand side that is supposed to cycle through all of your\nsheets and name them, but only after of course you have copied them and place\nthem after the very first worksheet. Take a second to do that. And then come on back. Welcome back. For this next session, we have the\nchallenge of having a rather large workbook and I have a set number of\nsheets that I want to be able to access. However, they happen to be buried\npretty deep in my workbook. And I'd really like for them to be\nat the beginning of the workbook, when I need to take a look at those\nparticular sheets, the sheets in question or group of sheets that have\nto do with the Southeast division. And you'll see that I have one here\ncalled Southeast team Southeast clients, Southeast marketing, and there's\none more called Southeast sales. And I'd like for these to all be placed\nat the beginning of my workbook, when I am taking care of a project that has\nto do with that particular division. And so I'm going to need to make a macro,\nthat's going to be able to do this. Eventually. If I made a macro for every single one of\nthese divisions, I would probably place them all as buttons on the interface. And then I could easily reorder\nmy workbook whenever I wanted to. We're going to go over an\nexample of just creating a macro. That's going to reorient the Southeast\ndivision to the very front of our work. And then you can extrapolate\nfrom that and do the remaining divisions if you so choose. So in order to do this exercise, we're\ngoing to want to open up the file called reordering sheets and open up\nyour visual basic for applications. Window. Mine is open on the right hand side and\nI am going to find our modules folder go into module one, and I'm looking\nfor the macro called Southeast move. So it should be the second macro\nto collection of macros here. And again, like I said earlier, you\ncan complete the rest of these, if you would like, I'm just going to go ahead\nand do the one for Southeast move. And here we go. So, um, I'm going to use\nworksheets and I'm going to refer to the name of the worksheet. Now I happen to know that the name of\nthis worksheet is going to be S E sales. This is the first one, and I'm\ngoing to use a method called. Now, when we were checking out the\nmethod called copy, we noticed that we had to, uh, put a little argument\nin here that said exactly where it's supposed to be placed afterward in\nthis case, we're going to move it. And we also need an argument that explains\nexactly where we're going to put it. So I'm going to say, move this and place\nit, uh, after or before a certain place. So I could choose after, but I'm going\nto choose before, because my objective is to put this at the very beginning. So I'm going to say before, and I'm\ngoing to put my colon and my equal sign. That is the syntax that is\nused for arguments of methods. And then I'm going to say, put it\nbefore, whatever worksheet is in place. Number one, and I'm going to do this for\nevery single one of the worksheets that has to do with the Southeast division. Why don't you do this to do this for all\nfour of the worksheets and when you're done, come on back and we'll keep. Okay, I've completed that if you haven't\ncompleted it yet, just go ahead and pause the video and complete it with me. I just didn't want you to have to\nwatch me complete all four of these. Uh, but that's basically the task that I\nwant to accomplish here is to be able to move every single one of these sheets that\nhave to do with the Southeastern division. And then when I go ahead and run\nthis macro, you'll see that all of those sheets Southeast, Southeast,\nSoutheast, Southeast, get moved to the very beginning of my workbook. And that's the basics of\nusing the move method. Why don't you go ahead and complete that\nup and then come on back, welcome back. And the last statement that we're\ngoing to need to cover before we do our large macro example to finish out the\nscripting section of the class is going to require us to learn how to print certain\nworksheets, uh, of our given selection. So go ahead and open up the file\ncalled print out print preview. That's going to allow us to\nopen up the, uh, module twofold. Module one will look pretty\nfamiliar that has all of our, um, our move scripting that we did. In the last example, the module\ntwo has a open macro waiting to be scripted called print all sheets. So if you wanted to print all of your\nworksheets at the same time, you could put a little bit of script in here\nthat said worksheets dot printout, but for our purposes, in order to just be\nable to cover this really quick, you don't have to do it here in the macro. We can actually do that\nin the media window. So we can say worksheets dot\nprint out, and I can execute that. And assuming that my computer\nis hooked up to a printer, then obviously it would print it here. But in my case, I am not. And so it is trying to print\nit to some other kind of a file type, but it did work there. Now, there are a couple of different\noptions that we can take a look at here. There's print out, and then\nthere's also print preview. For those of us who thought the print\npreview was actually gone, that it was just incorporated into the print window. Now, mostly that's the case. However, there is a feature that you\ncan access only through VBA coding that allows you to actually preview\nthe document in a separate window. And you do that using print preview, and\nhere it is, worksheet stock print preview. Why don't you take a\nsecond to give that a shot? You can choose a specific worksheet, or if\nyou choose worksheets and do not specify a worksheet, you will get the print\npreview or the printout of all of the worksheets in this particular workbook. However, you can specify one in particular\nand then you'll just get the print preview for that particular sheet. Why don't you go ahead and give\nthat a shot and come on back. And then we will embark upon our\nlast and largest project that we have done, uh, in the class. Welcome back. Okay, here we go. This is the big one. This is our practice video. That's going to incorporate a\nton of the things that we've been learning over the last 10 or 15\nvideos, or really the entire course. So far, what we're going to be doing\nis using everything that we've been learning and creating a macro that is\ngoing to do a few different things. In this scenario. Here, we have a situation in which\nwe have this document with all the different information for each\nparticular divisions, teams and clients and marketing and sales information. And every quarter, let's say we\nneed to print out logs for our teams for each month in that quarter. So we have this particular team, you\ncan see this sheet here on the left-hand side that says this is a sales. And what I want to do is create a\nmacro that's essentially going to go down here and type in the word log,\nand then give me some nice headers in here that would create the beginning,\nthe skeletal structure of a document. That would be a log that would allow our\nteam, this particular team to be able to log information about their sales calls. Now, I want to be able to create this log\nfor every single month of the quarter. So since my quarters change, and since\nI want to be able to do this for all my different divisions, I'm going to\nbe creating a pretty hefty macro here. And here's what it's going to do. First of all, it's going to select\nthe division that I'm interested in, in, let's say in this case,\nwe're going to start with Southeast. So we'll choose a particular\ndivision of interest. And then all of the sheets\npertaining to that particular division, get moved to the front. We did that a couple of examples ago. It's going to be exactly the. But after I move all of that to the\nvery beginning of the document, then I need to put in the headers for a\nlog here in this particular document. And then after that, I'm going to need\nthis particular sheet to be duplicated three times once for each month in\nthe particular quarter that I'm in. So we will be using our copy. And we're also going to be using\nour format and date serial functions in order to name each one of those\nsheets, depending on whichever month it is in the quarter. Now we are going to allow our end user to\nput in whatever quarter they care about. And so we're going to have to create\nsome macro code that also allows them not just to insert a number for a\nquarter that they want, like quarter two, but depending on whether they\ntype quarter to then I actually get the months that are in that particular. So that's our big old task. And at the end of that, what we're\ngoing to do is actually print out the logs for each one of those months,\nin that particular quarter for that particular team and that's our task. So, uh, to sum it all up, our end user\nis going to be able to simply type in the division that they want and type in\nthe quarter that they're interested in. And it will automatically print\nfor them the logs for that given quarter, for that particular division. And for them, this is going\nto end up being a task that saves them at least 15 minutes. If they're an advanced Excel user, or\nit could save them maybe an hour, if they're not such an advanced Excel user. So that's the point of our macro here,\nand you're going to want to open up the file called move copy and print based\non user input, open up your VBA window. On the right hand side, there\nis a, a few modules in here. There are some completed\nversions of these modules. But the uncompleted versions are\nthe modules or the module called a large macro example in there. We're going to be creating\nall of our custom scripting. So if you want to do this with me, that's\nthe macro that you want to go into. However, if you want to go, if you just\nwant to see it written, you can go to the one called completed log dupe, and\nthat will actually show you all the code that we're going to be entering in here. So this is going to be my parent macro. I am going to use this parent record a\ncall to all these other macros in here. And the reason that I'm creating a parent\nmacro to do this is because eventually by the end, I want to create a button here. And that button is going to run\nall these macros and each button can only be associated with one. So I do want to make a parents that\nI can attach that to the button. All right. But let's go ahead and start making\neach one of our individual macros. All right. So we're going to start off by\ndoing an example that we played around with a couple of videos ago. All we're going to be doing\nis accepting user input. And based on my user's input, I\nam going to move a certain number of sheets to the beginning. There are already macros in here that\nare created, that are going to move these for me, there is a module called\ncompleted move in a couple of videos ago, we did create a Southeast move\nexample and that just moved all the worksheets that pertain to the Southeast,\nto the beginning of the document, uh, in this particular document here, all the\nother divisions are fully flushed out. So we do have macros for each one\nof those other divisions already completed with their move macro. So here we go. Now we actually have to create the\ninput box, receive the user's input from the input box and then accomplish this\nparticular task based on their user input. So I am going to create at\nleast a few variables here. So I'm going to start off\nby creating a variable. That's going to contain the message\nfor my input box, and that is going to be a string various. And then I'm going to be making a\ncouple of variables right now that are going to contain integer information. Uh, I'm going to allow my end user\nto type in a number to pertain, to whichever division they want to select. And so I'm going to save that in,\nuh, this variable called region. So, but because they're going to be typing\nin a number, I can say that's a variable. Um, so we're going to have one called\nregion, and then I'm also going to have one called yes-no answer. And you saw me use this for a\nmessage box and a few examples of go. The reason we're going to use this\nagain is because just in case they enter something, we don't want them to enter. We want to give the option\nto try it over again or not. And we're going to use a\nmessage box to do that. And that is of course, the buttons\nthat you click on in a message box returnee, and to your value, if you,\nif you want to learn a little bit more about that, and you didn't see the video\non that, there is a video that deals with message boxes and you can check. All right. So here we go. We're going to go ahead and plug\nin the values for my message. Now this is going to be rather long,\nwhich is why I'm actually storing it in a variable because otherwise this huge\nlong chunk of code would look really weird inside of my input box code. It would just look like\nthere's too much stuff there. And when I'm reading it six\nmonths from now, I would have a hard time dissecting it. So I'm just going to put my\nwhole block of text here. So enter the region of your\nchoice and that's what we'll allow our end users to choose from. There we go. And then I want to create a hard\nreturn in my input box there. So I am going to put in my VBC R L F\nconstant, and that's going to allow me to make a hard return in my input box. There we go, BBC RLF, and I am\ngoing to need those ampersands on either side of that. And then just so that you guys\ncan see me typing in the rest of this stuff, I'm going to put in my\ncode continuation character there. It's also for me for six months from now,\nwhen I'm trying to read this thing, it's easier to see it blocked out like this. Okay. So my end users are going to be able to\nsee the following options so they will see an option for Southeast, and then we'll\nmake a hard return and I'm not going to type all these outright in front of you. Cause that would be boring to look at. I am just going to type out all of\nthe divisions that you'll need here. You'll need Southeast. You'll need Northeast. You'll need Midwest. You will need Southwest. You will need Northwest. And finally far west. Why don't you take a second, pause the\nvideo and complete a set of code here. That's going to give the end user. All of these options Southeast\nNortheast Midwest, et cetera. And they can type 1, 2, 3, 4, 5, 6 for\neach one of those respectively, and then come on back and we'll continue the code. Welcome back. Now that we've actually\nput in the message here. It let's actually use that message and\nwe're going to make our input box and the input box, whatever my end user types\nis going to be received in this variable that we've already declared called region. So region is going to be the\nresult from the input box. And my input box is going to have my\nmessage as the prompt, and then the title here can just be something like region. And then I can just put in some\ndefault text, like enter 1, 2, 3, 4, 5. Now based on their input, I'm going\nto need to do a specific thing. I'm going to need to run one\nof those move macros that we looked at at the very beginning. So I'm going to make a\nselect case structure here. That's going to allow me to\nvery easily create a results from each one of these cases. So in the case that they enter in one,\nthen I want to call upon Southeast move. That's what that's named. There's a naming convention for all these. So it's going to be pretty\ndependable if they type into, of course, that's Northeast. So then I would call upon Northeast\nmove and you can probably see the convention that's coming in here. It's just the abbreviated term\nfor that particular division. And then the word move. So I'm going to go ahead and pause the\nvideo again, or rather you should go ahead and pause the video again and\ncomplete your code there and come on back and then we'll keep going together. Welcome back. Okay. Let's keep going. All right. So we've created a case\nfor each one of these. Now, if they type in something\nthat we're not expecting, or we don't want them to type in, I'm\ngoing to make an else clause here. So I'm going to say case else, and then\nwe're going to give them a message box. And, uh, they're going to be able to\nclick on one of the buttons in the message box, which I'm going to store\nthe input from one of those buttons in my yes-no answer, variable that\nwe declared at the beginning here. And that's going to receive\nthe input from my message box. And maybe we'll say something like you\ndidn't type a number between one and six. Try again. And we will specify the, we want a VB. Yes, no box. That's going to give them the\nchoice between yes and no. And then that choice is going to\nbe stored in my yes, no answer. Now, if yes, no answer. Ends up being yes. If they say yes, I do want to try again in\norder to start this macro all over again. All I have to do is call to the\nname of this particular macro, which happens to be called move by input. I do, of course have to end my if\nstatement with a bookend there. And I also have to end my select statement\nwith an end select statement there. And there we go. That's the entirety of\nthis particular macro. Why don't you go ahead and pause\nthe video and just make sure you're all caught up with me and your\ncoach should look just like this. And if yours looks like mine, then\ncome on back and let's keep going. All right. So assuming that your code looks like\nmine, we're going to keep on going. So in the next little macro that\nwe're going to be making here, we're actually going to be putting\nin some of the texts for the logs. So this is going to be pretty easy. This is going to be some of the\nbeginner stuff that we were doing. Just if we aren't going to be using the\nrange object and the end method, which is going to allow us to figure out where\nthis list ends, because maybe some of my team's are a hundred people long and some\nof my teams are only six people long. And so I want to essentially start really\nfar down and then I'll just say end. So go up and find the very first cell\nthat has content in it and select it. And then once you've selected\nit, I want to actually offset downward by a couple of rows here. So I'm just going to say offset. And I do put in my rows first. So we'll just say, um, offset by. I was going to say two, but\nlet's say three, let's give it some good, healthy space. Okay. And now I'm going to actually\nput in the word logs so that I know what the data is there. And then we'll put in some headers right\nunderneath it in the row underneath it. So I'm going to say selection\ndot value equals the word log. And maybe I also want this\ntext to be bigger than the rest of the text and bolded. So I'm just going to make a\nlittle width and with statements that I can do this pretty fast. So selection dot font, and then\nwe'll say the size of that font equals 2016, whatever you want. And then we'll also say bold equals true. So we're going to make it bold. And I'm going to end my width statement. That's going to make that look a\nlittle bit bigger than everything else, and it's also going to make it bold. And then we're actually going\nto put in all the headers here. So let's move one row down. And then we're going to put in the\ntitle there called client name. And then the other thing that\nI'm going to do is make it bold. So I'm going to say selection\ndot that bold equals true. Now I'm going to be putting\nanother header in here, but I don't want to go down again. So my offset is no longer\ngoing to go down by one row. It's going to go to the\nright by one column. So this time I'm going to say selection\ndot offset, no rows down, but one column to the right, and then select\nthat and then put in the word contact. All right. This little block of\ncode that we just did. You're going to do this over and over\nand over again in order to create all the headers of interest for you. I'll give you some\nsuggested header titles. Maybe you want the date\ninformation in there. Maybe you want the duration in there. Maybe you want some notes\nabout the call in there. So why don't you just take a second,\npause the video and create a little code block for each one of these\nheaders that puts in the title for that particular header there. Go ahead and give that\na shot and come on back. I finished out those few blocks\nof code there, and now I have all the headers that I'm going to\nneed for this particular macro. And so now it's time to move\non to the duplication process. So let's go find the little macro\nthat says duplicate monthly law. Now, in this case, we are going to\ncreate a four next statement in there. We're also going to create a court,\na select case statement that is going to, we're also going to create an inbox\nthat allows our end users to choose which quarter they want to populate for. Or so the inbox is going to ask\nthem which quarter, and they can type in one or two or three or four. And then in the case that they type\nin one, then something special is going to happen for quarter one. In the case of they type in to something\nspecial's going to happen for quarter two. And then we'll go ahead and, uh, get\nthe macro code in there that actually takes care of the result of that. So if I wanted to go ahead and\nstart this from scratch, I would, I would probably be creating some\nvariables here that are later, are going to store some information. Namely, I'm going to create\na variable for my, for next. Now you don't have to do this, but I\nlike to do that and I'm going to call it why this time I've been using X so far\nthroughout our practices, but I'm going to use Y in this particular example, why? Just because I feel like it. Okay. And then I am going to\nneed to put in a input box. That input box is going to have to feed\nits result into a particular variable. So I'm going to need another\nvariable that can just receive the results from the input box. Now, I'm just going to ask my end user\nto type in a number, meaning the variable that's going to contain that information\ncan be an integer variable, just like the one that I've already created. So we'll call this the quarter\nselect variable, and I'll just put a comment in there. And now I can put all these\nvariables on the same line. So the quarter select variable,\nwhich is going to receive the user input, that is an integer variable. And let's go ahead and\nactually create that variable. So quarter select is going to\ncontain the result from an input box. That asks, which quarter is this for now? Eventually I'm going to have a four next\nstatement that is going to populate this log, the log that's going to be created. The log that we created\nthan the last macro. What we want to do is duplicate this\nlog three times over, depending on which quarter we're in, it's going to\nname it by the months in that quarter. So, um, I'm going to create\na for next loop here. And we'll say for Y equals 1,\n2, 3, cause they're only ever three months in a quarter. And what I want to duplicate is,\nuh, the copying of those worksheets. So I'm always going to start with\nworksheets one, because I've already moved to the worksheet that I'm\ninterested in to the very beginning. So worksheets, not one that copy. And then I'm going to specify in my\nargument that I want to actually place that after the very first worksheet\nin the workbook or in this case, I want to place it after worksheet Y so\nthe first time this happened happens, I want to place it after worksheet Y\nand the second time it happens, it's going to place it after worksheet two. Cause at that point, Y is\ngoing to be equal to two. Okay. Now think about it. We've already done an example like this. So let me just remind you once\nI actually place that worksheet. Let's say you were going through it\nfor the very first time at that point. Y equals one. So when I place it after worksheet one,\nthen the worksheet that I'm actually focusing on is now technically worksheet. But the second time I go through\nthis, then it's going to end up actually being worksheet three. And the third time I go through\nthis, it's actually going to end up being worksheet four. So if I want to select the one that I\njust put in, I'm going to need to say worksheets Y plus one, because it is\ngoing to be pushed to the right of would be Y and we'll say the name for that is\ngoing to be based on a particular month. So we're going to use our date\nserial function to be able to cycle through the different months. So I'm going to start by putting\na date serial function in here. And just like in the example that\nwe did earlier, we don't actually care about the year you could put in\nthe year, 2016 or 2017, whenever you are watching this particular video. So you can go ahead and put that year\nin, or you could just put it in the value of one, cause it doesn't really matter. You're not going to use\nthe, the year and here. Well, we are going to use is the\nparticular quarter, but if I used quarter select here and said, use\nquarter select, or if I used Y if I used Y then the month would be January,\nFebruary, or March, but that doesn't really allow my end user to choose a\nparticular quarter and have it populate the months for that particular quarter. Right. So I'm going to have to do something\na little bit more interesting. I'm going to have to create a statement\nup higher and yes, that is incomplete. That's okay. Because we're just following through\nwith this logically, uh, right now quarter select is equal to the value\nof one or two or three or four, but later on, maybe I want to be able to use\nthis value to say, okay, then start if they typed in one that's the quarter. So. But I want that value to switch\nto January, which is also one. So that would be fine. But if they type in quarter two,\nthen I actually want it to start with April, which is month four. If they type in three, I want it to\nstart with July, which is month seven. And if they type in quarter\nfour, then I wanted to start with October, which is month 10. So I'm basically going to create a\nselect case statement that is going to reassign the value for quarter select\ndepending on what the end user typed in. So if they typed in one, then\nwe're going to reassign the value or quarter select to one. That'll be fine. But if they type into, then we're\ngoing to reassign the value of quarter select to start with April, which is. And if they choose quarter three, then\nwe're going to reassign the value of quarters select to start with July, which\nstarts my third quarter of the year. And in the case that they type in\nthe fourth quarter, then I want to reassign the value of quarter select to\nstart with month 10, which is October. And then in the happenstance that\nthey type in something else I do want to put in a message box that\nallows them to choose something else. Right. So I'm going to say a yes,\nno answer, but wait a second. I don't actually have a variable\ncalled yes, no answer up here yet. Well, that's eventually going to\nreceive input from a message box, so I know that's going to be an integer. So I'm going to go ahead and go\nback up here and say yes, no answer. And there are the three\nvariables that I'm going to need. Don't worry. There. Aren't going to be any more. So, yes, no answer is going to receive\nthe input from my message box here. And my message box is going to\nsay, or you didn't enter a valid quarter number, try again, and\nwe'll allow them to type in yes. Or, or click the buttons for yes or no. And then we'll create a\nif clause that says if, if they say yes, then we're\ngoing to start all this over again, duplicate monthly log. That's the name of this macro. And I do need to close out the\nbookend for the F statement. I also need to close out the bookend\nfor the select statement, and now I can get back to what I was doing,\nwhich is creating my four next year. My last line here says worksheets,\nY plus one, that's going to choose the particular position of that\nworksheet that I just placed. The name of it is going to be date\nserial, my date serial function, which I'm putting in one for the year. Cause I don't really care about the year. And then I'm going to use quarter select. Now what the new value\nis for quarter select. And we're going to say, okay, the first\ntime it goes through this, I want it to use the very first number here. So in the first case that it goes\nthrough quarter two, let's say I want it to choose month four, but\nthe second time it goes through it, I want it to choose month five. And at this point, if I just put in\nquarter select, it's only ever going to choose month four every single time. So I'm going to have to say\nPorter select plus Y whatever Y happens to be at that moment. Now that's going to make the first\nincarnation of this actually go to five. So I'm going to say minus. And what's going to happen here\nis it's going to take into account the growing value of Y but then\nit's just subtract one from it. So it actually goes to\nthe correct month there. And then I'm putting in the day, again,\nI don't care about the day, which is why I'm typing in the number one there. So it doesn't matter. And I want it to populate as\nthe fully spelled out month. Now I did forget to put my format\nfunction here, which of course is the whole point of this so that I\ncan actually get my format function to populate the given month there. Okay. So this last little statement that we\nput in here that is M M M M course, that does pertain to the format function. We did cover this exact usage of format\nand date serial in a previous video. So if this is looking a little bit\nforeign to you, go ahead and check out that earlier video and it'll look\nlike it makes a little bit more sense and I'm going to have to finish out\nmy four next statement with a next Y. Okay. And then I should be all done. Make sure that you have completed\nthis particular macro here and then come on back and we'll keep going. All right. So the last thing I need, my\nmacro here to do is actually print out all the worksheets here. So I'm just going to say worksheets too. Cause remember the very first one is\ngoing to be Southeast team, but the second one is going to be for January and the\nsecond and the third one is going to be for February and the fourth one is\ngoing to be from March because that's the order that they're going to be placed in. So I'm just going to say worksheets\nto print out worksheets three printout and worksheets or printout. And you could definitely use\nit for next statement to cycle through those numbers there. If you wanted to. And assuming that we have. Done everything correctly that we haven't\nmisspelled any variables and that we have been placing everything in the right spot. Then when we come back up to the\nvery top, we're just going to go ahead and enter in a couple of call\nstatements up here at the very top. So you're going to want to\nput in call and then call to each individual macro up here. You can go ahead and do that\nright now and then come on back and we'll actually run this code. All right. So now that we put in our call\nstatements here, we can actually just click on our play button. And if it's all working\ncorrectly, it's going to ask us for the region that we want. And I can enter in a particular region. Like I'll just say region one. And then it will ask us\nwhich quarter this is for. And maybe I'll test it out by saying\nquarter two, and then it generated those. And now it's going to print them for me. So I'll say that the very first\none is supposed to be April. The second one is supposed to be may. And then the third one\nis supposed to be June. And there we go. Now it is completed. And I do have sheets for\nApril, may, and June. And that's exactly what\ngot created as a PDF there. And with that, we are done\nwith our massive macro example. Congratulations, you have now officially\ncreated some pretty hefty macro script. We are done with the major\nportion of the class that takes care of massive macro scripting. So if that's what you were in it for,\ncongratulations, come on back though, because we're going to be talking\nabout creating your own functions. If there's a specific kind of a function\nthat you want to be able to create that isn't already in Excel, that's\nwhat we're going to be doing next. So come on back and we'll\nlearn a little bit about that. Welcome back. And now we get to some\nreally exciting stuff. We are going to start\ntaking a look at some U D F. This stands for user defined functions. You are the user, you're going\nto be defining some functions. And so what I want you to do is\nmake sure that you have the user file, the work files called UDFs,\nmake sure that you got that open. And also that you have your\nvisual, basic applications open. You are going to need the module\ncalled a user defined functions, open. There's another module\nin here called completed. So if you want to follow along and not\nactually do the scripting, but just want to follow along and see exactly what we're\ndoing, you can go there and check out and see what has been predesigned for you. But if you are doing a hands-on\nexperience with me, make sure to go to the module called user defined\nfunctions, a user-defined functions. We're going to be designing\nour own function here. And in order to do that, you're going\nto want to insert a new procedure. So we're going to the insert dropdown\nmenu in visual basic, and I'm choosing a procedure, but this is\nnot like any procedure that we have inserted so far, because this is a. Function procedure. And I'm going to go ahead and name\nthis well, I'm going to take a, a road trip pretty soon, and I'm going with a\ncouple of friends of mine altogether. We have three different vehicles. We have a Prius, we have a Mustang\nconvertible, and then we have an RV that we're taking along. Somebody has somewhere to sleep. And so I want to be able to\nfigure out for every stretch, how much my fuel is going to cost. It's one of the things\nI have to figure out. And so that is the kind of function\nthat I'm going to design here, and I'm going to call it cost or gas. Now I'm going to give myself\na little bit of space here. It helps when you're\ndesigning these functions. If you have sort of given it a\nlittle bit of thought and pre designed the formula, that's going\nto be required by this function. Good reasons to design\nyour own functions are. If I do this six times a day, and I\ndon't want to have to plug the function in, that's a good reason to do this, or\nmaybe I do this once every six months and every time I do this, it takes a\nwhole lot of thinking power to remember exactly how to calculate this thing. That would be another\ngood reason to design it. Now, take the time to do it now. And then six months from now, or six weeks\nfrom now, or whenever you have to do this, all you have to do is plug in the numbers. So in this case, I only go on road\ntrips about every six months or so. And every single time, I have to\nremember how to do this function. So I am just going to program it. And from now on, I won't have\nto do the formula at all. I'll just do this really cool function. So here we go. The basic breakdown in my formula is\nsuch, so I'm going to say cost for gas. The name of this function cost for\ngas equals the miles of each stretch. Okay. Cause I want to be able to calculate\nthis for each stretch of my. The miles of that stretch divided\nby the miles per gallon of that particular vehicle multiplied\nby the local gallon cost. I'm going to be going to\na few different states. So I do want to be able to calculate\nthis cost based on the local cost of gas and not just the national average. All right. So these are going to be the, uh,\ntitles that I'm going to take into account also known as arguments. And in case you've been wondering\nthis whole time, what these are for, this is what they're for. I'm going to go ahead and\nput my arguments in there. Now this looks a little bit\nmore like the regular functions that you're used to in Excel. You do have the name of the function\nand then the opening and closing parentheses, and the arguments are\ninside those separated by commas. That's exactly what\nwe're going to do here. I'm going to let VBA and therefore\nExcel know exactly what kind of data should be expected in each\none of these arguments here. So I'm going to say. Miles of stretch is going\nto be a double data type. That's one of the preferred data types,\nbecause it's a, it's a number, but it can be all different kinds of numbers. It can be some pretty long lengths of\ndecimal place holders, pretty flexible. So miles of stretches, double\nthe other two of these are going to be as double as well. So I'm going to say, uh, miles\nper gallon as double and the local gallon costs as double. Okay. And I know it's kind of crazy, but,\nuh, that's about all there is to it. So let's go ahead and use it. I'm going into Excel and I'm\ngoing to say equals cost for gas. And there's my cool function\nthat I just designed. I can double click on it. If I have all of the arguments memorized,\nI can go ahead and put them in here, but you'll see that I don't get this, those\nnice, nice little hint windows that I get from the predesigned Excel functions. And so I would love to open up\nmy function, arguments, windows that I can actually get the\ntitles of each one of these. So miles of stretch, let's\nsee the miles per gallon. We're figuring it out for the Prius first\nand over here on the left-hand side, we do have the breakdown of miles per\ngallon, 51 for the Prius C the Mustang convertible gets 29 and the RV gets nine. About the same as my El Camino\nthat I drove around in high school. So miles per gallon of our\nPrius, first of all, is 51. So I'm just going to go\nahead and click here on 51. And then the local gallon cost for\nthis particular stretch is 2 86, pretty steep, but I'm starting from California. So there it is. All right, I'm going\nto go ahead and click. Okay. And now I'm going to use my autofill\nhandle to populate the rest of this car. I'm going to choose to fill\nwithout formatting and to keep my table nice and looking good. All right. And that's about it. So it can be as simple as this and\nI could fill out the rest of my table here and say, miles of stretch\nfor this one is this and miles per gallon is start with my Prius again. And the local gallon cost is\nabout this for Oregon and click. Okay. There we go. And fill without formatting. Maybe I want to clean that up a\nlittle bit with my dollar signs. There we go. And I do have a cool little,\nsome function down here. That's already programmed in there\nthat is calculating the total for me. And that's about all there is to it. So take a minute and complete\nyour function for cost for gas. And I am going to maximize my visual\nbasic for applications, windows, so that you can see this function. Why don't you go ahead and\ngive it a shot and come on. All right, then let's move\non to our second example. This is one of my favorite\nprofessional examples, uh, to calculate percent of change over time. This tends to be somewhat important\nin a lot of industries, uh, somewhat being an understatement, being able to\nfigure out the percent of change over time of a particular set of information. Now, there are many different ways to\ncalculate percent of change over time. But in this particular case, the way\nthat we are figuring this out is by taking the current and subtracting\nfrom it, the previous value. And then we're going to defy\nthat over the previous value. And that is going to give us a nice little\ncalculation of percent change over time. So here we go. I'm going to go into\nmy visual basic window. I'm going to click on insert\nand I'm going to insert a new function procedure, and I'm going\nto call this percent change over. So just like last time, the designing of\nthis function is going to be pretty easy. If I've already sort of figured it out\nand written it down and know exactly how I'm going to calculate this. So I'm going to start by saying\npercent change over time equals. And I'm going to put this in\nparentheses current minus previous over previous. No, I didn't actually have to\ncapitalize it there cause it would have gotten fixed later on. All right. So current minus previous,\nover previous, and that's going to be my calculation there. I am going to need to go inside my\nparentheses here and define exactly which data types should be expected here. So the current value it should be done. And previous should also be double. All right. And there we go. That's all there is to it. So I'm going to go ahead\nand use that over here. Percent change over time. There it is. And let's see the current value. Let's see, we're looking at\nsnowfall in inches here for Tahoe. So current is 4 24 and that was in 2009. And previous was whatever is above that. So the very first time I calculated\nthis, I'm not going to get an answer here cause I don't have any previous\ndata, but, um, that pattern worked for me because then when I auto fill down, then\nI'll be grabbing the value right above it, which will be the previous value. Okay. So the first time it's going to look\nweird and then I'm going to auto-fill down and there's my nice little\ncalculation of percent over time. And that is populating on my chart here. Okay. All right. And if I want to calculate percent\nchange in working capital, I'm going to use the exact same\ncalculation percent change over time. Okay. And here we go. This is my current capital and my previous\ncapital's going to be right above it. And I click, okay. Again, it's going to look weird\nthe first time and then for the rest of them, there we go. Alright. And with that, we've calculated\npercent change over time. Why don't you give this one, a shot and\nthen come on back and we'll get into a little bit more complicated stuff. All right. For this last UTF example, what\nwe're going to be doing is figuring out the surface area of our house. Cause we got a paint job coming up\nand I don't know how much paint. Now, in this example here, the math is\ngoing to take you back to geometry class. So if you didn't like geometry,\ndon't worry about the math here. Okay. You don't need to wrap\nyour brain around that. You don't have to remember that at all. All you have to remember is that\nas complicated as this function is about to get, ideally in the end,\nyou're only going to have to plug in a couple different variables, right? You're going to have to plug in this\nnumber, the height of the house square block, which is this the height of\nthe roof triangle block, which is this year, the width of the house. And it's that, and the depth\nof the house, which is that. So those are going to be the\nonly four things that you're going to have to plug in. Now, when you're programming this\nfrom the beginning, it is going to look a little bit complicated\nwhen we're doing it together. And that is because it is a little\nbit complicated to figure out. And that's why I want to\nturn it into a function. So I don't have to figure it out. Okay. I, uh, I have it at the top of my\nmind right now, I'm going to make it into a function and I'm never going\nto have to think about it ever again. So here we go. I'm going to insert a function here. I'm going to insert a procedure\nagain, that's going to be a function procedure, and we're going\nto call this house surface area. Okay. So eventually the calculation\nthat's going to happen is it's going to say house surface area\nequals each one of these panels. So the front and back, these\nare going to be the same size panel, right then the sides. These are going to be the same\nsize panel and then the roof sides. Those are going to be\nthe same size panel too. So what we'll do is we'll\ntake into account the front end back, had it to the side. And add it to the total size of the roof. Eventually that is going to be\nthe entirety of my function. Now I am going to need to do some slightly\nmore complicated calculations here. Okay. The sides of the house, that's going to\nbe easy sides equals the height of the house times the depths of the house times\ntwo, cause there's going to be two sides. Hey, so the sides equal to\nheight times the depth times two, because there's two of them. So that one's going to be pretty easy. I do know now that I'm going to have\nthis thing called height of the house and this thing called depth of the\nhouses are going to be arguments. Let's go ahead and define those right now. So height of the house, she'll\nbe double and then depth of the house should be doubled as. All right. So we got that one. Now the front and back is going to be a\nlittle bit more complicated because if you remember back from geometry class,\na triangle is normally calculated by the height times, the width divided by two. Now just so happens that there\nare actually two of them. So you wouldn't have to do this much work. You could just see the width times\nthe height, but anyway, we're going to do it the long way so that we can\nappreciate exactly how, uh, how cool this function is going to be by figuring\nout all this stuff when we're done. So we're going to say front and back\nequals and eventually the front and back is going to equal the height of\nthe house times the width of the house. So that's just this simple little\nheight times the width we're taking care of this square block right here. And then we're going to do this\nlittle triangle piece separately. We're going to add that. I don't really need to put these\nparentheses in here, but I am. We're going to add that to this little\npanel right here, which is eight feet high and seven and a half feet wide. So that's this little\nhalf a triangle here. Okay. Okay. So I'm going to say height of\nthe roof times the width of the house divided by two, right? Because this little panel here is half,\nhalf of 15 half of the width, and I'm going to surround that with little\nfriends here and I want this whole thing. Multiplied by two, because\nthere are actually two of them. Right. I have, I have one of these on the\nfront and one of these on the back. So I'm going to do this little\ncalculation here and then I'm going to multiply the whole thing by two. And yes, there are some redundancies here\nwith numbers that you could get a little bit more fancy, uh, algebraically in here. All right. And then the last thing I'm going\nto need to take into account is, uh, oh, by the way, let's not forget. We have this new argument\ncalled Whit house. So let's go ahead and put that in here. So height houses, double. I'm going to just going to put it\nright here with house as double. Oh, there we go. Alright. And then the roof slant roof slant. Okay. This is going to be. I need to figure out how big\nthis thing is going to be. How, what size this particular line\nis right here, the slant of the house. Now, if you guys remember back from\ngeometry, uh, you can do your, a squared plus B squared equals C square to figure\nout exactly what the, um, what the size of this side of the triangle is going to be. So we're going to go ahead and do that. Now. Normally, if we were going to\ndo this, we would, um, we would use the, a squared, right. Which would be the width divided\nby two multiplied by itself. Okay. Times the height of the\nrooms multiplied by itself. That's the squared part. Okay. So I'm going to do that first\nheight, roof times, height, roof. I don't have anything\ncalled height roof yet. So I'm just going to add that\nin while I'm thinking about it. Right roof. Here we go. Uh, Hide roof times\nthe height of the roof. Plus, and again, I don't really need\nto put those prints there just to help me visually later on, plus the\nwidth of the house over two times, the width of the house over to, okay. And this is supposed to\nequal this thing squared. So my roofs land is\ngoing to be this square. And this is a cool\nlittle VBA function here. You can just put SQR and it\nwill it'll it'll figure out the square root of this here. And then I'm just going to plug that\ninto this thing called reef slant. Okay. Now I probably could use a\ncouple of, uh, variables here. Probably could use variables for\nfront and back and sides and. And eventually if I'm going to\nfigure out what the total roof is, I probably want to get a little\nequation here that figures that out. So, so I figured out what\nthe, uh, roof slant is so far. So now I got to figure out\nwhat the actual roof is. So here we go. Roof equals roof slant times the\ndepth of the house times two, because there's two of them. So with that, I've actually figured out\nwhat the sizes of each panel of my roof. And I'm going to multiply that\nby two cause I have two of them. And now finally, I have this thing\nthat says how surface area equals front and back plus the sides plus the roof. I do have a couple of things\nthat are undefined here. A couple of variables\nhere that are undefined. So I'm going to go ahead and\nmake some variables for this. So I'm going to say there's a\nvariable called brief slant and front and back and sides and roof. I'm going to do that up here, sides front and back. And roof slant as double and with that, does she work if\nI haven't spelled it anything in correctly, this should work. Great. So I'm going to go ahead and\nplug this in and see if it works. Here we go. Is the house surface area. The height of my house is this, the\nwidth of my house is this depth is this. And then the height of the\nroof is this and I'll click. Okay. And I happen to know\noff the top of my head. That that is correct. All right. So give this a shot. I know this was a rather complicated\nexample, but this, that makes it a perfect example for why you would define it\nas a UTF and use it as a UTF from here on out, as opposed to figuring out the\nformula, every time you had to paint your. Here you go. Here's your formula. If you haven't done so already go ahead\nand finish this and then come on back. And with that, congratulations\non completing the visual basic for applications. Excel course, feel free to go\nback any time and review these files, the notes, and also the\nPowerPoint for a little refresher. It has been an absolute\npleasure teaching you from afar. Hopefully I'll get to meet\nyou in person one day. Chelsea Dohemann: In the next few\nexamples, we're going to want to be able to take content from multiple\ndifferent sources and then paste it on some kind of extra sheet at the\nend, just for consolidation purposes. Or maybe you want to be able to take\na sheet that's sort of like a template sheet, and then you want to be able to\nreproduce it 12 times for every month of the year or 10 times for every year\nin a decade or something like that in order to be able to create specialized\nversions of that particular template. If you want it to be able to do that,\nyou're going to have to start to play with sheets and know how to use\nthe coding that's required to do. So we've already seen the\nfeature called worksheets.name. Now you're going to need\nto specify exactly which worksheets you're talking about. So let's go ahead and add a couple so\nthat we actually have something to name. There's also a method\ncalled worksheets dot. And if you execute it, you'll see\nthat you have another sheet that's actually being added into our workbook. Now this sheet is called sheet three,\nbut technically it's not worksheet three. It's actually worksheet one. It's worksheet one, because that's\nthe order that it is an Excel. There are a couple of different\nways that we can refer to a sheet. What we can do is we can say\nworksheets worksheets, one, that's going to refer to whatever the very\nfirst worksheet is in my workbook. And then I could say select. Now that's going to select the very\nfirst ordered worksheet in my workbook. If I wanted to select the\nsecond one, I would use two. Now I've selected the second one, or if\nI want to actually use the name of the worksheet in those parentheses, I can\nactually put in the name of the worksheet. Instead in different cases, you\nwant to be able to know that both of these are possible. And that is selected the sheet called\nnumber two, which of course isn't actually number two, but that's what it's called. If I wanted to rename this, I\ncould say worksheets, and we'll say, we want to rename this one. That's currently called number two and\nI'll refer to it by its numerical value. It's the third sheet in order. So I'll say worksheets three\nand the name is something else. And that changes the name\nof my worksheet here. Now, if I want it to be able to copy\nand paste to these worksheets over and over and over again, what we're\ngoing to be doing is using a couple of features, including after what\nwe're going to be doing is using the worksheet stock add feature. And then later on, we're going to be\nseeing the worksheets dot copy feature, and we're going to need to do that\nactually within a macro, but these are the basics of that particular printer. And if at some point I decided\nlater on that I wanted to delete one of my worksheets. I could of course say worksheets. And we'll say, it's the very first\none in order that we want to delete worksheets one delete, and I will get\nthis little window that pops up that says, are you sure you want to do that? That's a normal Excel window. Yes, I'm sure I'm going to go\nahead and click on delete if you haven't done so already. Why don't you run over the principles\nof worksheets dot, add worksheets, select the few different naming\nconventions that we have for specifying a specific worksheet, renaming that\nworksheet and deleting a worksheet. Why don't you go ahead and give\nit a shot and come on back. So the next particular large exercise\nthat we're going to be employing, we're going to need to know a couple\nof other little extra helpful tidbits. These are functions, essentially. They're going to be able\nto figure something out. There's one called date cereal. And there's one called format. Now, normally both of these do\ndeal with numbers, specifically dates in both of these cases. And we're going to figure out\nright now how to actually use them. Now, these are simple examples. And if you open up the file called\ndate, serial and format, that's going to walk you through how\nto actually use both of these. There are little guides on here\nthat give you an example of code that could be used to exemplify each\none of these particular functions. Although I'm not going to be focusing\non those little help windows right now, cause we're going to be doing it together. So let's say for instance, that I\nneed to be able to populate all the dates in the given month, or maybe\nI just need to populate exactly 30 dates in this particular month. For whatever reason I have, what\nI can do is create a macro that is going to cycle through all the\ndates in order in this particular. No, I, in my spreadsheet here, there\nare a couple of functions here that are just checking and seeing which month\nit is right now and what year it is. So basically I want my macro to be able\nto pick up the current month value and the current year value, and then be\nable to cycle through the different days that might be in this particular month. And let's just say, we're\ngoing to focus on 30 for now. Maybe whatever our practices requires\nus to actually only have 30 days. So I'm going to be creating\na four next statement. That's going to be able to cycle\nthrough and make the first date and then make the second date and then\nmake us the third date of the month, et cetera, all the way through, until 30. So I am going to have a for next\nloop, and this is going to look like this four X equals one to 30. We're just going to keep it simple for. And then we're going to start\nusing a tactic that allows Excel to figure out exactly where it\nshould place a particular value. So I'm going to say in a particular\nrange, we'll start with cell D five. We want it to, uh, insert a value\nin that particular cell, but in this second iteration of this, for next loop,\nI want to go to the next cell down. And after that, I want to\ngo to the next cell down. So in this case, what I'm going to\nbe doing is Eugene, my range tool. And since I'm counting up\narose here, I can actually get it to count up rows for me. Now, of course, I could\nalso use cells here. I just happened to be using range\nbecause we're talking about rows. Those are numerical. And so I can count them up, but\nif I needed to count up columns, I would probably use cells instead. Anyway. So, uh, we're looking at range. All of these values do\nhappen to be in column D. So I'm going to go ahead and put that in. Now I'm starting with D four, but I'm not\ngoing to type that in here because I'm going to allow VBA to figure out what D. And then the combination of four plus X. So in this first case, the first\ntime I go through my iteration, X is going to be equal to one. So this is going to start on D\nfive, which is four plus one. And then the second time it goes through\nit, it's going to go to D six, which is X equals two D starting with four plus two. So it would be D six. And then the second time it would\nbe D seven and the third time it would be D eight, et cetera. So I'm actually going to let VBA here,\nfigure out what cell it should be placing this particular value in by\ncounting up using my, for next loop. And then I'm going to say the\nvalue in that particular cell should be a particular numerical\nvalue in this case, a date. And I'm going to use a function\ncalled date serial, which allows me to put in portions of the date that\nI can rely on like month and year. And then I can allow my, for next loop\nto actually loop through the values for days by saying that it equals X. So the first time it enters it in, it's\ngoing to be the first date of the month. And the second time it will be the\nsecond date of the month, et cetera. Now here's how the date\nserial function works. I do need to put in of course, the\nname, which is date serial, and then I'm going to open up my parentheses and\nyou'll see here in the hint window that it says the year has to be an integer. So maybe I want to pick up that integer\nfrom my actual spreadsheet here. If I want to do that, I'm\nprobably going to end up storing that content in a variable. So I'm going to need to\ncreate a couple of variables. First of all, let's start off with\nex that's going to be for next. And then let's say we're going\nto store the information for month and year, both as integers. And that's how they show up\nin my data set here in Excel. So that's going to be fine. So dim and we'll call it\nmonth value as integer, and then we'll make another\none for a year value. And then we can actually declare\nwhat these are going to be in our particular circumstance. Our current month value is\nalways going to be here. Our current year value is\nalways going to be here so I can just do a simple plugin here. So month value is going\nto be range cell B five, the value of that cell and your value. It's going to be range C5. And the value in that. So it's going to be grabbing\nthose integers and storing them in these particular variables. And then what I can do is\nactually use these variables in my date, serial function. And my date serial function requires me\nto first plug in the year as an integer. Now, the good thing is that I actually\nalready have that stored in that variable that we created in plugged in. So I'm going to say, use my year value\nas the year, and then it needs the month. So I'll say here's my\nmonth value as the month. And then the day, this can be my X. So I do need to put in a next X at the\nend, which I do have, and I'm going to go ahead and run this and it should\npopulate all the days of the month. And there we go nicely, just like. Now let's say I want to be able to\nformat these in a particular way. Maybe I even want to get these\ndates to show up as day as in Wednesday and then the date and\nthen the month, and then the year. And for whatever reason, I'm going to need\nto group this content later on, I'm going to need to actually use it as text values. So I don't want to Excel converting\nit into numerical values. I don't want the serial number\nassociated with it anymore. This date, serial function, this actually\ndoes take into account this serial number and it stores the serial number. And you'll notice that because if\nyou click on any of these cells, go to your home tab and go back\nto general, you'll see that the serial number is actually associated\nwith that particular date value. That's what we're used to\nseeing, but maybe I want to be able to store these as text. If I want to do that, then\nI'm going to need to use a different kind of a function. And this is going to\nbe the format function. Now I'm going to create a couple\nof variables here, cause I'm going to be doing a for next loop again. I have my X and that is\ngoing to be an integer. And then I'm actually going\nto get my spreadsheet to pull the date from right here. That's just going to make it\neasier for our example right now. So I am going to create a variable\nthat's meant to store the date. So I'm going to say date value as\ndate and yes, date is a data type. It's one of the data types\nthat we talked about earlier. And then I could say for X equaling, 1, 2\n30, just like before, and then I am going to need to grab this date value here. So let's go ahead and state\nthe very first date value here. So I could say date value equals\nthe range of whatever cell we're in. We know it's going to be\nsomewhere in column D. And we're going to let the for next\nloop figure out for us what the row is by using four plus X, just\nlike we did in the last example. So that's actually going to\nstore the date value that was already in that particular cell. And you don't have to put spaces in here. I just prefer to see them like that. And then what I'm going to do is\nactually use that content to paste in the range, that same range, so D whatever four-plus exes, and I\nwanted to use this format function. Now the format function is going\nto be able to use the date value. And then I get to specify exactly\nhow I want to format this date value. And we'll say it's long date. I do need the end of my next loop. And there it is at the bottom. I do have my next X that already came in\nwith this macro before we even got it. Okay. And if I run this, this is going to\ndisplay for me all of the long date versions of each one of these dates, but\nyou will notice that in these cells, I don't actually have this serial number. This has now been converted to text. So the difference between using date\nserial and using format is that date serial actually maintains dates as a\nparticular serial number and format allows you to convert them into text values. Just pretty cool. Why don't you go ahead and give this\na shot, finish out your macro here, test it out and make sure that indeed\nthese are being stored as text values. And when you're done, come on\nback for the next couple examples. We're going to have to become a little\nbit more familiar with the copy method. Now, in this case, we're\ntalking about the copy method. That is a method of\nthe worksheets objects. Uh, the deal with the copy method\nis that it actually inherently also includes a paste method. Uh, if you copy it, you\nare going to paste it. And so they're built into the same tool. So if you want to copy a particular\nsheet and place it somewhere, you are going to need to specify\nexactly where you want to place it. And so now we start to get methods that\nhave these specifications afterwards, in which we specify exactly how we\nwant this method to behave in this particular case, we choose exactly where\nwe want it to be pasted, essentially. So in this case, before worksheet\nfour, or in the second case here after worksheet two, these are called arguments\nof methods and we're going to be using them in the next example, right here,\nyou're going to want to open up the file called sheet template generator. And essentially what we're going to be\ndoing here is taking this very first sheet, which is a template sheet. If you will, this is a design that I want\nto be able to create over and over and over again for every month of the year. Now I'm going to create a for next loop\nin order to be able to create 12 of these. And in order to name them after\nI've created them, I'm going to use the date serial and format\nfunctions, which are gonna allow me to cycle through months of the year. So if you open up your visual basic for\napplications window, you'll see that there's already some macro code here. Now I'm going to go ahead\nand do this from scratch. But if you don't want\nto, you don't have to. And I'm going to start off by declaring\nmy variable, which is going to be X. And this is going to be an integer\nvariable because it's going to be used in my, for next loop. So for X equals one to 12,\nbecause I want to create 12 of them for every month of the year. And then I'll say worksheets\nspecifically the very first one. I want to copy it. And after I've copied it, I want to\nplace it in a specific spot, which in this case is going to be after\nworksheet, whichever worksheets. So the first time I go through this, I\nwant to paste it after worksheet one. The second time I do this, I'm going to\nwant to paste it after worksheet two. So think about it like this. If I already have a sheet in here and\nI'm going to be pacing this after sheet one, that basically makes this thing\nthat I'm pasting now worksheet two. So that's now become worksheet two. So if I want to select that worksheet that\nI've just actually put in there, I'm going to have to say, okay, worksheets select. And what most people would do is\nput in the number two here, but I do want this to be able to count up. So it can actually put in a name for\nevery single one of these sheets. So I'm going to say X, but it got\npushed to the second spot there. And the second time I do this is\ngoing to get pushed to the third spot. And the third time I did, this is\ngoing to get pushed to the fourth spot. So I'm just going to say X plus\none, and that's going to figure out exactly which spot it should be in. And I'll see that the name of that word. And this is going to be determined by\nthe date serial and the format functions. The nice thing about the date\ncereal is that it actually uses serial numbers, which is it allows\nit to be able to cycle through numbers and count up pretty quickly. So if I want this sheet to be named by the\nmonth, this particular sheet corresponds to, I could say that the very first time I\ngo through this, I want to name the sheet. After January, January is\nassociated with the number one. And if this is the first time that I'm\ngoing through it, X is associated with the number one to number one, it's\nassociated with the number one as well. So my date serial is going to require\nme to put in a year, but I'm not actually going to end up using the year. Cause all I care about is the month. So I'm just going to put in the\nyear there and it doesn't really matter what year you're using. You could put in year one again, like\nI said, it doesn't matter cause I'm never going to be using the year. I'm only going to end up using the month\nand I'm only using the date cereal because it's a lot it's able to cycle through\nnumbers here that are associated with. Or with days or with years. Okay. So, uh, in my month spot, however,\nI am going to put X there. So the very first time this happens,\nthis state is going to correspond with some kind of a date in January. And the second time it goes through\nit, it's going to correspond with a date in February and the\nthird time with March, et cetera. And I need to put in a day there as well. But again, I don't care about that one. So I don't care about\nyour don't care about day. So I'm just putting one for those. You guys could put whatever\nyou want for those. The only one that I\nreally care about is X. And now that I've actually determined\na date that is in January the first time this happens and February\nthe second time it happens and March the third time it happened. Now I need to make my format function,\ngrab this serial number and be able to extract from it the month. So if you remember from our last lesson\non the format function, it was able to take a serial number associated\nwith the date and then populate. Um, a particular display for that date. And the last case, we just asked it to\nshow the long date, but you can also say, Hey, I want you to show just the month. Now, if you're going to do that,\nyou would simply put in quotations, just like we did last time. But I would use this little coding. Three M's is going to\nbe an abbreviated month. And if you wanted to do four\nM's, that would put the fully spelled out version of the months. You can do whichever one you\nlike, I'm going to do four M's. And that is actually going to pull the\nmonth information from my date serial. So it's cycling, cycling through the first\ntime it goes through it's grabbing January and then the format function is actually\nextracting the word January from this. And I'm using that to name my\nworksheet that I just put in there. Okay. And I'm going to do this\nover and over and over again. So I'm putting in the next act. And then at the very end, when\nwe are all done, I'm going to say, okay, take that template. That very first sheet\nthere, worksheets one. And I want you to delete it. I don't want that one because\nit's not going to have a label that makes any sense. It's just still going to say sheet one. And all I care about is the ones that\nare actually named after the months. All right. So here we go. Now we're going to go ahead and run this. I'm going to go ahead and click on play. And when I do, so Excel is going to say,\nare you sure you want to delete that very first sheet that you can't undo that? And I'm going to say yes. I'm sure. Go ahead and click on delete. And there we go. Now I have 12 months, one for every\nsingle month of the year, and they are all designed based on my template. If you haven't done. So take a second to code your macro\nover here on the right hand side that is supposed to cycle through all of your\nsheets and name them, but only after of course you have copied them and place\nthem after the very first worksheet. Take a second to do that. And then come on back. Welcome back. For this next session, we have the\nchallenge of having a rather large workbook and I have a set number of\nsheets that I want to be able to access. However, they happen to be buried\npretty deep in my workbook. And I'd really like for them to be\nat the beginning of the workbook, when I need to take a look at those\nparticular sheets, the sheets in question or group of sheets that have\nto do with the Southeast division. And you'll see that I have one here\ncalled Southeast team Southeast clients, Southeast marketing, and there's\none more called Southeast sales. And I'd like for these to all be placed\nat the beginning of my workbook, when I am taking care of a project that has\nto do with that particular division. And so I'm going to need to make a macro,\nthat's going to be able to do this. Eventually. If I made a macro for every single one of\nthese divisions, I would probably place them all as buttons on the interface. And then I could easily reorder\nmy workbook whenever I wanted to. We're going to go over an\nexample of just creating a macro. That's going to reorient the Southeast\ndivision to the very front of our work. And then you can extrapolate\nfrom that and do the remaining divisions if you so choose. So in order to do this exercise, we're\ngoing to want to open up the file called reordering sheets and open up\nyour visual basic for applications. Window. Mine is open on the right hand side and\nI am going to find our modules folder go into module one, and I'm looking\nfor the macro called Southeast move. So it should be the second macro\nto collection of macros here. And again, like I said earlier, you\ncan complete the rest of these, if you would like, I'm just going to go ahead\nand do the one for Southeast move. And here we go. So, um, I'm going to use\nworksheets and I'm going to refer to the name of the worksheet. Now I happen to know that the name of\nthis worksheet is going to be S E sales. This is the first one, and I'm\ngoing to use a method called. Now, when we were checking out the\nmethod called copy, we noticed that we had to, uh, put a little argument\nin here that said exactly where it's supposed to be placed afterward in\nthis case, we're going to move it. And we also need an argument that explains\nexactly where we're going to put it. So I'm going to say, move this and place\nit, uh, after or before a certain place. So I could choose after, but I'm going\nto choose before, because my objective is to put this at the very beginning. So I'm going to say before, and I'm\ngoing to put my colon and my equal sign. That is the syntax that is\nused for arguments of methods. And then I'm going to say, put it\nbefore, whatever worksheet is in place. Number one, and I'm going to do this for\nevery single one of the worksheets that has to do with the Southeast division. Why don't you do this to do this for all\nfour of the worksheets and when you're done, come on back and we'll keep. Okay, I've completed that if you haven't\ncompleted it yet, just go ahead and pause the video and complete it with me. I just didn't want you to have to\nwatch me complete all four of these. Uh, but that's basically the task that I\nwant to accomplish here is to be able to move every single one of these sheets that\nhave to do with the Southeastern division. And then when I go ahead and run\nthis macro, you'll see that all of those sheets Southeast, Southeast,\nSoutheast, Southeast, get moved to the very beginning of my workbook. And that's the basics of\nusing the move method. Why don't you go ahead and complete that\nup and then come on back, welcome back. And the last statement that we're\ngoing to need to cover before we do our large macro example to finish out the\nscripting section of the class is going to require us to learn how to print certain\nworksheets, uh, of our given selection. So go ahead and open up the file\ncalled print out print preview. That's going to allow us to\nopen up the, uh, module twofold. Module one will look pretty\nfamiliar that has all of our, um, our move scripting that we did. In the last example, the module\ntwo has a open macro waiting to be scripted called print all sheets. So if you wanted to print all of your\nworksheets at the same time, you could put a little bit of script in here\nthat said worksheets dot printout, but for our purposes, in order to just be\nable to cover this really quick, you don't have to do it here in the macro. We can actually do that\nin the media window. So we can say worksheets dot\nprint out, and I can execute that. And assuming that my computer\nis hooked up to a printer, then obviously it would print it here. But in my case, I am not. And so it is trying to print\nit to some other kind of a file type, but it did work there. Now, there are a couple of different\noptions that we can take a look at here. There's print out, and then\nthere's also print preview. For those of us who thought the print\npreview was actually gone, that it was just incorporated into the print window. Now, mostly that's the case. However, there is a feature that you\ncan access only through VBA coding that allows you to actually preview\nthe document in a separate window. And you do that using print preview, and\nhere it is, worksheet stock print preview. Why don't you take a\nsecond to give that a shot? You can choose a specific worksheet, or if\nyou choose worksheets and do not specify a worksheet, you will get the print\npreview or the printout of all of the worksheets in this particular workbook. However, you can specify one in particular\nand then you'll just get the print preview for that particular sheet. Why don't you go ahead and give\nthat a shot and come on back. And then we will embark upon our\nlast and largest project that we have done, uh, in the class. Welcome back. Okay, here we go. This is the big one. This is our practice video. That's going to incorporate a\nton of the things that we've been learning over the last 10 or 15\nvideos, or really the entire course. So far, what we're going to be doing\nis using everything that we've been learning and creating a macro that is\ngoing to do a few different things. In this scenario. Here, we have a situation in which\nwe have this document with all the different information for each\nparticular divisions, teams and clients and marketing and sales information. And every quarter, let's say we\nneed to print out logs for our teams for each month in that quarter. So we have this particular team, you\ncan see this sheet here on the left-hand side that says this is a sales. And what I want to do is create a\nmacro that's essentially going to go down here and type in the word log,\nand then give me some nice headers in here that would create the beginning,\nthe skeletal structure of a document. That would be a log that would allow our\nteam, this particular team to be able to log information about their sales calls. Now, I want to be able to create this log\nfor every single month of the quarter. So since my quarters change, and since\nI want to be able to do this for all my different divisions, I'm going to\nbe creating a pretty hefty macro here. And here's what it's going to do. First of all, it's going to select\nthe division that I'm interested in, in, let's say in this case,\nwe're going to start with Southeast. So we'll choose a particular\ndivision of interest. And then all of the sheets\npertaining to that particular division, get moved to the front. We did that a couple of examples ago. It's going to be exactly the. But after I move all of that to the\nvery beginning of the document, then I need to put in the headers for a\nlog here in this particular document. And then after that, I'm going to need\nthis particular sheet to be duplicated three times once for each month in\nthe particular quarter that I'm in. So we will be using our copy. And we're also going to be using\nour format and date serial functions in order to name each one of those\nsheets, depending on whichever month it is in the quarter. Now we are going to allow our end user to\nput in whatever quarter they care about. And so we're going to have to create\nsome macro code that also allows them not just to insert a number for a\nquarter that they want, like quarter two, but depending on whether they\ntype quarter to then I actually get the months that are in that particular. So that's our big old task. And at the end of that, what we're\ngoing to do is actually print out the logs for each one of those months,\nin that particular quarter for that particular team and that's our task. So, uh, to sum it all up, our end user\nis going to be able to simply type in the division that they want and type in\nthe quarter that they're interested in. And it will automatically print\nfor them the logs for that given quarter, for that particular division. And for them, this is going\nto end up being a task that saves them at least 15 minutes. If they're an advanced Excel user, or\nit could save them maybe an hour, if they're not such an advanced Excel user. So that's the point of our macro here,\nand you're going to want to open up the file called move copy and print based\non user input, open up your VBA window. On the right hand side, there\nis a, a few modules in here. There are some completed\nversions of these modules. But the uncompleted versions are\nthe modules or the module called a large macro example in there. We're going to be creating\nall of our custom scripting. So if you want to do this with me, that's\nthe macro that you want to go into. However, if you want to go, if you just\nwant to see it written, you can go to the one called completed log dupe, and\nthat will actually show you all the code that we're going to be entering in here. So this is going to be my parent macro. I am going to use this parent record a\ncall to all these other macros in here. And the reason that I'm creating a parent\nmacro to do this is because eventually by the end, I want to create a button here. And that button is going to run\nall these macros and each button can only be associated with one. So I do want to make a parents that\nI can attach that to the button. All right. But let's go ahead and start making\neach one of our individual macros. All right. So we're going to start off by\ndoing an example that we played around with a couple of videos ago. All we're going to be doing\nis accepting user input. And based on my user's input, I\nam going to move a certain number of sheets to the beginning. There are already macros in here that\nare created, that are going to move these for me, there is a module called\ncompleted move in a couple of videos ago, we did create a Southeast move\nexample and that just moved all the worksheets that pertain to the Southeast,\nto the beginning of the document, uh, in this particular document here, all the\nother divisions are fully flushed out. So we do have macros for each one\nof those other divisions already completed with their move macro. So here we go. Now we actually have to create the\ninput box, receive the user's input from the input box and then accomplish this\nparticular task based on their user input. So I am going to create at\nleast a few variables here. So I'm going to start off\nby creating a variable. That's going to contain the message\nfor my input box, and that is going to be a string various. And then I'm going to be making a\ncouple of variables right now that are going to contain integer information. Uh, I'm going to allow my end user\nto type in a number to pertain, to whichever division they want to select. And so I'm going to save that in,\nuh, this variable called region. So, but because they're going to be typing\nin a number, I can say that's a variable. Um, so we're going to have one called\nregion, and then I'm also going to have one called yes-no answer. And you saw me use this for a\nmessage box and a few examples of go. The reason we're going to use this\nagain is because just in case they enter something, we don't want them to enter. We want to give the option\nto try it over again or not. And we're going to use a\nmessage box to do that. And that is of course, the buttons\nthat you click on in a message box returnee, and to your value, if you,\nif you want to learn a little bit more about that, and you didn't see the video\non that, there is a video that deals with message boxes and you can check. All right. So here we go. We're going to go ahead and plug\nin the values for my message. Now this is going to be rather long,\nwhich is why I'm actually storing it in a variable because otherwise this huge\nlong chunk of code would look really weird inside of my input box code. It would just look like\nthere's too much stuff there. And when I'm reading it six\nmonths from now, I would have a hard time dissecting it. So I'm just going to put my\nwhole block of text here. So enter the region of your\nchoice and that's what we'll allow our end users to choose from. There we go. And then I want to create a hard\nreturn in my input box there. So I am going to put in my VBC R L F\nconstant, and that's going to allow me to make a hard return in my input box. There we go, BBC RLF, and I am\ngoing to need those ampersands on either side of that. And then just so that you guys\ncan see me typing in the rest of this stuff, I'm going to put in my\ncode continuation character there. It's also for me for six months from now,\nwhen I'm trying to read this thing, it's easier to see it blocked out like this. Okay. So my end users are going to be able to\nsee the following options so they will see an option for Southeast, and then we'll\nmake a hard return and I'm not going to type all these outright in front of you. Cause that would be boring to look at. I am just going to type out all of\nthe divisions that you'll need here. You'll need Southeast. You'll need Northeast. You'll need Midwest. You will need Southwest. You will need Northwest. And finally far west. Why don't you take a second, pause the\nvideo and complete a set of code here. That's going to give the end user. All of these options Southeast\nNortheast Midwest, et cetera. And they can type 1, 2, 3, 4, 5, 6 for\neach one of those respectively, and then come on back and we'll continue the code. Welcome back. Now that we've actually\nput in the message here. It let's actually use that message and\nwe're going to make our input box and the input box, whatever my end user types\nis going to be received in this variable that we've already declared called region. So region is going to be the\nresult from the input box. And my input box is going to have my\nmessage as the prompt, and then the title here can just be something like region. And then I can just put in some\ndefault text, like enter 1, 2, 3, 4, 5. Now based on their input, I'm going\nto need to do a specific thing. I'm going to need to run one\nof those move macros that we looked at at the very beginning. So I'm going to make a\nselect case structure here. That's going to allow me to\nvery easily create a results from each one of these cases. So in the case that they enter in one,\nthen I want to call upon Southeast move. That's what that's named. There's a naming convention for all these. So it's going to be pretty\ndependable if they type into, of course, that's Northeast. So then I would call upon Northeast\nmove and you can probably see the convention that's coming in here. It's just the abbreviated term\nfor that particular division. And then the word move. So I'm going to go ahead and pause the\nvideo again, or rather you should go ahead and pause the video again and\ncomplete your code there and come on back and then we'll keep going together. Welcome back. Okay. Let's keep going. All right. So we've created a case\nfor each one of these. Now, if they type in something\nthat we're not expecting, or we don't want them to type in, I'm\ngoing to make an else clause here. So I'm going to say case else, and then\nwe're going to give them a message box. And, uh, they're going to be able to\nclick on one of the buttons in the message box, which I'm going to store\nthe input from one of those buttons in my yes-no answer, variable that\nwe declared at the beginning here. And that's going to receive\nthe input from my message box. And maybe we'll say something like you\ndidn't type a number between one and six. Try again. And we will specify the, we want a VB. Yes, no box. That's going to give them the\nchoice between yes and no. And then that choice is going to\nbe stored in my yes, no answer. Now, if yes, no answer. Ends up being yes. If they say yes, I do want to try again in\norder to start this macro all over again. All I have to do is call to the\nname of this particular macro, which happens to be called move by input. I do, of course have to end my if\nstatement with a bookend there. And I also have to end my select statement\nwith an end select statement there. And there we go. That's the entirety of\nthis particular macro. Why don't you go ahead and pause\nthe video and just make sure you're all caught up with me and your\ncoach should look just like this. And if yours looks like mine, then\ncome on back and let's keep going. All right. So assuming that your code looks like\nmine, we're going to keep on going. So in the next little macro that\nwe're going to be making here, we're actually going to be putting\nin some of the texts for the logs. So this is going to be pretty easy. This is going to be some of the\nbeginner stuff that we were doing. Just if we aren't going to be using the\nrange object and the end method, which is going to allow us to figure out where\nthis list ends, because maybe some of my team's are a hundred people long and some\nof my teams are only six people long. And so I want to essentially start really\nfar down and then I'll just say end. So go up and find the very first cell\nthat has content in it and select it. And then once you've selected\nit, I want to actually offset downward by a couple of rows here. So I'm just going to say offset. And I do put in my rows first. So we'll just say, um, offset by. I was going to say two, but\nlet's say three, let's give it some good, healthy space. Okay. And now I'm going to actually\nput in the word logs so that I know what the data is there. And then we'll put in some headers right\nunderneath it in the row underneath it. So I'm going to say selection\ndot value equals the word log. And maybe I also want this\ntext to be bigger than the rest of the text and bolded. So I'm just going to make a\nlittle width and with statements that I can do this pretty fast. So selection dot font, and then\nwe'll say the size of that font equals 2016, whatever you want. And then we'll also say bold equals true. So we're going to make it bold. And I'm going to end my width statement. That's going to make that look a\nlittle bit bigger than everything else, and it's also going to make it bold. And then we're actually going\nto put in all the headers here. So let's move one row down. And then we're going to put in the\ntitle there called client name. And then the other thing that\nI'm going to do is make it bold. So I'm going to say selection\ndot that bold equals true. Now I'm going to be putting\nanother header in here, but I don't want to go down again. So my offset is no longer\ngoing to go down by one row. It's going to go to the\nright by one column. So this time I'm going to say selection\ndot offset, no rows down, but one column to the right, and then select\nthat and then put in the word contact. All right. This little block of\ncode that we just did. You're going to do this over and over\nand over again in order to create all the headers of interest for you. I'll give you some\nsuggested header titles. Maybe you want the date\ninformation in there. Maybe you want the duration in there. Maybe you want some notes\nabout the call in there. So why don't you just take a second,\npause the video and create a little code block for each one of these\nheaders that puts in the title for that particular header there. Go ahead and give that\na shot and come on back. I finished out those few blocks\nof code there, and now I have all the headers that I'm going to\nneed for this particular macro. And so now it's time to move\non to the duplication process. So let's go find the little macro\nthat says duplicate monthly law. Now, in this case, we are going to\ncreate a four next statement in there. We're also going to create a court,\na select case statement that is going to, we're also going to create an inbox\nthat allows our end users to choose which quarter they want to populate for. Or so the inbox is going to ask\nthem which quarter, and they can type in one or two or three or four. And then in the case that they type\nin one, then something special is going to happen for quarter one. In the case of they type in to something\nspecial's going to happen for quarter two. And then we'll go ahead and, uh, get\nthe macro code in there that actually takes care of the result of that. So if I wanted to go ahead and\nstart this from scratch, I would, I would probably be creating some\nvariables here that are later, are going to store some information. Namely, I'm going to create\na variable for my, for next. Now you don't have to do this, but I\nlike to do that and I'm going to call it why this time I've been using X so far\nthroughout our practices, but I'm going to use Y in this particular example, why? Just because I feel like it. Okay. And then I am going to\nneed to put in a input box. That input box is going to have to feed\nits result into a particular variable. So I'm going to need another\nvariable that can just receive the results from the input box. Now, I'm just going to ask my end user\nto type in a number, meaning the variable that's going to contain that information\ncan be an integer variable, just like the one that I've already created. So we'll call this the quarter\nselect variable, and I'll just put a comment in there. And now I can put all these\nvariables on the same line. So the quarter select variable,\nwhich is going to receive the user input, that is an integer variable. And let's go ahead and\nactually create that variable. So quarter select is going to\ncontain the result from an input box. That asks, which quarter is this for now? Eventually I'm going to have a four next\nstatement that is going to populate this log, the log that's going to be created. The log that we created\nthan the last macro. What we want to do is duplicate this\nlog three times over, depending on which quarter we're in, it's going to\nname it by the months in that quarter. So, um, I'm going to create\na for next loop here. And we'll say for Y equals 1,\n2, 3, cause they're only ever three months in a quarter. And what I want to duplicate is,\nuh, the copying of those worksheets. So I'm always going to start with\nworksheets one, because I've already moved to the worksheet that I'm\ninterested in to the very beginning. So worksheets, not one that copy. And then I'm going to specify in my\nargument that I want to actually place that after the very first worksheet\nin the workbook or in this case, I want to place it after worksheet Y so\nthe first time this happened happens, I want to place it after worksheet Y\nand the second time it happens, it's going to place it after worksheet two. Cause at that point, Y is\ngoing to be equal to two. Okay. Now think about it. We've already done an example like this. So let me just remind you once\nI actually place that worksheet. Let's say you were going through it\nfor the very first time at that point. Y equals one. So when I place it after worksheet one,\nthen the worksheet that I'm actually focusing on is now technically worksheet. But the second time I go through\nthis, then it's going to end up actually being worksheet three. And the third time I go through\nthis, it's actually going to end up being worksheet four. So if I want to select the one that I\njust put in, I'm going to need to say worksheets Y plus one, because it is\ngoing to be pushed to the right of would be Y and we'll say the name for that is\ngoing to be based on a particular month. So we're going to use our date\nserial function to be able to cycle through the different months. So I'm going to start by putting\na date serial function in here. And just like in the example that\nwe did earlier, we don't actually care about the year you could put in\nthe year, 2016 or 2017, whenever you are watching this particular video. So you can go ahead and put that year\nin, or you could just put it in the value of one, cause it doesn't really matter. You're not going to use\nthe, the year and here. Well, we are going to use is the\nparticular quarter, but if I used quarter select here and said, use\nquarter select, or if I used Y if I used Y then the month would be January,\nFebruary, or March, but that doesn't really allow my end user to choose a\nparticular quarter and have it populate the months for that particular quarter. Right. So I'm going to have to do something\na little bit more interesting. I'm going to have to create a statement\nup higher and yes, that is incomplete. That's okay. Because we're just following through\nwith this logically, uh, right now quarter select is equal to the value\nof one or two or three or four, but later on, maybe I want to be able to use\nthis value to say, okay, then start if they typed in one that's the quarter. So. But I want that value to switch\nto January, which is also one. So that would be fine. But if they type in quarter two,\nthen I actually want it to start with April, which is month four. If they type in three, I want it to\nstart with July, which is month seven. And if they type in quarter\nfour, then I wanted to start with October, which is month 10. So I'm basically going to create a\nselect case statement that is going to reassign the value for quarter select\ndepending on what the end user typed in. So if they typed in one, then\nwe're going to reassign the value or quarter select to one. That'll be fine. But if they type into, then we're\ngoing to reassign the value of quarter select to start with April, which is. And if they choose quarter three, then\nwe're going to reassign the value of quarters select to start with July, which\nstarts my third quarter of the year. And in the case that they type in\nthe fourth quarter, then I want to reassign the value of quarter select to\nstart with month 10, which is October. And then in the happenstance that\nthey type in something else I do want to put in a message box that\nallows them to choose something else. Right. So I'm going to say a yes,\nno answer, but wait a second. I don't actually have a variable\ncalled yes, no answer up here yet. Well, that's eventually going to\nreceive input from a message box, so I know that's going to be an integer. So I'm going to go ahead and go\nback up here and say yes, no answer. And there are the three\nvariables that I'm going to need. Don't worry. There. Aren't going to be any more. So, yes, no answer is going to receive\nthe input from my message box here. And my message box is going to\nsay, or you didn't enter a valid quarter number, try again, and\nwe'll allow them to type in yes. Or, or click the buttons for yes or no. And then we'll create a\nif clause that says if, if they say yes, then we're\ngoing to start all this over again, duplicate monthly log. That's the name of this macro. And I do need to close out the\nbookend for the F statement. I also need to close out the bookend\nfor the select statement, and now I can get back to what I was doing,\nwhich is creating my four next year. My last line here says worksheets,\nY plus one, that's going to choose the particular position of that\nworksheet that I just placed. The name of it is going to be date\nserial, my date serial function, which I'm putting in one for the year. Cause I don't really care about the year. And then I'm going to use quarter select. Now what the new value\nis for quarter select. And we're going to say, okay, the first\ntime it goes through this, I want it to use the very first number here. So in the first case that it goes\nthrough quarter two, let's say I want it to choose month four, but\nthe second time it goes through it, I want it to choose month five. And at this point, if I just put in\nquarter select, it's only ever going to choose month four every single time. So I'm going to have to say\nPorter select plus Y whatever Y happens to be at that moment. Now that's going to make the first\nincarnation of this actually go to five. So I'm going to say minus. And what's going to happen here\nis it's going to take into account the growing value of Y but then\nit's just subtract one from it. So it actually goes to\nthe correct month there. And then I'm putting in the day, again,\nI don't care about the day, which is why I'm typing in the number one there. So it doesn't matter. And I want it to populate as\nthe fully spelled out month. Now I did forget to put my format\nfunction here, which of course is the whole point of this so that I\ncan actually get my format function to populate the given month there. Okay. So this last little statement that we\nput in here that is M M M M course, that does pertain to the format function. We did cover this exact usage of format\nand date serial in a previous video. So if this is looking a little bit\nforeign to you, go ahead and check out that earlier video and it'll look\nlike it makes a little bit more sense and I'm going to have to finish out\nmy four next statement with a next Y. Okay. And then I should be all done. Make sure that you have completed\nthis particular macro here and then come on back and we'll keep going. All right. So the last thing I need, my\nmacro here to do is actually print out all the worksheets here. So I'm just going to say worksheets too. Cause remember the very first one is\ngoing to be Southeast team, but the second one is going to be for January and the\nsecond and the third one is going to be for February and the fourth one is\ngoing to be from March because that's the order that they're going to be placed in. So I'm just going to say worksheets\nto print out worksheets three printout and worksheets or printout. And you could definitely use\nit for next statement to cycle through those numbers there. If you wanted to. And assuming that we have. Done everything correctly that we haven't\nmisspelled any variables and that we have been placing everything in the right spot. Then when we come back up to the\nvery top, we're just going to go ahead and enter in a couple of call\nstatements up here at the very top. So you're going to want to\nput in call and then call to each individual macro up here. You can go ahead and do that\nright now and then come on back and we'll actually run this code. All right. So now that we put in our call\nstatements here, we can actually just click on our play button. And if it's all working\ncorrectly, it's going to ask us for the region that we want. And I can enter in a particular region. Like I'll just say region one. And then it will ask us\nwhich quarter this is for. And maybe I'll test it out by saying\nquarter two, and then it generated those. And now it's going to print them for me. So I'll say that the very first\none is supposed to be April. The second one is supposed to be may. And then the third one\nis supposed to be June. And there we go. Now it is completed. And I do have sheets for\nApril, may, and June. And that's exactly what\ngot created as a PDF there. And with that, we are done\nwith our massive macro example. Congratulations, you have now officially\ncreated some pretty hefty macro script. We are done with the major\nportion of the class that takes care of massive macro scripting. So if that's what you were in it for,\ncongratulations, come on back though, because we're going to be talking\nabout creating your own functions. If there's a specific kind of a function\nthat you want to be able to create that isn't already in Excel, that's\nwhat we're going to be doing next. So come on back and we'll\nlearn a little bit about that. Welcome back. And now we get to some\nreally exciting stuff. We are going to start\ntaking a look at some U D F. This stands for user defined functions. You are the user, you're going\nto be defining some functions. And so what I want you to do is\nmake sure that you have the user file, the work files called UDFs,\nmake sure that you got that open. And also that you have your\nvisual, basic applications open. You are going to need the module\ncalled a user defined functions, open. There's another module\nin here called completed. So if you want to follow along and not\nactually do the scripting, but just want to follow along and see exactly what we're\ndoing, you can go there and check out and see what has been predesigned for you. But if you are doing a hands-on\nexperience with me, make sure to go to the module called user defined\nfunctions, a user-defined functions. We're going to be designing\nour own function here. And in order to do that, you're going\nto want to insert a new procedure. So we're going to the insert dropdown\nmenu in visual basic, and I'm choosing a procedure, but this is\nnot like any procedure that we have inserted so far, because this is a. Function procedure. And I'm going to go ahead and name\nthis well, I'm going to take a, a road trip pretty soon, and I'm going with a\ncouple of friends of mine altogether. We have three different vehicles. We have a Prius, we have a Mustang\nconvertible, and then we have an RV that we're taking along. Somebody has somewhere to sleep. And so I want to be able to\nfigure out for every stretch, how much my fuel is going to cost. It's one of the things\nI have to figure out. And so that is the kind of function\nthat I'm going to design here, and I'm going to call it cost or gas. Now I'm going to give myself\na little bit of space here. It helps when you're\ndesigning these functions. If you have sort of given it a\nlittle bit of thought and pre designed the formula, that's going\nto be required by this function. Good reasons to design\nyour own functions are. If I do this six times a day, and I\ndon't want to have to plug the function in, that's a good reason to do this, or\nmaybe I do this once every six months and every time I do this, it takes a\nwhole lot of thinking power to remember exactly how to calculate this thing. That would be another\ngood reason to design it. Now, take the time to do it now. And then six months from now, or six weeks\nfrom now, or whenever you have to do this, all you have to do is plug in the numbers. So in this case, I only go on road\ntrips about every six months or so. And every single time, I have to\nremember how to do this function. So I am just going to program it. And from now on, I won't have\nto do the formula at all. I'll just do this really cool function. So here we go. The basic breakdown in my formula is\nsuch, so I'm going to say cost for gas. The name of this function cost for\ngas equals the miles of each stretch. Okay. Cause I want to be able to calculate\nthis for each stretch of my. The miles of that stretch divided\nby the miles per gallon of that particular vehicle multiplied\nby the local gallon cost. I'm going to be going to\na few different states. So I do want to be able to calculate\nthis cost based on the local cost of gas and not just the national average. All right. So these are going to be the, uh,\ntitles that I'm going to take into account also known as arguments. And in case you've been wondering\nthis whole time, what these are for, this is what they're for. I'm going to go ahead and\nput my arguments in there. Now this looks a little bit\nmore like the regular functions that you're used to in Excel. You do have the name of the function\nand then the opening and closing parentheses, and the arguments are\ninside those separated by commas. That's exactly what\nwe're going to do here. I'm going to let VBA and therefore\nExcel know exactly what kind of data should be expected in each\none of these arguments here. So I'm going to say. Miles of stretch is going\nto be a double data type. That's one of the preferred data types,\nbecause it's a, it's a number, but it can be all different kinds of numbers. It can be some pretty long lengths of\ndecimal place holders, pretty flexible. So miles of stretches, double\nthe other two of these are going to be as double as well. So I'm going to say, uh, miles\nper gallon as double and the local gallon costs as double. Okay. And I know it's kind of crazy, but,\nuh, that's about all there is to it. So let's go ahead and use it. I'm going into Excel and I'm\ngoing to say equals cost for gas. And there's my cool function\nthat I just designed. I can double click on it. If I have all of the arguments memorized,\nI can go ahead and put them in here, but you'll see that I don't get this, those\nnice, nice little hint windows that I get from the predesigned Excel functions. And so I would love to open up\nmy function, arguments, windows that I can actually get the\ntitles of each one of these. So miles of stretch, let's\nsee the miles per gallon. We're figuring it out for the Prius first\nand over here on the left-hand side, we do have the breakdown of miles per\ngallon, 51 for the Prius C the Mustang convertible gets 29 and the RV gets nine. About the same as my El Camino\nthat I drove around in high school. So miles per gallon of our\nPrius, first of all, is 51. So I'm just going to go\nahead and click here on 51. And then the local gallon cost for\nthis particular stretch is 2 86, pretty steep, but I'm starting from California. So there it is. All right, I'm going\nto go ahead and click. Okay. And now I'm going to use my autofill\nhandle to populate the rest of this car. I'm going to choose to fill\nwithout formatting and to keep my table nice and looking good. All right. And that's about it. So it can be as simple as this and\nI could fill out the rest of my table here and say, miles of stretch\nfor this one is this and miles per gallon is start with my Prius again. And the local gallon cost is\nabout this for Oregon and click. Okay. There we go. And fill without formatting. Maybe I want to clean that up a\nlittle bit with my dollar signs. There we go. And I do have a cool little,\nsome function down here. That's already programmed in there\nthat is calculating the total for me. And that's about all there is to it. So take a minute and complete\nyour function for cost for gas. And I am going to maximize my visual\nbasic for applications, windows, so that you can see this function. Why don't you go ahead and\ngive it a shot and come on. All right, then let's move\non to our second example. This is one of my favorite\nprofessional examples, uh, to calculate percent of change over time. This tends to be somewhat important\nin a lot of industries, uh, somewhat being an understatement, being able to\nfigure out the percent of change over time of a particular set of information. Now, there are many different ways to\ncalculate percent of change over time. But in this particular case, the way\nthat we are figuring this out is by taking the current and subtracting\nfrom it, the previous value. And then we're going to defy\nthat over the previous value. And that is going to give us a nice little\ncalculation of percent change over time. So here we go. I'm going to go into\nmy visual basic window. I'm going to click on insert\nand I'm going to insert a new function procedure, and I'm going\nto call this percent change over. So just like last time, the designing of\nthis function is going to be pretty easy. If I've already sort of figured it out\nand written it down and know exactly how I'm going to calculate this. So I'm going to start by saying\npercent change over time equals. And I'm going to put this in\nparentheses current minus previous over previous. No, I didn't actually have to\ncapitalize it there cause it would have gotten fixed later on. All right. So current minus previous,\nover previous, and that's going to be my calculation there. I am going to need to go inside my\nparentheses here and define exactly which data types should be expected here. So the current value it should be done. And previous should also be double. All right. And there we go. That's all there is to it. So I'm going to go ahead\nand use that over here. Percent change over time. There it is. And let's see the current value. Let's see, we're looking at\nsnowfall in inches here for Tahoe. So current is 4 24 and that was in 2009. And previous was whatever is above that. So the very first time I calculated\nthis, I'm not going to get an answer here cause I don't have any previous\ndata, but, um, that pattern worked for me because then when I auto fill down, then\nI'll be grabbing the value right above it, which will be the previous value. Okay. So the first time it's going to look\nweird and then I'm going to auto-fill down and there's my nice little\ncalculation of percent over time. And that is populating on my chart here. Okay. All right. And if I want to calculate percent\nchange in working capital, I'm going to use the exact same\ncalculation percent change over time. Okay. And here we go. This is my current capital and my previous\ncapital's going to be right above it. And I click, okay. Again, it's going to look weird\nthe first time and then for the rest of them, there we go. Alright. And with that, we've calculated\npercent change over time. Why don't you give this one, a shot and\nthen come on back and we'll get into a little bit more complicated stuff. All right. For this last UTF example, what\nwe're going to be doing is figuring out the surface area of our house. Cause we got a paint job coming up\nand I don't know how much paint. Now, in this example here, the math is\ngoing to take you back to geometry class. So if you didn't like geometry,\ndon't worry about the math here. Okay. You don't need to wrap\nyour brain around that. You don't have to remember that at all. All you have to remember is that\nas complicated as this function is about to get, ideally in the end,\nyou're only going to have to plug in a couple different variables, right? You're going to have to plug in this\nnumber, the height of the house square block, which is this the height of\nthe roof triangle block, which is this year, the width of the house. And it's that, and the depth\nof the house, which is that. So those are going to be the\nonly four things that you're going to have to plug in. Now, when you're programming this\nfrom the beginning, it is going to look a little bit complicated\nwhen we're doing it together. And that is because it is a little\nbit complicated to figure out. And that's why I want to\nturn it into a function. So I don't have to figure it out. Okay. I, uh, I have it at the top of my\nmind right now, I'm going to make it into a function and I'm never going\nto have to think about it ever again. So here we go. I'm going to insert a function here. I'm going to insert a procedure\nagain, that's going to be a function procedure, and we're going\nto call this house surface area. Okay. So eventually the calculation\nthat's going to happen is it's going to say house surface area\nequals each one of these panels. So the front and back, these\nare going to be the same size panel, right then the sides. These are going to be the same\nsize panel and then the roof sides. Those are going to be\nthe same size panel too. So what we'll do is we'll\ntake into account the front end back, had it to the side. And add it to the total size of the roof. Eventually that is going to be\nthe entirety of my function. Now I am going to need to do some slightly\nmore complicated calculations here. Okay. The sides of the house, that's going to\nbe easy sides equals the height of the house times the depths of the house times\ntwo, cause there's going to be two sides. Hey, so the sides equal to\nheight times the depth times two, because there's two of them. So that one's going to be pretty easy. I do know now that I'm going to have\nthis thing called height of the house and this thing called depth of the\nhouses are going to be arguments. Let's go ahead and define those right now. So height of the house, she'll\nbe double and then depth of the house should be doubled as. All right. So we got that one. Now the front and back is going to be a\nlittle bit more complicated because if you remember back from geometry class,\na triangle is normally calculated by the height times, the width divided by two. Now just so happens that there\nare actually two of them. So you wouldn't have to do this much work. You could just see the width times\nthe height, but anyway, we're going to do it the long way so that we can\nappreciate exactly how, uh, how cool this function is going to be by figuring\nout all this stuff when we're done. So we're going to say front and back\nequals and eventually the front and back is going to equal the height of\nthe house times the width of the house. So that's just this simple little\nheight times the width we're taking care of this square block right here. And then we're going to do this\nlittle triangle piece separately. We're going to add that. I don't really need to put these\nparentheses in here, but I am. We're going to add that to this little\npanel right here, which is eight feet high and seven and a half feet wide. So that's this little\nhalf a triangle here. Okay. Okay. So I'm going to say height of\nthe roof times the width of the house divided by two, right? Because this little panel here is half,\nhalf of 15 half of the width, and I'm going to surround that with little\nfriends here and I want this whole thing. Multiplied by two, because\nthere are actually two of them. Right. I have, I have one of these on the\nfront and one of these on the back. So I'm going to do this little\ncalculation here and then I'm going to multiply the whole thing by two. And yes, there are some redundancies here\nwith numbers that you could get a little bit more fancy, uh, algebraically in here. All right. And then the last thing I'm going\nto need to take into account is, uh, oh, by the way, let's not forget. We have this new argument\ncalled Whit house. So let's go ahead and put that in here. So height houses, double. I'm going to just going to put it\nright here with house as double. Oh, there we go. Alright. And then the roof slant roof slant. Okay. This is going to be. I need to figure out how big\nthis thing is going to be. How, what size this particular line\nis right here, the slant of the house. Now, if you guys remember back from\ngeometry, uh, you can do your, a squared plus B squared equals C square to figure\nout exactly what the, um, what the size of this side of the triangle is going to be. So we're going to go ahead and do that. Now. Normally, if we were going to\ndo this, we would, um, we would use the, a squared, right. Which would be the width divided\nby two multiplied by itself. Okay. Times the height of the\nrooms multiplied by itself. That's the squared part. Okay. So I'm going to do that first\nheight, roof times, height, roof. I don't have anything\ncalled height roof yet. So I'm just going to add that\nin while I'm thinking about it. Right roof. Here we go. Uh, Hide roof times\nthe height of the roof. Plus, and again, I don't really need\nto put those prints there just to help me visually later on, plus the\nwidth of the house over two times, the width of the house over to, okay. And this is supposed to\nequal this thing squared. So my roofs land is\ngoing to be this square. And this is a cool\nlittle VBA function here. You can just put SQR and it\nwill it'll it'll figure out the square root of this here. And then I'm just going to plug that\ninto this thing called reef slant. Okay. Now I probably could use a\ncouple of, uh, variables here. Probably could use variables for\nfront and back and sides and. And eventually if I'm going to\nfigure out what the total roof is, I probably want to get a little\nequation here that figures that out. So, so I figured out what\nthe, uh, roof slant is so far. So now I got to figure out\nwhat the actual roof is. So here we go. Roof equals roof slant times the\ndepth of the house times two, because there's two of them. So with that, I've actually figured out\nwhat the sizes of each panel of my roof. And I'm going to multiply that\nby two cause I have two of them. And now finally, I have this thing\nthat says how surface area equals front and back plus the sides plus the roof. I do have a couple of things\nthat are undefined here. A couple of variables\nhere that are undefined. So I'm going to go ahead and\nmake some variables for this. So I'm going to say there's a\nvariable called brief slant and front and back and sides and roof. I'm going to do that up here, sides front and back. And roof slant as double and with that, does she work if\nI haven't spelled it anything in correctly, this should work. Great. So I'm going to go ahead and\nplug this in and see if it works. Here we go. Is the house surface area. The height of my house is this, the\nwidth of my house is this depth is this. And then the height of the\nroof is this and I'll click. Okay. And I happen to know\noff the top of my head. That that is correct. All right. So give this a shot. I know this was a rather complicated\nexample, but this, that makes it a perfect example for why you would define it\nas a UTF and use it as a UTF from here on out, as opposed to figuring out the\nformula, every time you had to paint your. Here you go. Here's your formula. If you haven't done so already go ahead\nand finish this and then come on back. And with that, congratulations\non completing the visual basic for applications. Excel course, feel free to go\nback any time and review these files, the notes, and also the\nPowerPoint for a little refresher. It has been an absolute\npleasure teaching you from afar. Hopefully I'll get to meet\nyou in person one day."

### Ran Playwright code
await page.evaluate('() => {\n  const segments = document.querySelectorAll(\'yt-formatted-string.segment-text\');\n  const texts = [];\n  segments.forEach(seg => {\n    const text = seg.textContent.trim();\n    if (text) texts.push(text);\n  });\n  return texts.join(\' \');\n}');
