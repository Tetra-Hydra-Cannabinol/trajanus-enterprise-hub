<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trajanus Enterprise Hub v2.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* ============================================
           COLOR SCHEME - Extracted from original
           ============================================ */
        :root {
            --brown-dark: #1f1410;
            --brown-mid: #3d2a1f;
            --brown-light: #5c4033;
            --cream: #FFF8F0;
            --orange-dark: #a85a1b;
            --orange-mid: #cc6e1f;
            --orange-light: #e8922a;
            --tan: #d4a574;
            --gray-dark: #2d2622;
            --gray-mid: #4a413a;
            --gray-light: #a89890;
            --green-badge: #28a745;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--brown-mid) 0%, var(--brown-dark) 100%);
            min-height: 100vh;
            display: flex;
            color: var(--cream);
        }
        
        /* ============================================
           SIDEBAR
           ============================================ */
        .sidebar {
            width: 320px;
            background: rgba(0,0,0,0.3);
            padding: 25px;
            display: flex;
            flex-direction: column;
            border-right: 1px solid rgba(255,255,255,0.1);
            overflow-y: auto;
        }
        
        .sidebar-header {
            text-align: center;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 25px;
        }
        
        .sidebar-header h1 {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--cream);
            letter-spacing: 1px;
        }
        
        .sidebar-header .tagline {
            font-size: 1.07rem;
            color: var(--orange-light);
            margin-top: 8px;
            font-style: italic;
        }
        
        .sidebar-header .ei-logo {
            width: 120px;
            height: 80px;
            margin: 5px auto 8px auto;
            display: block;
        }
        
        .sidebar-header .ei-logo svg {
            width: 100%;
            height: 100%;
        }
        
        .sidebar-header .version {
            font-size: 0.7rem;
            color: var(--gray-light);
            margin-top: 10px;
        }
        
        .project-section {
            margin-bottom: 30px;
        }
        
        .project-section h3 {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--gray-light);
            margin-bottom: 15px;
            padding-left: 12px;
        }
        
        .project-btn {
            width: 100%;
            padding: 18px;
            background: transparent;
            border: none;
            border-radius: 8px;
            color: var(--cream);
            text-align: left;
            cursor: pointer;
            font-size: 1.15rem;
            transition: all 0.2s;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .project-btn:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .project-btn.active {
            background: rgba(255,255,255,0.15);
            border-left: 4px solid var(--orange-light);
        }
        
        .sidebar-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .sidebar-badge.dev {
            background: var(--orange-mid);
            color: #fff;
        }
        
        .sidebar-badge.deployed {
            background: var(--green-badge);
            color: #fff;
        }
        
        .sidebar-footer {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .quick-access-section {
            margin-top: 20px;
            margin-bottom: 15px;
        }
        
        .quick-access-section h3 {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--gray-light);
            margin-bottom: 15px;
            padding-left: 12px;
        }
        
        .quick-access-btn {
            width: 100%;
            padding: 12px 18px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: var(--cream);
            text-align: left;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .quick-access-btn:hover {
            background: rgba(255,255,255,0.1);
            border-color: var(--orange-mid);
        }
        
        .living-docs-menu {
            margin-top: 8px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .living-doc-item {
            width: 100%;
            padding: 10px 12px;
            background: transparent;
            border: none;
            border-radius: 6px;
            color: var(--cream);
            text-align: left;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
            margin-bottom: 4px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .living-doc-item:hover {
            background: rgba(232,146,42,0.2);
        }
        
        .living-doc-item .btn-label {
            font-weight: bold;
            font-size: 0.9rem;
            color: var(--cream);
        }
        
        .living-doc-item .btn-description {
            font-size: 0.7rem;
            color: var(--gray-light);
            line-height: 1.2;
        }
        
        /* ============================================
           MAIN CONTENT
           ============================================ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: auto;
        }
        
        .header {
            background: var(--cream);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header-title h2 {
            color: var(--brown-mid);
            font-size: 1.5rem;
        }
        
        .header-title .breadcrumb {
            color: var(--gray-mid);
            font-size: 0.85rem;
            margin-top: 3px;
        }
        
        /* Clock - Horizontal bar */
        .clock {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            background: linear-gradient(90deg, var(--brown-dark), rgba(31, 20, 16, 0.5));
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            min-width: 320px;
        }
        
        .clock-left {
            display: flex;
            align-items: baseline;
            gap: 15px;
        }
        
        .clock-date {
            font-size: 15px;
            font-weight: 400;
            color: var(--cream);
            letter-spacing: 1px;
        }
        
        .clock-time {
            font-size: 15px;
            font-weight: 300;
            color: var(--orange-light);
        }
        
        .clock-session {
            font-size: 12px;
            color: var(--gray-light);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .clock-session i {
            color: var(--green-badge);
            font-size: 8px;
        }
        
        .workspace {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* ============================================
           APP LAUNCHERS
           ============================================ */
        .app-launcher-section {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .app-group {
            background: var(--brown-dark);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 15px;
            flex: 1;
            min-width: 200px;
        }
        
        .app-group-header {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray-light);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .app-group-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .app-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 10px 12px;
            background: var(--brown-dark);
            border: 2px solid var(--brown-light);
            border-radius: 4px;
            color: var(--cream);
            cursor: pointer;
            font-size: 10px;
            transition: all 0.15s;
            min-width: 56px;
        }
        
        .app-btn i {
            font-size: 18px;
            color: var(--orange-light);
        }
        
        .app-btn:hover {
            background: var(--orange-mid);
            border-color: var(--orange-mid);
            color: var(--brown-dark);
        }
        
        .app-btn:hover i {
            color: var(--brown-dark);
        }
        
        /* ============================================
           SESSION CONTROLS
           ============================================ */
        .tool-section {
            background: var(--brown-dark);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 20px;
        }
        
        .tool-section-header {
            font-size: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #FFFFFF;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .button-grid {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .session-btn {
            padding: 16px 24px;
            background: linear-gradient(145deg, #d4a574, #b8895a);
            color: #2d1810;
            border: 1px solid #e8b88a;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.15s ease;
            box-shadow: 0 3px 0 #8b6b42, 0 4px 8px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            gap: 4px;
            text-align: left;
        }
        
        .session-btn:hover {
            background: linear-gradient(145deg, #e8b88a, #d4a574);
            box-shadow: 0 2px 0 #8b6b42, 0 3px 6px rgba(0, 0, 0, 0.3);
            transform: translateY(1px);
        }
        
        .session-btn:active {
            transform: translateY(3px);
            box-shadow: 0 0 0 #8b6b42, 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .btn-label {
            font-weight: bold;
            font-size: 0.95rem;
        }
        
        .btn-description {
            font-size: 0.7rem;
            color: rgba(45, 24, 16, 0.7);
            line-height: 1.3;
            font-weight: normal;
        }
        
        /* Tooltips */
        [data-tooltip] {
            position: relative;
            cursor: help;
        }
        
        [data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 12px;
            background: rgba(0,0,0,0.95);
            color: #fff;
            font-size: 0.75rem;
            white-space: nowrap;
            border-radius: 6px;
            z-index: 1000;
            margin-bottom: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        [data-tooltip]:hover::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: rgba(0,0,0,0.95);
            z-index: 1000;
            margin-bottom: 2px;
        }
        
        /* Section Introduction */
        .section-intro {
            background: rgba(232,146,42,0.1);
            border-left: 3px solid var(--orange-mid);
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 6px;
            color: var(--cream);
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .section-intro strong {
            color: var(--orange-light);
            font-weight: 600;
        }
        
        /* ============================================
           TERMINAL
           ============================================ */
        .terminal {
            background: #1e1e1e;
            border-radius: 10px;
            overflow: hidden;
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 300px;
        }
        
        .terminal-header {
            background: #2d2d2d;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .terminal-tabs {
            display: flex;
            gap: 5px;
            flex: 1;
        }
        
        .terminal-tab {
            padding: 6px 15px;
            background: rgba(255,255,255,0.05);
            border: none;
            border-radius: 5px 5px 0 0;
            color: #fff;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
            white-space: nowrap;
        }
        
        .terminal-tab:hover {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }
        
        .terminal-tab.active {
            background: var(--orange-mid);
            color: #fff;
        }
        
        .terminal-tab .close-tab {
            margin-left: 8px;
            opacity: 0.6;
        }
        
        .terminal-tab .close-tab:hover {
            opacity: 1;
        }
        
        /* Permanent Tabs - Always visible, can't be closed, equal width */
        .terminal-tab.permanent-tab {
            background: rgba(204, 110, 31, 0.15);
            border-left: 2px solid #cc6e1f;
            font-weight: 500;
            color: #fff;
            min-width: 160px;
            text-align: center;
        }
        
        .terminal-tab.permanent-tab:hover {
            background: rgba(204, 110, 31, 0.25);
            color: #fff;
        }
        
        .terminal-tab.permanent-tab.active {
            background: var(--orange-mid);
            border-left: 2px solid #e8922a;
            color: #fff;
        }
        
        .terminal-tab-add {
            background: none;
            border: 1px dashed rgba(255,255,255,0.3);
            border-radius: 5px;
            color: var(--gray-light);
            cursor: pointer;
            padding: 4px 10px;
            font-size: 0.9rem;
        }
        
        .terminal-tab-add:hover {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }
        
        .terminal-actions {
            margin-left: auto;
        }
        
        .terminal-clear {
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 4px;
            color: var(--gray-light);
            cursor: pointer;
            padding: 5px 12px;
            font-size: 0.75rem;
        }
        
        .terminal-clear:hover {
            background: rgba(255,255,255,0.2);
            color: #fff;
        }
        
        .terminal-bodies {
            position: relative;
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .terminal-body {
            display: none;
            padding: 15px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 0.85rem;
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            line-height: 1.6;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        
        .terminal-body.active {
            display: block;
        }
        
        .terminal-body .info { color: #9cdcfe; }
        .terminal-body .success { color: #4ec9b0; }
        .terminal-body .error { color: #f14c4c; }
        .terminal-body .warning { color: #cca700; }
        
        /* ============================================
           STATUS BAR
           ============================================ */
        .status-bar {
            background: rgba(0,0,0,0.3);
            padding: 8px 20px;
            display: flex;
            gap: 30px;
            font-size: 0.75rem;
            color: var(--gray-light);
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ec9b0;
        }
        
        /* ============================================
           RIGHT PANEL - PROJECT FILES
           ============================================ */
        .right-panel {
            width: 400px;
            min-width: 280px;
            max-width: 800px;
            background: rgba(0,0,0,0.3);
            border-left: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            resize: horizontal;
        }
        
        .right-panel-header {
            padding: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .right-panel-header h3 {
            font-size: 0.85rem;
            color: var(--cream);
        }
        
        .panel-section {
            padding: 10px 15px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .panel-section h4 {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray-light);
            margin-bottom: 10px;
        }
        
        .file-list {
            max-height: 250px;
            overflow-y: auto;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            padding: 8px 10px;
            margin: 2px 0;
            background: rgba(255,255,255,0.03);
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .file-item:hover {
            background: rgba(255,255,255,0.08);
        }
        
        .file-item.selected {
            background: rgba(204,110,31,0.2);
            border-left: 2px solid var(--orange-mid);
        }
        
        .file-icon {
            margin-right: 10px;
            font-size: 1rem;
            color: var(--orange-light);
        }
        
        .file-info {
            flex: 1;
            overflow: hidden;
        }
        
        .file-name {
            font-size: 0.8rem;
            color: var(--cream);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .file-meta {
            font-size: 0.65rem;
            color: var(--gray-light);
        }
        
        .file-actions {
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .file-item:hover .file-actions {
            opacity: 1;
        }
        
        .file-action-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: var(--cream);
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 0.65rem;
            cursor: pointer;
        }
        
        .file-action-btn:hover {
            background: var(--orange-mid);
        }
        
        .add-files-btn {
            width: 100%;
            padding: 8px 12px;
            background: linear-gradient(145deg, #d4a574, #b8895a);
            color: #2d1810;
            border: 1px solid #e8b88a;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            box-shadow: 0 2px 0 #8b6b42;
            transition: all 0.1s ease;
            margin-top: 8px;
        }
        
        .add-files-btn:hover {
            background: linear-gradient(145deg, #e8b88a, #d4a574);
            transform: translateY(1px);
            box-shadow: 0 1px 0 #8b6b42;
        }
        
        .empty-state {
            text-align: center;
            padding: 15px;
            color: var(--gray-light);
            font-size: 0.8rem;
        }
        
        /* Project-specific sections */
        .project-tools {
            display: none;
        }
        
        .project-tools.active {
            display: block;
        }
        
        /* Developer mode */
        .dev-mode-only {
            display: none;
        }
        
        body.developer-mode .dev-mode-only {
            display: block;
        }
        
        .dev-toggle {
            width: 100%;
            padding: 12px 18px;
            background: var(--brown-light);
            border: 1px solid var(--orange-dark);
            border-radius: 6px;
            color: var(--cream);
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .dev-toggle:hover {
            background: var(--orange-dark);
        }
        
        .dev-toggle.active {
            background: var(--orange-mid);
            border-color: var(--orange-light);
        }
        
        .dev-badge {
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.6rem;
            background: var(--green-badge);
        }
        
        /* User Guides Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal {
            background: var(--brown-mid);
            border-radius: 12px;
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            color: var(--cream);
            font-size: 1.2rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--gray-light);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-close:hover {
            color: #fff;
        }
        
        .modal-body {
            padding: 20px;
            overflow-y: auto;
            max-height: 60vh;
        }
        
        .search-box {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 6px;
            color: #fff;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .search-box:focus {
            outline: none;
            border-color: var(--orange-mid);
        }
        
        .guide-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .guide-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid var(--orange-dark);
        }
        
        .guide-item:hover {
            background: rgba(0,0,0,0.3);
            border-left-color: var(--orange-light);
        }
        
        .guide-item.hidden {
            display: none;
        }
        
        .guide-name {
            color: var(--cream);
            font-size: 0.9rem;
        }
        
        .guide-btn {
            padding: 6px 12px;
            background: var(--orange-mid);
            border: none;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
            font-size: 0.75rem;
        }
        
        .guide-btn:hover {
            background: var(--orange-light);
        }
        
        /* Preview pane */
        .preview-pane {
            flex: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            min-height: 180px;
        }
        
        .preview-pane h4 {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray-light);
            margin-bottom: 10px;
        }
        
        .preview-content {
            flex: 1;
            background: rgba(0,0,0,0.3);
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--gray-light);
            font-size: 0.8rem;
            padding: 15px;
            text-align: center;
            overflow: hidden;
        }
        
        .preview-file-icon {
            font-size: 3rem;
            color: var(--orange-light);
            margin-bottom: 10px;
        }
        
        .preview-file-name {
            color: var(--cream);
            font-size: 0.85rem;
            margin-bottom: 5px;
            word-break: break-all;
        }
        
        .preview-file-meta {
            color: var(--gray-light);
            font-size: 0.7rem;
        }
        
        .preview-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        
        .preview-btn {
            flex: 1;
            padding: 8px 12px;
            background: linear-gradient(145deg, #d4a574, #b8895a);
            color: #2d1810;
            border: 1px solid #e8b88a;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            box-shadow: 0 2px 0 #8b6b42;
            transition: all 0.1s ease;
        }
        
        .preview-btn:hover {
            background: linear-gradient(145deg, #e8b88a, #d4a574);
            transform: translateY(1px);
            box-shadow: 0 1px 0 #8b6b42;
        }
        
        .preview-btn.primary {
            background: linear-gradient(145deg, #2d8a4e, #1a5c2a);
            border-color: #28a745;
        }
        
        .preview-btn.primary:hover {
            background: linear-gradient(145deg, #34ce57, #2d8a4e);
        }
        
        /* ============================================
           FILE PICKER MODAL
           ============================================ */
        .file-picker-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .file-picker-container {
            background: var(--brown-dark);
            border-radius: 12px;
            width: 90%;
            max-width: 900px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }
        
        .file-picker-header {
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .file-picker-header h3 {
            color: var(--cream);
            font-size: 1.3rem;
            margin: 0;
        }
        
        .file-picker-header .close-btn {
            background: none;
            border: none;
            color: var(--cream);
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            line-height: 1;
        }
        
        .file-picker-header .close-btn:hover {
            color: var(--orange-light);
        }
        
        .file-picker-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .file-picker-left {
            flex: 1;
            padding: 20px;
            border-right: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .file-picker-right {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .file-picker-actions {
            margin-bottom: 15px;
        }
        
        .picker-btn {
            padding: 12px 20px;
            background: linear-gradient(145deg, var(--orange-mid), var(--orange-dark));
            border: 1px solid var(--orange-light);
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .picker-btn:hover {
            background: linear-gradient(145deg, var(--orange-light), var(--orange-mid));
            transform: translateY(-1px);
        }
        
        .selected-files-list {
            flex: 1;
            overflow-y: auto;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 15px;
        }
        
        .no-files-msg {
            color: var(--gray-light);
            text-align: center;
            padding: 40px 20px;
            font-style: italic;
        }
        
        .selected-file-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .selected-file-item:hover {
            background: rgba(232,146,42,0.1);
            border-color: var(--orange-mid);
        }
        
        .selected-file-item.active {
            background: rgba(232,146,42,0.2);
            border-color: var(--orange-light);
        }
        
        .file-item-info {
            flex: 1;
        }
        
        .file-item-name {
            color: var(--cream);
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .file-item-details {
            color: var(--gray-light);
            font-size: 0.8rem;
        }
        
        .file-item-remove {
            background: rgba(255,0,0,0.2);
            border: 1px solid rgba(255,0,0,0.4);
            color: #ff6b6b;
            padding: 4px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        
        .file-item-remove:hover {
            background: rgba(255,0,0,0.3);
        }
        
        .file-preview-header {
            color: var(--cream);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .file-preview-area {
            flex: 1;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 20px;
            overflow-y: auto;
        }
        
        .no-preview-msg {
            color: var(--gray-light);
            text-align: center;
            padding: 60px 20px;
            font-style: italic;
        }
        
        .file-preview-content {
            color: var(--cream);
        }
        
        .preview-image {
            max-width: 100%;
            border-radius: 6px;
        }
        
        .preview-text {
            font-family: 'Consolas', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        
        .file-picker-footer {
            padding: 20px 25px;
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        .picker-btn-secondary {
            padding: 12px 24px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: var(--cream);
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .picker-btn-secondary:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .picker-btn-primary {
            padding: 12px 24px;
            background: linear-gradient(145deg, #2d8a4e, #1a5c2a);
            border: 1px solid #28a745;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .picker-btn-primary:hover:not(:disabled) {
            background: linear-gradient(145deg, #34ce57, #2d8a4e);
            transform: translateY(-1px);
        }
        
        .picker-btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* ============================================
           FILE BROWSER MODAL
           ============================================ */
        .file-browser-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .file-browser-container {
            background: var(--brown-dark);
            border-radius: 12px;
            width: 90%;
            max-width: 1100px;
            height: 80vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 50px rgba(0,0,0,0.7);
        }
        
        .file-browser-header {
            padding: 20px 25px;
            border-bottom: 2px solid var(--orange-mid);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(232,146,42,0.1);
        }
        
        .file-browser-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .file-browser-title h3 {
            color: var(--orange-light);
            font-size: 1.4rem;
            margin: 0;
            font-weight: 700;
        }
        
        .file-browser-path {
            color: var(--gray-light);
            font-size: 0.85rem;
            margin-top: 4px;
            font-family: 'Consolas', monospace;
        }
        
        .file-browser-close {
            background: none;
            border: none;
            color: var(--cream);
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 35px;
            height: 35px;
            line-height: 1;
            transition: all 0.2s;
        }
        
        .file-browser-close:hover {
            color: var(--orange-light);
            transform: rotate(90deg);
        }
        
        .file-browser-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .file-list-panel {
            flex: 1;
            padding: 20px;
            border-right: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .file-preview-panel {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .file-search {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 6px;
            color: var(--cream);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .file-search:focus {
            outline: none;
            border-color: var(--orange-mid);
        }
        
        .file-list {
            flex: 1;
            overflow-y: auto;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 10px;
        }
        
        .file-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            padding: 12px 15px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .file-item:hover {
            background: rgba(232,146,42,0.15);
            border-color: var(--orange-mid);
            transform: translateX(4px);
        }
        
        .file-item.selected {
            background: rgba(232,146,42,0.25);
            border-color: var(--orange-light);
        }
        
        .file-icon {
            font-size: 1.5rem;
            min-width: 30px;
            text-align: center;
        }
        
        .file-info {
            flex: 1;
        }
        
        .file-name {
            color: var(--cream);
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 0.95rem;
        }
        
        .file-meta {
            color: var(--gray-light);
            font-size: 0.75rem;
            display: flex;
            gap: 15px;
        }
        
        .preview-header {
            color: var(--orange-light);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .preview-content {
            flex: 1;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 20px;
            overflow-y: auto;
        }
        
        .preview-placeholder {
            color: var(--gray-light);
            text-align: center;
            padding: 60px 20px;
            font-style: italic;
        }
        
        .preview-text {
            color: var(--cream);
            font-family: 'Consolas', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            white-space: pre-wrap;
        }
        
        .preview-image {
            max-width: 100%;
            border-radius: 6px;
        }
        
        .preview-metadata {
            color: var(--cream);
            line-height: 1.8;
        }
        
        .preview-metadata strong {
            color: var(--orange-light);
            display: inline-block;
            min-width: 120px;
        }
        
        .file-browser-footer {
            padding: 20px 25px;
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.2);
        }
        
        .file-browser-info {
            color: var(--gray-light);
            font-size: 0.9rem;
        }
        
        .file-browser-actions {
            display: flex;
            gap: 12px;
        }
        
        .fb-btn {
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s;
            border: none;
        }
        
        .fb-btn-view {
            background: linear-gradient(145deg, var(--orange-mid), var(--orange-dark));
            border: 1px solid var(--orange-light);
            color: #fff;
        }
        
        .fb-btn-view:hover:not(:disabled) {
            background: linear-gradient(145deg, var(--orange-light), var(--orange-mid));
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(232,146,42,0.3);
        }
        
        .fb-btn-download {
            background: linear-gradient(145deg, #4a90e2, #357abd);
            border: 1px solid #5fa3ef;
            color: #fff;
        }
        
        .fb-btn-download:hover:not(:disabled) {
            background: linear-gradient(145deg, #5fa3ef, #4a90e2);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74,144,226,0.3);
        }
        
        .fb-btn-upload {
            background: linear-gradient(145deg, #2d8a4e, #1a5c2a);
            border: 1px solid #28a745;
            color: #fff;
        }
        
        .fb-btn-upload:hover:not(:disabled) {
            background: linear-gradient(145deg, #34ce57, #2d8a4e);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(45,138,78,0.3);
        }
        
        .fb-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
    </style>
</head>
<body>
    <!-- SIDEBAR -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h1>TRAJANUS USA</h1>
            <div class="tagline">Engineered Intelligence™</div>
            <div class="ei-logo">
                <svg viewBox="0 0 120 80" xmlns="http://www.w3.org/2000/svg">
                    <!-- Orbit 1 (0 degrees) -->
                    <ellipse cx="60" cy="40" rx="28" ry="17.5" 
                        fill="none" stroke="#d4a574" stroke-width="1.5" opacity="0.8"/>
                    
                    <!-- Orbit 2 (120 degrees) -->
                    <ellipse cx="60" cy="40" rx="28" ry="17.5" 
                        fill="none" stroke="#d4a574" stroke-width="1.5" opacity="0.8"
                        transform="rotate(120 60 40)"/>
                    
                    <!-- EI Text -->
                    <text x="60" y="45" 
                        font-family="-apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"
                        font-size="19" 
                        font-weight="500"
                        fill="#e8922a" 
                        text-anchor="middle">EI</text>
                    
                    <!-- Small TM (tight against I) -->
                    <text x="70" y="38" 
                        font-family="-apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"
                        font-size="8" 
                        font-weight="400"
                        fill="#e8922a">™</text>
                </svg>
            </div>
            <div class="version">v3.0.0 © November 2025</div>
        </div>
        
        <div class="project-section">
            <h3>Projects in Development</h3>
            <button class="project-btn" data-project="enterprise-hub" id="enterpriseHubBtn">
                <span>Enterprise Hub</span>
                <span class="sidebar-badge dev">IN DEVELOPMENT</span>
            </button>
            <button class="project-btn active" data-project="website">
                <span>Website Builder</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="pm-toolkit">
                <span>PM Toolkit</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="qcm-toolkit">
                <span>QCM Toolkit</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="ssho-toolkit">
                <span>SSHO Toolkit</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="route-optimizer">
                <span>Route Optimizer</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="traffic-studies">
                <span>Traffic Studies</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="pe-services">
                <span>P.E. Services</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="memory">
                <span>Memory/Recall</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="developer-toolkit" id="devToolkitBtn">
                <span>Developer Toolkit</span>
                <span class="sidebar-badge dev">IN DEVELOPMENT</span>
            </button>
        </div>
        
        <div class="project-section">
            <h3>Deployed Projects</h3>
            <button class="project-btn" data-project="pm-working">
                <span>PM Toolkit</span>
                <span class="sidebar-badge deployed">v1 ACTIVE</span>
            </button>
            <button class="project-btn" data-project="qcm-working">
                <span>QCM Toolkit</span>
                <span class="sidebar-badge deployed">v1 ACTIVE</span>
            </button>
            <button class="project-btn" data-project="ssho-working">
                <span>SSHO Toolkit</span>
                <span class="sidebar-badge deployed">v1 ACTIVE</span>
            </button>
            <button class="project-btn" data-project="traffic-studies">
                <span>Traffic Studies</span>
                <span class="sidebar-badge deployed">v1 ACTIVE</span>
            </button>
            <button class="project-btn" data-project="pe-services">
                <span>P.E. Services</span>
                <span class="sidebar-badge deployed">v1 ACTIVE</span>
            </button>
        </div>
        
        <!-- Living Documents Quick Access -->
        <div class="quick-access-section">
            <h3>Living Documents</h3>
            <button class="quick-access-btn" onclick="toggleLivingDocsMenu()" id="livingDocsBtn">
                <span>Quick Access</span>
                <span style="float: right;">▼</span>
            </button>
            <div class="living-docs-menu" id="livingDocsMenu" style="display: none;">
                <button class="living-doc-item" onclick="openLivingDoc('diary')">
                    <div class="btn-label">Daily Diary</div>
                    <div class="btn-description">Personal daily journal</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('journal')">
                    <div class="btn-label">Project Journal</div>
                    <div class="btn-description">Technical project notes</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('protocols')">
                    <div class="btn-label">Core Protocols</div>
                    <div class="btn-description">Operational procedures</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('pov')">
                    <div class="btn-label">Bill's POV</div>
                    <div class="btn-description">Perspective and approach</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('sessions')">
                    <div class="btn-label">Session Summaries</div>
                    <div class="btn-description">Past session handoffs</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('all')">
                    <div class="btn-label">All Living Documents</div>
                    <div class="btn-description">Open main folder</div>
                </button>
            </div>
        </div>
        
        <div class="sidebar-footer">
            <button class="project-btn" onclick="openExternal('https://console.anthropic.com')">
                Anthropic Console
            </button>
            <button class="project-btn" onclick="openExternal('https://drive.google.com')">
                Google Drive
            </button>
        </div>
    </div>
    
    <!-- MAIN CONTENT -->
    <div class="main-content">
        <!-- Header with Clock -->
        <div class="header">
            <div class="header-title">
                <h2 id="projectTitle">Website Builder</h2>
                <div class="breadcrumb">Projects in Development > Website Builder</div>
            </div>
            <div class="clock">
                <div class="clock-left">
                    <div class="clock-date" id="clockDate">30 Nov 2025</div>
                    <div class="clock-time" id="clockTime">00:00:00</div>
                </div>
                <div class="clock-session">
                    <i class="fas fa-circle"></i>
                    <span id="sessionTimer">0h 0m</span>
                </div>
            </div>
        </div>
        
        <!-- Workspace -->
        <div class="workspace">
            <!-- App Launchers -->
            <div class="app-launcher-section">
                <div class="app-group">
                    <div class="app-group-header">MS Office</div>
                    <div class="app-group-buttons">
                        <button class="app-btn" onclick="launchApp('word')" title="Microsoft Word">
                            <i class="fas fa-file-word"></i>
                            <span>Word</span>
                        </button>
                        <button class="app-btn" onclick="launchApp('excel')" title="Microsoft Excel">
                            <i class="fas fa-file-excel"></i>
                            <span>Excel</span>
                        </button>
                        <button class="app-btn" onclick="launchApp('powerpoint')" title="Microsoft PowerPoint">
                            <i class="fas fa-file-powerpoint"></i>
                            <span>PPT</span>
                        </button>
                        <button class="app-btn" onclick="launchApp('outlook')" title="Microsoft Outlook">
                            <i class="fas fa-envelope"></i>
                            <span>Outlook</span>
                        </button>
                    </div>
                </div>
                
                <div class="app-group">
                    <div class="app-group-header">Dev Tools</div>
                    <div class="app-group-buttons">
                        <button class="app-btn" onclick="launchApp('vscode')" title="Visual Studio Code">
                            <i class="fas fa-code"></i>
                            <span>VS Code</span>
                        </button>
                        <button class="app-btn" onclick="launchApp('notepad')" title="Notepad">
                            <i class="fas fa-file-alt"></i>
                            <span>Notepad</span>
                        </button>
                        <button class="app-btn" onclick="launchApp('powershell')" title="PowerShell">
                            <i class="fas fa-terminal"></i>
                            <span>Shell</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- DEVELOPER TOOLKIT PROJECT -->
            <div class="project-tools" data-project="developer-toolkit" style="display: none;">
            
            <div class="section-intro">
                <strong>Developer Toolkit</strong> — Advanced tools for development, automation, and system management. All tools are organized by category for easy access.
            </div>
            
            <!-- SESSION MANAGEMENT -->
            <div class="tool-section">
                <div class="tool-section-header">Session Management</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Tools for managing AI sessions and handoffs between work periods.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => log('Opening handoff prompt generator...', 'info'))"
                            data-tooltip="Creates detailed context for next Claude session">
                        <div class="btn-label">Mission Brief</div>
                        <div class="btn-description">Generate handoff prompt for new session</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => log('Running memory refresh...', 'info'))"
                            data-tooltip="Loads key protocols into Claude's context">
                        <div class="btn-label">Sync Memory</div>
                        <div class="btn-description">Refresh Claude's memory with key protocols</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => log('Starting EOS routine...', 'warning'))"
                            data-tooltip="Runs full end-of-session protocol with documentation">
                        <div class="btn-label">Perform EOS Protocols</div>
                        <div class="btn-description">Run end-of-session routine and handoff</div>
                    </button>
                </div>
            </div>
            
            <!-- FILE OPERATIONS -->
            <div class="tool-section">
                <div class="tool-section-header">File Operations</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Convert between document formats for compatibility and storage.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => runConversion('md-to-docx'))"
                            data-tooltip="Convert Markdown → Word format">
                        <div class="btn-label">MD to DOCX</div>
                        <div class="btn-description">Convert Markdown files to Word documents</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => runConversion('docx-to-gdocs'))"
                            data-tooltip="Upload Word files to Google Drive">
                        <div class="btn-label">DOCX to Google Docs</div>
                        <div class="btn-description">Upload Word docs to Google Drive</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => runConversion('gdocs-to-docx'))"
                            data-tooltip="Download Google Docs as Word files">
                        <div class="btn-label">Google Docs to DOCX</div>
                        <div class="btn-description">Export Google Docs as Word files</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => runConversion('batch-convert'))"
                            data-tooltip="Process multiple Markdown files at once">
                        <div class="btn-label">Batch Convert MD</div>
                        <div class="btn-description">Convert multiple Markdown files at once</div>
                    </button>
                </div>
            </div>
            
            <!-- QUICK ACCESS -->
            <div class="tool-section">
                <div class="tool-section-header">Quick Access</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Fast navigation to frequently used folders and documents.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => showUserGuides())"
                            data-tooltip="Opens searchable protocol library">
                        <div class="btn-label">User Guides</div>
                        <div class="btn-description">Searchable protocol documents library</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('living-docs'))"
                            data-tooltip="Opens: 02-Living-Documents">
                        <div class="btn-label">Living Documents</div>
                        <div class="btn-description">Active project documentation</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('protocols'))"
                            data-tooltip="Opens: 01-Core-Protocols">
                        <div class="btn-label">Core Protocols</div>
                        <div class="btn-description">Standard operating procedures</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('documentation'))"
                            data-tooltip="Opens: 04-Documentation">
                        <div class="btn-label">Documentation</div>
                        <div class="btn-description">Development reference guides</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('scripts'))"
                            data-tooltip="Opens: 05-Scripts">
                        <div class="btn-label">Scripts</div>
                        <div class="btn-description">Automation and utility scripts</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('sessions'))"
                            data-tooltip="Opens: 03-Session-Files">
                        <div class="btn-label">Session Files</div>
                        <div class="btn-description">Session summaries and handoffs</div>
                    </button>
                </div>
            </div>
            
            <!-- REFERENCE RESOURCES -->
            <div class="tool-section">
                <div class="tool-section-header">Reference Resources</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Industry standards, building codes, and technical references.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://www.wbdg.org/ffc/dod/unified-facilities-guide-specifications-ufgs'))"
                            data-tooltip="DoD Unified Facilities Guide Specifications">
                        <div class="btn-label">UFGS</div>
                        <div class="btn-description">DoD construction specifications</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://up.codes/'))"
                            data-tooltip="Searchable database of all building codes">
                        <div class="btn-label">UpCodes</div>
                        <div class="btn-description">All codes in one searchable database</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://www.usgs.gov/'))"
                            data-tooltip="U.S. Geological Survey - seismic & soil data">
                        <div class="btn-label">USGS</div>
                        <div class="btn-description">Geological and seismic data</div>
                    </button>
                    <button class="session-btn" 
                            onclick="openExternal('https://www.thesaurus.com')"
                            data-tooltip="Word reference and synonyms">
                        <div class="btn-label">Thesaurus</div>
                        <div class="btn-description">Word reference and synonyms</div>
                    </button>
                </div>
            </div>
            
            <!-- LEARNING RESOURCES -->
            <div class="tool-section">
                <div class="tool-section-header">Learning Resources</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Coding tutorials and technical documentation for skill development.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => showCodingResources('html'))"
                            data-tooltip="HTML tutorials for beginners">
                        <div class="btn-label">HTML Basics</div>
                        <div class="btn-description">Learn HTML structure and markup</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => showCodingResources('css'))"
                            data-tooltip="CSS styling and layout tutorials">
                        <div class="btn-label">CSS Basics</div>
                        <div class="btn-description">Learn styling and layout</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => showCodingResources('python'))"
                            data-tooltip="Python automation and scripting">
                        <div class="btn-label">Python Basics</div>
                        <div class="btn-description">Learn automation and scripting</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => showCodingResources('javascript'))"
                            data-tooltip="JavaScript for interactivity">
                        <div class="btn-label">JavaScript Basics</div>
                        <div class="btn-description">Learn interactivity and logic</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://www.w3schools.com/'))"
                            data-tooltip="Interactive tutorials for all languages">
                        <div class="btn-label">W3Schools</div>
                        <div class="btn-description">Interactive tutorials for all languages</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://stackoverflow.com/'))"
                            data-tooltip="Q&A community for programming problems">
                        <div class="btn-label">Stack Overflow</div>
                        <div class="btn-description">Q&A for programming problems</div>
                    </button>
                </div>
            </div>
            
            </div>
            <!-- END DEVELOPER TOOLKIT PROJECT -->
            
            <!-- TRAFFIC STUDIES PROJECT -->
            <div class="project-tools" data-project="traffic-studies" style="display: none;">
                <div class="section-intro">
                    <strong>Traffic Studies v1</strong> — Tools and resources for traffic impact analysis and transportation planning.
                </div>
                
                <div class="tool-section">
                    <div class="tool-section-header">Traffic Analysis Tools</div>
                    <div class="button-grid">
                        <button class="session-btn" onclick="log('Traffic study tools coming soon...', 'info')">
                            <div class="btn-label">Traffic Impact Analysis</div>
                            <div class="btn-description">Analyze traffic patterns and impacts</div>
                        </button>
                        <button class="session-btn" onclick="log('Level of service tools coming soon...', 'info')">
                            <div class="btn-label">Level of Service</div>
                            <div class="btn-description">Calculate intersection LOS ratings</div>
                        </button>
                        <button class="session-btn" onclick="log('Report generator coming soon...', 'info')">
                            <div class="btn-label">Report Generator</div>
                            <div class="btn-description">Create traffic study reports</div>
                        </button>
                    </div>
                </div>
            </div>
            <!-- END TRAFFIC STUDIES PROJECT -->
            
            <!-- P.E. SERVICES PROJECT -->
            <div class="project-tools" data-project="pe-services" style="display: none;">
                <div class="section-intro">
                    <strong>P.E. Services v1</strong> — Professional engineering services and technical review tools.
                </div>
                
                <div class="tool-section">
                    <div class="tool-section-header">Engineering Review Tools</div>
                    <div class="button-grid">
                        <button class="session-btn" onclick="log('Plan review tools coming soon...', 'info')">
                            <div class="btn-label">Plan Review</div>
                            <div class="btn-description">Review and markup engineering plans</div>
                        </button>
                        <button class="session-btn" onclick="log('Calculation tools coming soon...', 'info')">
                            <div class="btn-label">Engineering Calculations</div>
                            <div class="btn-description">Perform structural and civil calculations</div>
                        </button>
                        <button class="session-btn" onclick="log('Stamp tools coming soon...', 'info')">
                            <div class="btn-label">PE Stamp Manager</div>
                            <div class="btn-description">Manage professional engineer stamps</div>
                        </button>
                    </div>
                </div>
            </div>
            <!-- END P.E. SERVICES PROJECT -->
            
            <!-- PROJECT-SPECIFIC TOOLS -->
            
            <!-- Enterprise Hub Tools -->
            <div class="tool-section project-tools" data-project="enterprise-hub" style="display: none;">
            
            <div class="section-intro">
                <strong>Enterprise Hub</strong> — Central command for file management, developer tools, and system operations. All tools accessible via terminal tabs below.
            </div>
            
            </div>
            
            <!-- PM Toolkit Tools -->
            <div class="tool-section project-tools" data-project="pm-toolkit">
                <div class="tool-section-header">PM Toolkit Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening schedule navigator...', 'info')">Schedule Navigator</button>
                    <button class="session-btn" onclick="log('Opening budget tracker...', 'info')">Budget Tracker</button>
                    <button class="session-btn" onclick="log('Opening RFI manager...', 'info')">RFI Manager</button>
                    <button class="session-btn" onclick="log('Opening change orders...', 'info')">Change Orders</button>
                    <button class="session-btn" onclick="log('Generating progress report...', 'info')">Progress Report</button>
                </div>
            </div>
            
            <!-- QCM Toolkit Tools -->
            <div class="tool-section project-tools" data-project="qcm-toolkit">
                <div class="tool-section-header">QCM Toolkit Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening submittal review...', 'info')">Submittal Review</button>
                    <button class="session-btn" onclick="log('Opening inspection reports...', 'info')">Inspection Reports</button>
                    <button class="session-btn" onclick="log('Opening NCR tracker...', 'info')">NCR Tracker</button>
                    <button class="session-btn" onclick="log('Opening material testing...', 'info')">Material Testing</button>
                    <button class="session-btn" onclick="log('Opening punch list...', 'info')">Punch List</button>
                </div>
            </div>
            
            <!-- SSHO Toolkit Tools -->
            <div class="tool-section project-tools" data-project="ssho-toolkit">
                <div class="tool-section-header">SSHO Toolkit Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening safety inspection...', 'info')">Safety Inspection</button>
                    <button class="session-btn" onclick="log('Opening incident reports...', 'info')">Incident Reports</button>
                    <button class="session-btn" onclick="log('Opening JHA tool...', 'info')">Job Hazard Analysis</button>
                    <button class="session-btn" onclick="log('Opening PPE tracker...', 'info')">PPE Tracker</button>
                    <button class="session-btn" onclick="log('Checking OSHA compliance...', 'info')">OSHA Compliance</button>
                </div>
            </div>
            
            <!-- Website Builder Tools -->
            <div class="tool-section project-tools active" data-project="website">
                <div class="tool-section-header">Website Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening content editor...', 'info')">Content Editor</button>
                    <button class="session-btn" onclick="log('Opening SEO tools...', 'info')">SEO Tools</button>
                    <button class="session-btn" onclick="log('Opening media library...', 'info')">Media Library</button>
                    <button class="session-btn" onclick="openExternal('https://trajanus-usa.com')">View Live Site</button>
                </div>
            </div>
            
            <!-- PM/QCM Working (Deployed) - Minimal tools -->
            <div class="tool-section project-tools" data-project="pm-working">
                <div class="tool-section-header">PM Working - Active Contract</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening daily reports...', 'info')">Daily Reports</button>
                    <button class="session-btn" onclick="log('Opening invoices...', 'info')">Invoices</button>
                    <button class="session-btn" onclick="log('Opening client files...', 'info')">Client Files</button>
                </div>
            </div>
            
            <div class="tool-section project-tools" data-project="qcm-working">
                <div class="tool-section-header">QCM Working - Active Contract</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening inspection logs...', 'info')">Inspection Logs</button>
                    <button class="session-btn" onclick="log('Opening test results...', 'info')">Test Results</button>
                    <button class="session-btn" onclick="log('Opening client specs...', 'info')">Client Specs</button>
                </div>
            </div>
            
            <div class="tool-section project-tools" data-project="ssho-working">
                <div class="tool-section-header">SSHO Working - Active Contract</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening safety logs...', 'info')">Safety Logs</button>
                    <button class="session-btn" onclick="log('Opening incident tracking...', 'info')">Incident Tracking</button>
                    <button class="session-btn" onclick="log('Opening compliance reports...', 'info')">Compliance Reports</button>
                </div>
            </div>
            
            <!-- Route Optimizer Tools -->
            <div class="tool-section project-tools" data-project="route-optimizer">
                <div class="tool-section-header">Route Optimizer Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening route planner...', 'info')">Route Planner</button>
                    <button class="session-btn" onclick="log('Opening TSP solver...', 'info')">TSP Solver</button>
                    <button class="session-btn" onclick="log('Importing delivery points...', 'info')">Import Points</button>
                    <button class="session-btn" onclick="log('Generating optimal route...', 'info')">Generate Route</button>
                    <button class="session-btn" onclick="log('Exporting to Google Maps...', 'info')">Export to Maps</button>
                </div>
            </div>
            
            <!-- Traffic Studies Tools -->
            <div class="tool-section project-tools" data-project="traffic-studies">
                <div class="tool-section-header">Traffic Studies Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening traffic count analyzer...', 'info')">Traffic Counts</button>
                    <button class="session-btn" onclick="log('Opening ITE trip generator...', 'info')">ITE Trip Gen</button>
                    <button class="session-btn" onclick="log('Opening level of service calculator...', 'info')">LOS Calculator</button>
                    <button class="session-btn" onclick="log('Opening capacity analysis...', 'info')">Capacity Analysis</button>
                    <button class="session-btn" onclick="log('Generating TIA report...', 'info')">TIA Report</button>
                </div>
            </div>
            
            <!-- P.E. Services Tools -->
            <div class="tool-section project-tools" data-project="pe-services">
                <div class="tool-section-header">P.E. Services Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening engineering calculations...', 'info')">Calculations</button>
                    <button class="session-btn" onclick="log('Opening seal & signature manager...', 'info')">Seal & Signature</button>
                    <button class="session-btn" onclick="log('Opening certification templates...', 'info')">Certifications</button>
                    <button class="session-btn" onclick="log('Opening plan review checklist...', 'info')">Plan Review</button>
                    <button class="session-btn" onclick="log('Generating professional opinion letter...', 'info')">Opinion Letter</button>
                </div>
            </div>
            
            <!-- Memory/Recall Tools -->
            <div class="tool-section project-tools" data-project="memory">
                <div class="tool-section-header">Memory/Recall Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="log('Opening living documents...', 'info')">Living Documents</button>
                    <button class="session-btn" onclick="log('Opening operational protocols...', 'info')">Protocols</button>
                    <button class="session-btn" onclick="log('Opening partnership framework...', 'info')">Partnership Framework</button>
                    <button class="session-btn" onclick="log('Syncing MASTER files...', 'info')">Sync MASTERs</button>
                    <button class="session-btn" onclick="log('Opening memory automation...', 'info')">Memory Automation</button>
                </div>
            </div>
            
            <!-- Terminal -->
            <div class="terminal">
                <div class="terminal-header">
                    <!-- PERMANENT TABS (LEFT SIDE) -->
                    <button class="terminal-tab permanent-tab" data-tab="devtools" onclick="switchTab('devtools')" title="Session management, file operations, and dev utilities">
                        Developer Tools
                    </button>
                    <button class="terminal-tab permanent-tab" data-tab="msoffice" onclick="switchTab('msoffice')" title="Microsoft Office applications and document templates">
                        MS Office Tools
                    </button>
                    <button class="terminal-tab permanent-tab" data-tab="codes" onclick="switchTab('codes')" title="Project management and quality control tools">
                        Codes and Standards
                    </button>
                    <button class="terminal-tab permanent-tab" data-tab="reference" onclick="switchTab('reference')" title="Protocols, documentation, and learning resources">
                        Reference Documents
                    </button>
                    <button class="terminal-tab permanent-tab" data-tab="external" onclick="switchTab('external')" title="Third-party platforms and web resources">
                        External Programs
                    </button>
                    <!-- DYNAMIC TERMINAL TABS (RIGHT SIDE) -->
                    <div class="terminal-tabs" id="terminalTabs">
                        <button class="terminal-tab active" data-tab="main" onclick="switchTab('main')">
                            Terminal <span class="close-tab" onclick="closeTab(event, 'main')">×</span>
                        </button>
                    </div>
                    <button class="terminal-tab-add" onclick="addTab()" title="New Terminal">+</button>
                    <div class="terminal-actions">
                        <button class="terminal-clear" onclick="clearTerminal()">Clear</button>
                    </div>
                </div>
                <div class="terminal-bodies" id="terminalBodies">
                    <div class="terminal-body active" id="terminal-main" data-tab="main">
                        <div class="success">[Ready] Trajanus Enterprise Hub v2.0.0 initialized</div>
                        <div class="info">[Ready] All systems online</div>
                    </div>
                    <!-- PERMANENT DEVELOPER TERMINAL -->
                    <div class="terminal-body" id="terminal-devtools" data-tab="devtools">
                        <div class="success">[Ready] Developer Tools Terminal</div>
                        <div class="info">[Info] File management, session tools, and operations</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">FILE MANAGEMENT</div>
                            <button class="session-btn" onclick="openFileBrowser('living-docs')" style="margin: 4px;">Living Documents</button>
                            <button class="session-btn" onclick="openFileBrowser('sessions')" style="margin: 4px;">Session Library</button>
                            <button class="session-btn" onclick="openFileBrowser('templates')" style="margin: 4px;">Templates</button>
                            <button class="session-btn" onclick="openFileBrowser('command-center')" style="margin: 4px;">Command Center</button>
                            <button class="session-btn" onclick="openFileBrowser('protocols')" style="margin: 4px;">Core Protocols</button>
                            <button class="session-btn" onclick="openFileBrowser('learning')" style="margin: 4px;">Learning Folder</button>
                            <button class="session-btn" onclick="openFileBrowser('scripts')" style="margin: 4px;">Scripts</button>
                            <button class="session-btn" onclick="openFileBrowser('documentation')" style="margin: 4px;">Documentation</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">SESSION MANAGEMENT</div>
                            <button class="session-btn" onclick="log('Opening handoff prompt generator...', 'info', 'devtools')" style="margin: 4px;">Mission Brief</button>
                            <button class="session-btn" onclick="log('Running memory refresh...', 'info', 'devtools')" style="margin: 4px;">Sync Memory</button>
                            <button class="session-btn" onclick="log('Starting EOS routine...', 'warning', 'devtools')" style="margin: 4px;">Perform EOS Protocols</button>
                            <button class="session-btn" onclick="log('Update living docs - Coming soon', 'info', 'devtools')" style="margin: 4px;">Update Living Docs</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">FILE OPERATIONS</div>
                            <button class="session-btn" onclick="runConversion('md-to-docx')" style="margin: 4px;">MD to DOCX</button>
                            <button class="session-btn" onclick="runConversion('docx-to-gdocs')" style="margin: 4px;">DOCX to Google Docs</button>
                            <button class="session-btn" onclick="runConversion('gdocs-to-docx')" style="margin: 4px;">Google Docs to DOCX</button>
                            <button class="session-btn" onclick="runConversion('batch-convert')" style="margin: 4px;">Batch Convert MD</button>
                        </div>
                    </div>
                    <!-- MS OFFICE TOOLS TERMINAL -->
                    <div class="terminal-body" id="terminal-msoffice" data-tab="msoffice">
                        <div class="success">[Ready] MS Office Tools & Templates</div>
                        <div class="info">[Info] Microsoft Office, templates, and document generation</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">MS OFFICE</div>
                            <button class="session-btn" onclick="log('Opening Word...', 'info', 'msoffice')" style="margin: 4px;">Word</button>
                            <button class="session-btn" onclick="log('Opening Excel...', 'info', 'msoffice')" style="margin: 4px;">Excel</button>
                            <button class="session-btn" onclick="log('Opening PowerPoint...', 'info', 'msoffice')" style="margin: 4px;">PowerPoint</button>
                            <button class="session-btn" onclick="log('Opening Outlook...', 'info', 'msoffice')" style="margin: 4px;">Outlook</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">TEMPLATES</div>
                            <button class="session-btn" onclick="log('Opening QCM template...', 'info', 'msoffice')" style="margin: 4px;">QCM Submittal Review</button>
                            <button class="session-btn" onclick="log('Opening daily journal...', 'info', 'msoffice')" style="margin: 4px;">Daily Journal</button>
                            <button class="session-btn" onclick="log('Opening schedule narrative...', 'info', 'msoffice')" style="margin: 4px;">Schedule Narrative</button>
                            <button class="session-btn" onclick="log('Opening meeting minutes...', 'info', 'msoffice')" style="margin: 4px;">Meeting Minutes</button>
                        </div>
                    </div>
                    <!-- CODES AND STANDARDS TERMINAL -->
                    <div class="terminal-body" id="terminal-codes" data-tab="codes">
                        <div class="success">[Ready] Codes and Standards Tools</div>
                        <div class="info">[Info] Project-specific tools and utilities</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">PM TOOLS</div>
                            <button class="session-btn" onclick="log('Opening schedule navigator...', 'info', 'codes')" style="margin: 4px;">Schedule Navigator</button>
                            <button class="session-btn" onclick="log('Opening budget tracker...', 'info', 'codes')" style="margin: 4px;">Budget Tracker</button>
                            <button class="session-btn" onclick="log('Opening RFI manager...', 'info', 'codes')" style="margin: 4px;">RFI Manager</button>
                            <button class="session-btn" onclick="log('Opening change orders...', 'info', 'codes')" style="margin: 4px;">Change Orders</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">QCM TOOLS</div>
                            <button class="session-btn" onclick="log('Opening submittal review...', 'info', 'codes')" style="margin: 4px;">Submittal Review</button>
                            <button class="session-btn" onclick="log('Opening inspection reports...', 'info', 'codes')" style="margin: 4px;">Inspection Reports</button>
                            <button class="session-btn" onclick="log('Opening deficiency tracker...', 'info', 'codes')" style="margin: 4px;">Deficiency Tracker</button>
                            <button class="session-btn" onclick="log('Opening closeout checklist...', 'info', 'codes')" style="margin: 4px;">Closeout Checklist</button>
                        </div>
                    </div>
                    <!-- PERMANENT EXTERNAL TERMINAL -->
                    <div class="terminal-body" id="terminal-external" data-tab="external">
                        <div class="success">[Ready] External Resources</div>
                        <div class="info">[Info] Third-party platforms and web resources</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">PLATFORMS</div>
                            <button class="session-btn" onclick="log('Opening Procore...', 'info', 'external')" style="margin: 4px;">Procore</button>
                            <button class="session-btn" onclick="log('Opening Primavera P6...', 'info', 'external')" style="margin: 4px;">Primavera P6</button>
                            <button class="session-btn" onclick="log('Opening RMS 3.0...', 'info', 'external')" style="margin: 4px;">RMS 3.0</button>
                            <button class="session-btn" onclick="log('Opening USACE site...', 'info', 'external')" style="margin: 4px;">USACE Portal</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">WEB RESOURCES</div>
                            <button class="session-btn" onclick="openExternal('https://drive.google.com/drive/folders/FOLDER_ID')" style="margin: 4px;">Google Drive Root</button>
                            <button class="session-btn" onclick="openExternal('https://console.anthropic.com')" style="margin: 4px;">Anthropic Console</button>
                            <button class="session-btn" onclick="log('Opening Claude AI...', 'info', 'external')" style="margin: 4px;">Claude AI</button>
                            <button class="session-btn" onclick="log('Opening VS Code...', 'info', 'external')" style="margin: 4px;">VS Code</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">UTILITIES</div>
                            <button class="session-btn" onclick="showUserGuides()" style="margin: 4px;">User Guides</button>
                            <button class="session-btn" onclick="openExternal('https://www.thesaurus.com')" style="margin: 4px;">Thesaurus</button>
                        </div>
                    </div>
                    <!-- PERMANENT REFERENCE TERMINAL -->
                    <div class="terminal-body" id="terminal-reference" data-tab="reference">
                        <div class="success">[Ready] Reference Library</div>
                        <div class="info">[Info] Protocols, documentation, and learning resources</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">PROTOCOLS</div>
                            <button class="session-btn" onclick="log('Opening operational protocols...', 'info', 'reference')" style="margin: 4px;">Operational Protocols</button>
                            <button class="session-btn" onclick="log('Opening Bill POV...', 'info', 'reference')" style="margin: 4px;">Bill POV</button>
                            <button class="session-btn" onclick="log('Opening commandments...', 'info', 'reference')" style="margin: 4px;">AI Commandments</button>
                            <button class="session-btn" onclick="log('Opening file structure...', 'info', 'reference')" style="margin: 4px;">File Structure Map</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">LEARNING</div>
                            <button class="session-btn" onclick="log('Opening Python guide...', 'info', 'reference')" style="margin: 4px;">Python Resources</button>
                            <button class="session-btn" onclick="log('Opening JavaScript guide...', 'info', 'reference')" style="margin: 4px;">JavaScript Resources</button>
                            <button class="session-btn" onclick="log('Opening Electron docs...', 'info', 'reference')" style="margin: 4px;">Electron Docs</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <span class="status-dot"></span>
                <span>System Ready</span>
            </div>
            <div class="status-item">
                <span id="platform">Platform: Loading...</span>
            </div>
            <div class="status-item">
                <span>v2.0.0</span>
            </div>
        </div>
    </div>
    
    <!-- RIGHT PANEL - PROJECT FILES -->
    <div class="right-panel">
        <div class="right-panel-header">
            <h3>Project Files</h3>
        </div>
        
        <div class="panel-section">
            <h4>Working Files</h4>
            <div class="file-list" id="workingFilesList">
                <div class="empty-state">No files yet</div>
            </div>
            <button class="add-files-btn" onclick="addFiles()">+ Add Files</button>
        </div>
        
        <div class="panel-section">
            <h4>Completed</h4>
            <div class="file-list" id="completedFilesList">
                <div class="empty-state">No completed files</div>
            </div>
        </div>
        
        <div class="preview-pane">
            <h4>Preview</h4>
            <div class="preview-content" id="previewContent">
                <div class="preview-file-icon"><i class="fas fa-file"></i></div>
                <div>Select a file to preview</div>
            </div>
            <div class="preview-actions" id="previewActions" style="display: none;">
                <button class="preview-btn" onclick="viewSelectedFile()" title="Open file in default application">
                    <i class="fas fa-eye"></i> View
                </button>
                <button class="preview-btn" onclick="openFileLocation()" title="Open file location in Explorer">
                    <i class="fas fa-folder-open"></i> Open Folder
                </button>
                <button class="preview-btn primary" onclick="moveToCompleted(selectedFile.index)" title="Mark as complete">
                    <i class="fas fa-check"></i> Complete
                </button>
            </div>
        </div>
    </div>
    
    <!-- USER GUIDES MODAL -->
    <div class="modal-overlay" id="userGuidesModal" onclick="closeUserGuides(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2>📚 User Guides & Documentation</h2>
                <button class="modal-close" onclick="hideUserGuides()">×</button>
            </div>
            <div class="modal-body">
                <input type="text" class="search-box" id="guideSearch" placeholder="Search guides..." onkeyup="filterGuides()">
                <div class="guide-list" id="guideList"></div>
            </div>
        </div>
    </div>
    
    <!-- CODING RESOURCES MODAL -->
    <div class="modal-overlay" id="codingResourcesModal" onclick="closeCodingResources(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 id="codingModalTitle">📘 Coding Resources</h2>
                <button class="modal-close" onclick="hideCodingResources()">×</button>
            </div>
            <div class="modal-body">
                <div id="codingResourcesList"></div>
            </div>
        </div>
    </div>
    
    <!-- Enhanced File Picker Modal -->
    <div class="file-picker-modal" id="filePickerModal" style="display: none;">
        <div class="file-picker-container">
            <div class="file-picker-header">
                <h3>Add Files to Project</h3>
                <button class="close-btn" onclick="closeFilePicker()">×</button>
            </div>
            <div class="file-picker-body">
                <div class="file-picker-left">
                    <div class="file-picker-actions">
                        <button class="picker-btn" onclick="triggerNativeFilePicker()">
                            📁 Browse Files
                        </button>
                        <input type="file" id="nativeFilePicker" multiple style="display: none;" onchange="handleFileSelection(event)">
                    </div>
                    <div class="selected-files-list" id="selectedFilesList">
                        <div class="no-files-msg">No files selected</div>
                    </div>
                </div>
                <div class="file-picker-right">
                    <div class="file-preview-header">Preview</div>
                    <div class="file-preview-area" id="filePreviewArea">
                        <div class="no-preview-msg">Select a file to preview</div>
                    </div>
                </div>
            </div>
            <div class="file-picker-footer">
                <button class="picker-btn-secondary" onclick="closeFilePicker()">Cancel</button>
                <button class="picker-btn-primary" onclick="addSelectedFiles()" id="addFilesBtn" disabled>
                    Add <span id="fileCount">0</span> File(s)
                </button>
            </div>
        </div>
    </div>
    
    <!-- File Browser Modal -->
    <div class="file-browser-modal" id="fileBrowserModal">
        <div class="file-browser-container">
            <div class="file-browser-header">
                <div class="file-browser-title">
                    <span style="font-size: 1.8rem;">📁</span>
                    <div>
                        <h3 id="fileBrowserTitle">Files</h3>
                        <div class="file-browser-path" id="fileBrowserPath">/path/to/folder</div>
                    </div>
                </div>
                <button class="file-browser-close" onclick="closeFileBrowser()">×</button>
            </div>
            <div class="file-browser-body">
                <div class="file-list-panel">
                    <input type="text" class="file-search" id="fileSearchInput" placeholder="🔍 Search files...">
                    <div class="file-list" id="fileList">
                        <div class="preview-placeholder">Loading files...</div>
                    </div>
                </div>
                <div class="file-preview-panel">
                    <div class="preview-header">Preview</div>
                    <div class="preview-content" id="previewContent">
                        <div class="preview-placeholder">Select a file to preview</div>
                    </div>
                </div>
            </div>
            <div class="file-browser-footer">
                <div class="file-browser-info" id="fileBrowserInfo">
                    No file selected
                </div>
                <div class="file-browser-actions">
                    <button class="fb-btn fb-btn-upload" onclick="uploadToFolder()" id="uploadBtn">
                        📤 Upload
                    </button>
                    <button class="fb-btn fb-btn-view" onclick="viewSelectedFile()" id="viewBtn" disabled>
                        👁️ View
                    </button>
                    <button class="fb-btn fb-btn-download" onclick="downloadSelectedFile()" id="downloadBtn" disabled>
                        ⬇️ Download
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ============================================
        // GLOBAL UTILITY FUNCTIONS (MUST BE FIRST!)
        // ============================================
        
        // Log function - needs to be global for onclick handlers
        window.log = function(message, type = 'info', tabId = null) {
            const terminal = tabId ? document.getElementById(`terminal-${tabId}`) : 
                             document.querySelector('.terminal-content[style*="display: block"]') ||
                             document.querySelector('.terminal-content');
            if (!terminal) {
                console.log(`[${type}] ${message}`);
                return;
            }
            const line = document.createElement('div');
            line.className = type;
            const timestamp = new Date().toLocaleTimeString('en-US', { hour12: false });
            line.textContent = `[${timestamp}] ${message}`;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        };
        
        // Clear terminal - needs to be global for onclick handlers
        window.clearTerminal = function() {
            const terminal = document.querySelector('.terminal-content[style*="display: block"]') ||
                           document.querySelector('.terminal-content');
            if (terminal) {
                terminal.innerHTML = '<div class="info">[Cleared] Terminal cleared</div>';
            }
        };
        
        // ============================================
        // CLOCK & SESSION TIMER
        // ============================================
        const sessionStart = new Date();
        
        function updateClock() {
            const now = new Date();
            
            // Format date
            const day = now.getDate();
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const month = months[now.getMonth()];
            const year = now.getFullYear();
            document.getElementById('clockDate').textContent = `${day} ${month} ${year}`;
            
            // Format time
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            document.getElementById('clockTime').textContent = `${hours}:${minutes}:${seconds}`;
            
            // Session duration
            const elapsed = Math.floor((now - sessionStart) / 1000);
            const sessionHours = Math.floor(elapsed / 3600);
            const sessionMinutes = Math.floor((elapsed % 3600) / 60);
            document.getElementById('sessionTimer').textContent = `${sessionHours}h ${sessionMinutes}m`;
        }
        
        setInterval(updateClock, 1000);
        updateClock();
        
        // ============================================
        // APP LAUNCHERS (PROVEN TO WORK)
        // ============================================
        const appPaths = {
            word: 'start winword',
            excel: 'start excel',
            powerpoint: 'start powerpnt',
            outlook: 'start outlook',
            vscode: 'code',
            notepad: 'notepad',
            powershell: 'start powershell'
        };
        
        async function launchApp(appName) {
            const appPath = appPaths[appName];
            if (!appPath) {
                log(`App not found: ${appName}`, 'error');
                return;
            }
            
            log(`Launching ${appName}...`, 'info');
            
            if (window.electronAPI) {
                try {
                    await window.electronAPI.runCommand(appPath);
                    log(`✓ Launched: ${appName}`, 'success');
                } catch (err) {
                    log(`✗ Error launching ${appName}: ${err.message}`, 'error');
                }
            } else {
                log('✗ Must run in Electron app', 'error');
            }
        }
        
        // ============================================
        // TERMINAL TABS
        // ============================================
        let activeTab = 'main';
        let tabCounter = 1;
        
        function getActiveTerminal() {
            return document.getElementById(`terminal-${activeTab}`);
        }
        
        function switchTab(tabId) {
            // Update tab buttons
            document.querySelectorAll('.terminal-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.tab === tabId) tab.classList.add('active');
            });
            
            // Update terminal bodies
            document.querySelectorAll('.terminal-body').forEach(body => {
                body.classList.remove('active');
            });
            document.getElementById(`terminal-${tabId}`).classList.add('active');
            
            activeTab = tabId;
        }
        
        function addTab(name = null) {
            tabCounter++;
            const tabId = `tab-${tabCounter}`;
            const tabName = name || `Terminal ${tabCounter}`;
            
            // Create tab button
            const tabBtn = document.createElement('button');
            tabBtn.className = 'terminal-tab';
            tabBtn.dataset.tab = tabId;
            tabBtn.onclick = () => switchTab(tabId);
            tabBtn.innerHTML = `${tabName} <span class="close-tab" onclick="closeTab(event, '${tabId}')">×</span>`;
            document.getElementById('terminalTabs').appendChild(tabBtn);
            
            // Create terminal body
            const termBody = document.createElement('div');
            termBody.className = 'terminal-body';
            termBody.id = `terminal-${tabId}`;
            termBody.dataset.tab = tabId;
            termBody.innerHTML = `<div class="info">[Ready] New terminal opened</div>`;
            document.getElementById('terminalBodies').appendChild(termBody);
            
            // Switch to new tab
            switchTab(tabId);
            
            return tabId;
        }
        
        function closeTab(event, tabId) {
            event.stopPropagation();
            
            // Never allow closing permanent tabs
            const permanentTabs = ['devtools', 'msoffice', 'codes', 'external', 'reference'];
            if (permanentTabs.includes(tabId)) {
                log('Permanent tabs cannot be closed', 'warning', tabId);
                return;
            }
            
            const tabs = document.querySelectorAll('.terminal-tab');
            if (tabs.length <= 6) return; // Don't close if only main + 5 permanent tabs remain
            
            // Remove tab button and body
            document.querySelector(`.terminal-tab[data-tab="${tabId}"]`).remove();
            document.getElementById(`terminal-${tabId}`).remove();
            
            // If closing active tab, switch to first remaining tab
            if (activeTab === tabId) {
                const firstTab = document.querySelector('.terminal-tab');
                if (firstTab) switchTab(firstTab.dataset.tab);
            }
        }
        
        /* LOG FUNCTION MOVED TO TOP OF SCRIPT (line ~2530)
        function log(message, type = 'info', tabId = null) {
            const terminal = tabId ? document.getElementById(`terminal-${tabId}`) : getActiveTerminal();
            const line = document.createElement('div');
            line.className = type;
            const timestamp = new Date().toLocaleTimeString('en-US', { hour12: false });
            line.textContent = `[${timestamp}] ${message}`;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }
        */
        
        /* CLEARTERMINAL FUNCTION MOVED TO TOP OF SCRIPT (line ~2530)
        function clearTerminal() {
            const terminal = getActiveTerminal();
            terminal.innerHTML = '<div class="info">[Cleared] Terminal cleared</div>';
        }
        */
        
        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function openExternal(url) {
            if (window.electronAPI) {
                window.electronAPI.openExternal(url);
            } else {
                window.open(url, '_blank');
            }
        }
        
        // ============================================
        // PROJECT NAVIGATION
        // ============================================
        let currentProject = 'website';
        
        /* PASSWORD PROTECTION VARIABLES - COMMENTED OUT (NOT WORKING)
        // Clear unlock states for fresh testing
        sessionStorage.removeItem('devToolkitUnlocked');
        sessionStorage.removeItem('enterpriseHubUnlocked');
        let devToolkitUnlocked = false;
        let enterpriseHubUnlocked = false;
        END PASSWORD PROTECTION */
        
        // Wait for DOM to be ready
        window.addEventListener('DOMContentLoaded', () => {
            log(`Protected projects initial state: LOCKED`, 'info');
            
            document.querySelectorAll('.project-btn[data-project]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const project = btn.dataset.project;
                    
                    log(`━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━`, 'info');
                    log(`CLICKED PROJECT: ${project}`, 'info');
                    
                    /* PASSWORD PROTECTION - COMMENTED OUT (NOT WORKING)
                    // Check if clicking protected project (Developer Toolkit OR Enterprise Hub)
                    if (project === 'developer-toolkit' || project === 'enterprise-hub') {
                        const isDevToolkit = project === 'developer-toolkit';
                        const isUnlocked = isDevToolkit ? devToolkitUnlocked : enterpriseHubUnlocked;
                        const projectName = isDevToolkit ? 'Developer Toolkit' : 'Enterprise Hub';
                        
                        log(`Protected project: ${projectName}`, 'warning');
                        log(`Currently unlocked: ${isUnlocked}`, 'info');
                        
                        if (!isUnlocked) {
                            log('🔒 LOCKED - Showing password prompt...', 'warning');
                            
                            try {
                                const pwd = window.prompt(`🔒 ${projectName} Access\n\nEnter password:`);
                                log(`Prompt shown. User ${pwd !== null ? 'entered something' : 'cancelled'}`, 'info');
                                
                                if (pwd === null) {
                                    log('❌ User cancelled password prompt', 'info');
                                    return;
                                }
                                
                                log(`Checking password... (${pwd.length} chars)`, 'info');
                                
                                if (pwd === "EmmaRose") {
                                    log(`✓ PASSWORD CORRECT!`, 'success');
                                    
                                    if (isDevToolkit) {
                                        devToolkitUnlocked = true;
                                        sessionStorage.setItem('devToolkitUnlocked', 'true');
                                    } else {
                                        enterpriseHubUnlocked = true;
                                        sessionStorage.setItem('enterpriseHubUnlocked', 'true');
                                    }
                                    
                                    const badge = btn.querySelector('.sidebar-badge');
                                    if (badge) {
                                        badge.textContent = '🔓 UNLOCKED';
                                        badge.style.background = '#28a745';
                                    }
                                    log(`✓ ${projectName} UNLOCKED for this session`, 'success');
                                } else {
                                    log(`❌ WRONG PASSWORD: "${pwd}"`, 'error');
                                    window.alert("❌ Incorrect password");
                                    log(`Password should be: EmmaRose`, 'error');
                                    return;
                                }
                            } catch (err) {
                                log(`ERROR showing prompt: ${err.message}`, 'error');
                                return;
                            }
                        } else {
                            log('Already unlocked, proceeding...', 'success');
                        }
                    }
                    END PASSWORD PROTECTION */
                    
                    // Remove active from all
                    document.querySelectorAll('.project-btn[data-project]').forEach(b => b.classList.remove('active'));
                    // Add to clicked
                    btn.classList.add('active');
                    
                    const projectName = btn.querySelector('span').textContent;
                    currentProject = project;
                    
                    // Update header
                    document.getElementById('projectTitle').textContent = projectName;
                    
                    // Show/hide project-specific tools
                    document.querySelectorAll('.project-tools').forEach(section => {
                        section.style.display = 'none';
                    });
                    const activeTools = document.querySelector(`.project-tools[data-project="${project}"]`);
                    if (activeTools) {
                        activeTools.style.display = 'block';
                    }
                    
                    log(`Switched to: ${projectName}`, 'info');
                    loadProjectFiles(project);
                });
            });
        });
        
        // ============================================
        // FILE MANAGEMENT
        // ============================================
        let projectFiles = {};
        let selectedFile = null;
        
        // Load files for current project from localStorage
        function loadProjectFiles(project) {
            const saved = localStorage.getItem(`projectFiles_${project}`);
            const files = saved ? JSON.parse(saved) : { working: [], completed: [] };
            projectFiles = files;
            renderFileLists();
            clearPreview();
        }
        
        // Save files to localStorage
        function saveProjectFiles() {
            localStorage.setItem(`projectFiles_${currentProject}`, JSON.stringify(projectFiles));
        }
        
        // Add files via file picker
        async function addFiles() {
            // Open enhanced file picker modal
            document.getElementById('filePickerModal').style.display = 'flex';
            selectedFilesForUpload = [];
            renderSelectedFiles();
        }
        
        let selectedFilesForUpload = [];
        let previewingFile = null;
        
        function triggerNativeFilePicker() {
            document.getElementById('nativeFilePicker').click();
        }
        
        function handleFileSelection(event) {
            const files = Array.from(event.target.files);
            files.forEach(file => {
                // Check if file already selected
                if (!selectedFilesForUpload.find(f => f.name === file.name && f.size === file.size)) {
                    selectedFilesForUpload.push(file);
                }
            });
            renderSelectedFiles();
            // Reset input so same file can be selected again
            event.target.value = '';
        }
        
        function renderSelectedFiles() {
            const container = document.getElementById('selectedFilesList');
            const fileCount = document.getElementById('fileCount');
            const addBtn = document.getElementById('addFilesBtn');
            
            if (selectedFilesForUpload.length === 0) {
                container.innerHTML = '<div class="no-files-msg">No files selected</div>';
                fileCount.textContent = '0';
                addBtn.disabled = true;
            } else {
                container.innerHTML = selectedFilesForUpload.map((file, index) => `
                    <div class="selected-file-item ${previewingFile === index ? 'active' : ''}" 
                         onclick="previewFile(${index})">
                        <div class="file-item-info">
                            <div class="file-item-name">${file.name}</div>
                            <div class="file-item-details">${formatFileSize(file.size)}</div>
                        </div>
                        <button class="file-item-remove" onclick="event.stopPropagation(); removeSelectedFile(${index})">
                            Remove
                        </button>
                    </div>
                `).join('');
                fileCount.textContent = selectedFilesForUpload.length;
                addBtn.disabled = false;
            }
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        function removeSelectedFile(index) {
            selectedFilesForUpload.splice(index, 1);
            if (previewingFile === index) {
                previewingFile = null;
                clearPreviewArea();
            }
            renderSelectedFiles();
        }
        
        function previewFile(index) {
            previewingFile = index;
            const file = selectedFilesForUpload[index];
            const previewArea = document.getElementById('filePreviewArea');
            
            renderSelectedFiles(); // Update active state
            
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewArea.innerHTML = `
                        <div class="file-preview-content">
                            <img src="${e.target.result}" class="preview-image" alt="${file.name}">
                            <div style="margin-top: 15px; color: var(--gray-light); font-size: 0.9rem;">
                                <div><strong>Name:</strong> ${file.name}</div>
                                <div><strong>Size:</strong> ${formatFileSize(file.size)}</div>
                                <div><strong>Type:</strong> ${file.type}</div>
                            </div>
                        </div>
                    `;
                };
                reader.readAsDataURL(file);
            } else if (file.type.startsWith('text/') || file.name.endsWith('.md') || file.name.endsWith('.json')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewArea.innerHTML = `
                        <div class="file-preview-content">
                            <div style="margin-bottom: 15px; color: var(--gray-light); font-size: 0.9rem;">
                                <div><strong>Name:</strong> ${file.name}</div>
                                <div><strong>Size:</strong> ${formatFileSize(file.size)}</div>
                                <div><strong>Type:</strong> ${file.type || 'text/plain'}</div>
                            </div>
                            <div class="preview-text">${e.target.result.substring(0, 5000)}${e.target.result.length > 5000 ? '\n\n... (truncated)' : ''}</div>
                        </div>
                    `;
                };
                reader.readAsText(file);
            } else {
                previewArea.innerHTML = `
                    <div class="file-preview-content">
                        <div style="color: var(--gray-light); font-size: 0.9rem;">
                            <div><strong>Name:</strong> ${file.name}</div>
                            <div><strong>Size:</strong> ${formatFileSize(file.size)}</div>
                            <div><strong>Type:</strong> ${file.type || 'unknown'}</div>
                            <div style="margin-top: 30px; text-align: center; font-style: italic;">
                                Preview not available for this file type
                            </div>
                        </div>
                    </div>
                `;
            }
        }
        
        function clearPreviewArea() {
            document.getElementById('filePreviewArea').innerHTML = '<div class="no-preview-msg">Select a file to preview</div>';
        }
        
        function closeFilePicker() {
            document.getElementById('filePickerModal').style.display = 'none';
            selectedFilesForUpload = [];
            previewingFile = null;
            clearPreviewArea();
        }
        
        function addSelectedFiles() {
            if (selectedFilesForUpload.length === 0) return;
            
            selectedFilesForUpload.forEach(file => {
                projectFiles.working = projectFiles.working || [];
                projectFiles.working.push({
                    id: Date.now() + Math.random(),
                    name: file.name,
                    path: file.path || file.name, // Browser files don't have paths
                    size: file.size,
                    modified: file.lastModifiedDate || new Date(),
                    addedDate: new Date().toISOString()
                });
            });
            
            saveProjectFiles();
            renderFileLists();
            log(`Added ${selectedFilesForUpload.length} file(s) to working files`, 'success');
            closeFilePicker();
        }
        
        // ============================================
        // FILE BROWSER
        // ============================================
        let currentBrowserFolder = '';
        let currentBrowserFiles = [];
        // Note: selectedFile already declared in FILE MANAGEMENT section above
        
        const folderPaths = {
            'living-docs': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents',
            'sessions': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\03-Session-Files',
            'templates': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\06-Templates',
            'command-center': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center',
            'protocols': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\01-Core-Protocols',
            'learning': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\02-Learning',
            'scripts': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\05-Scripts',
            'documentation': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\04-Documentation'
        };
        
        const folderNames = {
            'living-docs': 'Living Documents',
            'sessions': 'Session Library',
            'templates': 'Templates',
            'command-center': 'Command Center',
            'protocols': 'Core Protocols',
            'learning': 'Learning Folder',
            'scripts': 'Scripts',
            'documentation': 'Documentation'
        };
        
        async function openFileBrowser(folderKey) {
            currentBrowserFolder = folderKey;
            const path = folderPaths[folderKey];
            const name = folderNames[folderKey];
            
            document.getElementById('fileBrowserTitle').textContent = name;
            document.getElementById('fileBrowserPath').textContent = path;
            document.getElementById('fileBrowserModal').style.display = 'flex';
            
            log(`Opening file browser: ${name}`, 'info');
            
            // Load files from folder
            await loadFolderFiles(path);
        }
        
        async function loadFolderFiles(path) {
            if (!window.electronAPI) {
                log('File browser requires Electron', 'error');
                document.getElementById('fileList').innerHTML = '<div class="preview-placeholder">File browser requires Electron environment</div>';
                return;
            }
            
            try {
                document.getElementById('fileList').innerHTML = '<div class="preview-placeholder">Loading files...</div>';
                
                // Use Electron API to list directory
                const result = await window.electronAPI.listDirectory(path);
                
                if (result.success && result.files) {
                    currentBrowserFiles = result.files;
                    renderFileList();
                } else {
                    document.getElementById('fileList').innerHTML = '<div class="preview-placeholder">Error loading files</div>';
                    log(`Error loading files: ${result.error}`, 'error');
                }
            } catch (err) {
                document.getElementById('fileList').innerHTML = '<div class="preview-placeholder">Error loading files</div>';
                log(`Error loading folder: ${err.message}`, 'error');
            }
        }
        
        function renderFileList() {
            const container = document.getElementById('fileList');
            const searchTerm = document.getElementById('fileSearchInput').value.toLowerCase();
            
            let filteredFiles = currentBrowserFiles;
            if (searchTerm) {
                filteredFiles = currentBrowserFiles.filter(f => 
                    f.name.toLowerCase().includes(searchTerm)
                );
            }
            
            if (filteredFiles.length === 0) {
                container.innerHTML = '<div class="preview-placeholder">No files found</div>';
                return;
            }
            
            container.innerHTML = filteredFiles.map((file, index) => {
                const icon = getFileIcon(file.name, file.isDirectory);
                const size = file.isDirectory ? '-' : formatFileSize(file.size);
                const date = new Date(file.modified).toLocaleDateString();
                
                return `
                    <div class="file-item ${selectedFile === file ? 'selected' : ''}" 
                         onclick="selectFile(${index})">
                        <div class="file-icon">${icon}</div>
                        <div class="file-info">
                            <div class="file-name">${file.name}</div>
                            <div class="file-meta">
                                <span>${size}</span>
                                <span>${date}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function getFileIcon(filename, isDirectory) {
            if (isDirectory) return '📁';
            
            const ext = filename.split('.').pop().toLowerCase();
            const iconMap = {
                'md': '📝',
                'txt': '📄',
                'docx': '📘',
                'doc': '📘',
                'pdf': '📕',
                'xlsx': '📊',
                'xls': '📊',
                'pptx': '📙',
                'ppt': '📙',
                'png': '🖼️',
                'jpg': '🖼️',
                'jpeg': '🖼️',
                'gif': '🖼️',
                'html': '🌐',
                'css': '🎨',
                'js': '⚡',
                'py': '🐍',
                'json': '📋',
                'zip': '📦'
            };
            
            return iconMap[ext] || '📄';
        }
        
        function selectFile(index) {
            selectedFile = currentBrowserFiles[index];
            renderFileList();
            showFilePreview(selectedFile);
            
            // Enable buttons
            document.getElementById('viewBtn').disabled = false;
            document.getElementById('downloadBtn').disabled = false;
            document.getElementById('fileBrowserInfo').textContent = `Selected: ${selectedFile.name}`;
            
            log(`Selected file: ${selectedFile.name}`, 'info');
        }
        
        async function showFilePreview(file) {
            const previewContent = document.getElementById('previewContent');
            
            if (file.isDirectory) {
                previewContent.innerHTML = `
                    <div class="preview-metadata">
                        <p><strong>Name:</strong> ${file.name}</p>
                        <p><strong>Type:</strong> Folder</p>
                        <p><strong>Modified:</strong> ${new Date(file.modified).toLocaleString()}</p>
                    </div>
                `;
                return;
            }
            
            const ext = file.name.split('.').pop().toLowerCase();
            
            // Text files - show preview
            if (['txt', 'md', 'json', 'html', 'css', 'js', 'py'].includes(ext)) {
                try {
                    const result = await window.electronAPI.readFile(file.path);
                    if (result.success) {
                        const preview = result.content.length > 5000 
                            ? result.content.substring(0, 5000) + '\n\n... (truncated)'
                            : result.content;
                        
                        previewContent.innerHTML = `
                            <div class="preview-metadata">
                                <p><strong>Name:</strong> ${file.name}</p>
                                <p><strong>Size:</strong> ${formatFileSize(file.size)}</p>
                                <p><strong>Modified:</strong> ${new Date(file.modified).toLocaleString()}</p>
                            </div>
                            <hr style="border: 1px solid rgba(255,255,255,0.1); margin: 15px 0;">
                            <div class="preview-text">${preview}</div>
                        `;
                    }
                } catch (err) {
                    showFileMetadata(file);
                }
            } else {
                // Other files - show metadata only
                showFileMetadata(file);
            }
        }
        
        function showFileMetadata(file) {
            const previewContent = document.getElementById('previewContent');
            previewContent.innerHTML = `
                <div class="preview-metadata">
                    <p><strong>Name:</strong> ${file.name}</p>
                    <p><strong>Type:</strong> ${file.name.split('.').pop().toUpperCase()} File</p>
                    <p><strong>Size:</strong> ${formatFileSize(file.size)}</p>
                    <p><strong>Modified:</strong> ${new Date(file.modified).toLocaleString()}</p>
                    <p><strong>Path:</strong> ${file.path}</p>
                    <p style="margin-top: 30px; text-align: center; color: var(--gray-light); font-style: italic;">
                        Preview not available for this file type
                    </p>
                </div>
            `;
        }
        
        async function viewSelectedFile() {
            if (!selectedFile) return;
            
            if (window.electronAPI) {
                const result = await window.electronAPI.openFile(selectedFile.path);
                if (result.success) {
                    log(`Opened file: ${selectedFile.name}`, 'success');
                } else {
                    log(`Error opening file: ${result.error}`, 'error');
                }
            } else {
                log('File viewing requires Electron', 'error');
            }
        }
        
        async function downloadSelectedFile() {
            if (!selectedFile) return;
            
            if (window.electronAPI) {
                const result = await window.electronAPI.saveFile(selectedFile.path);
                if (result.success) {
                    log(`Downloaded: ${selectedFile.name}`, 'success');
                } else {
                    log(`Error downloading: ${result.error}`, 'error');
                }
            } else {
                log('File download requires Electron', 'error');
            }
        }
        
        async function uploadToFolder() {
            const path = folderPaths[currentBrowserFolder];
            log(`Upload to: ${path} - Feature coming soon`, 'info');
            // TODO: Implement file upload
        }
        
        function closeFileBrowser() {
            document.getElementById('fileBrowserModal').style.display = 'none';
            selectedFile = null;
            currentBrowserFiles = [];
            document.getElementById('viewBtn').disabled = true;
            document.getElementById('downloadBtn').disabled = true;
            document.getElementById('fileBrowserInfo').textContent = 'No file selected';
            document.getElementById('previewContent').innerHTML = '<div class="preview-placeholder">Select a file to preview</div>';
        }
        
        // Search functionality
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('fileSearchInput');
            if (searchInput) {
                searchInput.addEventListener('input', renderFileList);
            }
        });
        
        
        // Render file lists
        function renderFileLists() {
            renderFileList('workingFilesList', 'working');
            renderFileList('completedFilesList', 'completed');
        }
        
        function renderFileList(containerId, listType) {
            const container = document.getElementById(containerId);
            const files = projectFiles[listType] || [];
            
            if (files.length === 0) {
                container.innerHTML = '<div class="empty-state">No files yet</div>';
                return;
            }
            
            container.innerHTML = files.map((file, index) => `
                <div class="file-item ${selectedFile && selectedFile.id === file.id ? 'selected' : ''}" 
                     onclick="selectFile('${listType}', ${index})">
                    <span class="file-icon"><i class="fas fa-file"></i></span>
                    <div class="file-info">
                        <div class="file-name" title="${file.name}">${file.name}</div>
                        <div class="file-meta">${formatSize(file.size)}</div>
                    </div>
                    <div class="file-actions">
                        ${listType === 'working' ? `
                            <button class="file-action-btn" onclick="event.stopPropagation(); moveToCompleted(${index})" title="Mark Complete">✓</button>
                        ` : ''}
                        <button class="file-action-btn" onclick="event.stopPropagation(); removeFile('${listType}', ${index})" title="Remove">×</button>
                    </div>
                </div>
            `).join('');
        }
        
        function formatSize(bytes) {
            if (!bytes) return '';
            bytes = parseInt(bytes);
            if (bytes > 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
            if (bytes > 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return bytes + ' bytes';
        }
        
        function selectFile(listType, index) {
            const files = projectFiles[listType] || [];
            selectedFile = { ...files[index], listType, index };
            renderFileLists();
            showPreview(selectedFile);
            log(`Selected: ${selectedFile.name}`, 'info');
        }
        
        function moveToCompleted(index) {
            if (typeof index === 'object') {
                // Called from preview button with selectedFile
                index = selectedFile.index;
            }
            
            const file = projectFiles.working.splice(index, 1)[0];
            projectFiles.completed = projectFiles.completed || [];
            projectFiles.completed.push(file);
            selectedFile = null;
            saveProjectFiles();
            renderFileLists();
            clearPreview();
            log(`Completed: ${file.name}`, 'success');
        }
        
        function removeFile(listType, index) {
            const file = projectFiles[listType].splice(index, 1)[0];
            if (selectedFile && selectedFile.id === file.id) {
                selectedFile = null;
                clearPreview();
            }
            saveProjectFiles();
            renderFileLists();
            log(`Removed: ${file.name}`, 'info');
        }
        
        // ============================================
        // DEVELOPER ACCESS - HANDLED AT PROJECT LEVEL
        // ============================================
        function devCheck(callback) {
            // Access controlled by Developer Toolkit project unlock
            callback();
        }
        
        // ============================================
        // CODING RESOURCES SYSTEM
        // ============================================
        const codingResources = {
            html: {
                title: '📘 HTML Basics',
                emoji: '📘',
                resources: [
                    { name: 'HTML Tutorial (W3Schools)', url: 'https://www.w3schools.com/html/', type: 'Interactive Tutorial', level: 'Beginner' },
                    { name: 'HTML Basics (MDN)', url: 'https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/HTML_basics', type: 'Documentation', level: 'Beginner' },
                    { name: 'Learn HTML (Codecademy)', url: 'https://www.codecademy.com/learn/learn-html', type: 'Interactive Course', level: 'Beginner' },
                    { name: 'HTML Crash Course (YouTube)', url: 'https://www.youtube.com/watch?v=UB1O30fR-EE', type: 'Video Tutorial', level: 'Beginner' },
                    { name: 'HTML Cheat Sheet', url: 'https://htmlcheatsheet.com/', type: 'Quick Reference', level: 'All Levels' },
                    { name: 'HTML Elements Reference', url: 'https://developer.mozilla.org/en-US/docs/Web/HTML/Element', type: 'Reference', level: 'All Levels' }
                ]
            },
            css: {
                title: '🎨 CSS Basics',
                emoji: '🎨',
                resources: [
                    { name: 'CSS Tutorial (W3Schools)', url: 'https://www.w3schools.com/css/', type: 'Interactive Tutorial', level: 'Beginner' },
                    { name: 'Learn CSS (MDN)', url: 'https://developer.mozilla.org/en-US/docs/Learn/CSS', type: 'Documentation', level: 'Beginner' },
                    { name: 'CSS Flexbox Guide', url: 'https://css-tricks.com/snippets/css/a-guide-to-flexbox/', type: 'Visual Guide', level: 'Intermediate' },
                    { name: 'CSS Grid Guide', url: 'https://css-tricks.com/snippets/css/complete-guide-grid/', type: 'Visual Guide', level: 'Intermediate' },
                    { name: 'CSS Crash Course (YouTube)', url: 'https://www.youtube.com/watch?v=yfoY53QXEnI', type: 'Video Tutorial', level: 'Beginner' },
                    { name: 'CSS Tricks', url: 'https://css-tricks.com/', type: 'Articles & Tips', level: 'All Levels' },
                    { name: 'CSS Cheat Sheet', url: 'https://htmlcheatsheet.com/css/', type: 'Quick Reference', level: 'All Levels' }
                ]
            },
            python: {
                title: '🐍 Python Basics',
                emoji: '🐍',
                resources: [
                    { name: 'Python Tutorial (Official)', url: 'https://docs.python.org/3/tutorial/', type: 'Official Documentation', level: 'Beginner' },
                    { name: 'Learn Python (W3Schools)', url: 'https://www.w3schools.com/python/', type: 'Interactive Tutorial', level: 'Beginner' },
                    { name: 'Python for Beginners (Microsoft)', url: 'https://www.youtube.com/playlist?list=PLlrxD0HtieHhS8VzuMCfQD4uJ9yne1mE6', type: 'Video Series', level: 'Beginner' },
                    { name: 'Automate the Boring Stuff', url: 'https://automatetheboringstuff.com/', type: 'Free Online Book', level: 'Beginner' },
                    { name: 'Python Crash Course (YouTube)', url: 'https://www.youtube.com/watch?v=_uQrJ0TkZlc', type: 'Video Tutorial', level: 'Beginner' },
                    { name: 'Real Python', url: 'https://realpython.com/', type: 'Tutorials & Articles', level: 'All Levels' },
                    { name: 'Python Cheat Sheet', url: 'https://www.pythoncheatsheet.org/', type: 'Quick Reference', level: 'All Levels' }
                ]
            },
            javascript: {
                title: '⚡ JavaScript Basics',
                emoji: '⚡',
                resources: [
                    { name: 'JavaScript Tutorial (W3Schools)', url: 'https://www.w3schools.com/js/', type: 'Interactive Tutorial', level: 'Beginner' },
                    { name: 'JavaScript Basics (MDN)', url: 'https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/JavaScript_basics', type: 'Documentation', level: 'Beginner' },
                    { name: 'JavaScript for Beginners (YouTube)', url: 'https://www.youtube.com/watch?v=W6NZfCO5SIk', type: 'Video Tutorial', level: 'Beginner' },
                    { name: 'Learn JavaScript (Codecademy)', url: 'https://www.codecademy.com/learn/introduction-to-javascript', type: 'Interactive Course', level: 'Beginner' },
                    { name: 'JavaScript.info', url: 'https://javascript.info/', type: 'Modern Tutorial', level: 'Beginner to Advanced' },
                    { name: 'Eloquent JavaScript (Free Book)', url: 'https://eloquentjavascript.net/', type: 'Online Book', level: 'Beginner to Advanced' },
                    { name: 'JavaScript Cheat Sheet', url: 'https://htmlcheatsheet.com/js/', type: 'Quick Reference', level: 'All Levels' }
                ]
            }
        };
        
        function showCodingResources(language) {
            const modal = document.getElementById('codingResourcesModal');
            const title = document.getElementById('codingModalTitle');
            const list = document.getElementById('codingResourcesList');
            
            const resources = codingResources[language];
            if (!resources) return;
            
            title.textContent = resources.title;
            
            // Build resource list with categories
            let html = '<div style="margin-bottom: 20px; color: var(--gray-light); font-size: 0.9rem;">';
            html += 'Click any resource to open it in your browser:';
            html += '</div>';
            
            html += '<div class="guide-list">';
            
            resources.resources.forEach(resource => {
                html += `
                    <div class="guide-item" style="cursor: pointer;" onclick="openExternal('${resource.url}')">
                        <div>
                            <div class="guide-name">${resource.name}</div>
                            <div style="color: var(--gray-light); font-size: 0.75rem; margin-top: 4px;">
                                ${resource.type} • ${resource.level}
                            </div>
                        </div>
                        <button class="guide-btn" onclick="event.stopPropagation(); openExternal('${resource.url}')">Open</button>
                    </div>
                `;
            });
            
            html += '</div>';
            
            // Add learning path suggestion
            html += `
                <div style="margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 6px; border-left: 3px solid var(--orange-mid);">
                    <div style="color: var(--cream); font-weight: bold; margin-bottom: 8px;">💡 Suggested Learning Path:</div>
                    <div style="color: var(--gray-light); font-size: 0.85rem; line-height: 1.5;">
                        ${getLearningPath(language)}
                    </div>
                </div>
            `;
            
            list.innerHTML = html;
            modal.classList.add('active');
        }
        
        function getLearningPath(language) {
            const paths = {
                html: '1️⃣ Start with W3Schools tutorial (hands-on practice)<br>2️⃣ Watch the YouTube crash course for overview<br>3️⃣ Read MDN docs for deeper understanding<br>4️⃣ Keep the cheat sheet handy while coding<br>5️⃣ Build a simple webpage to practice',
                css: '1️⃣ Start with W3Schools for basics (colors, fonts, spacing)<br>2️⃣ Learn Flexbox (for layouts)<br>3️⃣ Learn CSS Grid (for complex layouts)<br>4️⃣ Watch crash course to tie it together<br>5️⃣ Style your HTML practice page',
                python: '1️⃣ Start with W3Schools for syntax basics<br>2️⃣ Watch Microsoft\'s video series<br>3️⃣ Read "Automate the Boring Stuff" (practical projects)<br>4️⃣ Keep cheat sheet handy<br>5️⃣ Write scripts for your daily tasks',
                javascript: '1️⃣ Start with W3Schools for basics<br>2️⃣ Watch beginner YouTube tutorial<br>3️⃣ Read JavaScript.info (comprehensive)<br>4️⃣ Practice with interactive exercises<br>5️⃣ Add interactivity to your HTML/CSS pages'
            };
            return paths[language] || 'Start with beginner resources and work your way up!';
        }
        
        function hideCodingResources() {
            document.getElementById('codingResourcesModal').classList.remove('active');
        }
        
        function closeCodingResources(event) {
            if (event.target === event.currentTarget) {
                hideCodingResources();
            }
        }
        
        // ============================================
        // USER GUIDES SYSTEM
        // ============================================
        const userGuides = [
            // Core Protocols (Google Docs URLs - UPDATE THESE WITH YOUR ACTUAL URLS)
            { name: '6-Category System Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_1/edit', file: '6_Category_System_Guide.docx' },
            { name: 'End of Session Closeout', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_2/edit', file: 'End_Of_Session_Closeout.docx' },
            { name: 'File Systems User Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_3/edit', file: 'File_Systems_User_Guide.docx' },
            { name: 'Morning Session Startup', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_4/edit', file: 'Morning_Session_Startup.docx' },
            { name: 'Operational Protocols', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_5/edit', file: 'Operational_Protocols.docx' },
            { name: 'The Commandments of AI', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_6/edit', file: 'The_Commandments_of_AI.docx' },
            { name: 'Bill\'s Profile', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_7/edit', file: 'Bills_Profile.docx' },
            { name: 'START HERE - Implementation Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_8/edit', file: 'START_HERE_Implementation_Guide.md' },
            { name: 'Development Workflow', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_9/edit', file: 'DEVELOPMENT_WORKFLOW.md' },
            { name: 'Adding Utility Buttons Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_10/edit', file: 'ADDING_UTILITY_BUTTONS.md' },
            { name: 'Operational Protocol (MD)', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_11/edit', file: 'OPERATIONAL_PROTOCOL.md' },
            { name: 'Limitless Integration Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_12/edit', file: 'Limitless_Integration_Guide.md' }
        ];
        
        function showUserGuides() {
            const modal = document.getElementById('userGuidesModal');
            modal.classList.add('active');
            
            const guideList = document.getElementById('guideList');
            guideList.innerHTML = userGuides.map(guide => `
                <div class="guide-item" data-name="${guide.name.toLowerCase()}">
                    <span class="guide-name">${guide.name}</span>
                    <button class="guide-btn" onclick="event.stopPropagation(); openGuide('${guide.url}', '${guide.file}')">Open in Docs</button>
                </div>
            `).join('');
            
            // Clear search
            document.getElementById('guideSearch').value = '';
        }
        
        function hideUserGuides() {
            document.getElementById('userGuidesModal').classList.remove('active');
        }
        
        function closeUserGuides(event) {
            if (event.target === event.currentTarget) {
                hideUserGuides();
            }
        }
        
        function filterGuides() {
            const search = document.getElementById('guideSearch').value.toLowerCase();
            const items = document.querySelectorAll('.guide-item');
            
            items.forEach(item => {
                const name = item.dataset.name;
                if (name.includes(search)) {
                    item.classList.remove('hidden');
                } else {
                    item.classList.add('hidden');
                }
            });
        }
        
        async function openGuide(url, filename) {
            // If URL is configured (not default), open Google Doc
            if (url && !url.includes('YOUR_DOC_ID')) {
                openExternal(url);
                log(`Opened in Google Docs: ${filename}`, 'success');
                hideUserGuides();
            } else {
                // Fallback to local file if Google Doc URL not configured
                if (!window.electronAPI) {
                    log('File opening requires Electron', 'error');
                    return;
                }
                
                try {
                    const filePath = `G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\${filename}`;
                    await window.electronAPI.runCommand(`start "" "${filePath}"`);
                    log(`Opened local file: ${filename}`, 'success');
                    hideUserGuides();
                } catch (err) {
                    log(`Error opening guide: ${err.message}`, 'error');
                }
            }
        }
        
        // ============================================
        // FILE CONVERSION FUNCTIONS
        // ============================================
        async function runConversion(type) {
            if (!window.electronAPI) {
                log('Conversion requires Electron', 'error');
                return;
            }
            
            const scripts = {
                'md-to-docx': 'convert_md_to_docx.py',
                'docx-to-gdocs': 'convert_to_google_docs.py',
                'gdocs-to-docx': 'export_gdocs_to_docx.py',
                'batch-convert': 'batch_convert_to_gdocs.py'
            };
            
            const script = scripts[type];
            if (!script) {
                log(`Unknown conversion type: ${type}`, 'error');
                return;
            }
            
            try {
                const scriptPath = `G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\${script}`;
                log(`Running conversion: ${type}...`, 'info');
                
                // Pick file first for single conversions
                if (type !== 'batch-convert') {
                    const result = await window.electronAPI.pickFiles();
                    if (result.success && result.files.length > 0) {
                        const filePath = result.files[0].path;
                        await window.electronAPI.runCommand(`python "${scriptPath}" "${filePath}"`);
                        log(`Conversion complete: ${result.files[0].name}`, 'success');
                    }
                } else {
                    // Batch convert - run script directly
                    await window.electronAPI.runCommand(`python "${scriptPath}"`);
                    log('Batch conversion started - check terminal for progress', 'info');
                }
            } catch (err) {
                log(`Conversion error: ${err.message}`, 'error');
            }
        }
        
        // ============================================
        // LIVING DOCUMENTS QUICK ACCESS
        // ============================================
        function toggleLivingDocsMenu() {
            const menu = document.getElementById('livingDocsMenu');
            const btn = document.getElementById('livingDocsBtn');
            const arrow = btn.querySelector('span:last-child');
            
            if (menu.style.display === 'none') {
                menu.style.display = 'block';
                arrow.textContent = '▲';
            } else {
                menu.style.display = 'none';
                arrow.textContent = '▼';
            }
        }
        
        async function openLivingDoc(docType) {
            const docs = {
                'diary': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents\\Bills_Daily_Journal.html',
                'journal': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents\\Trajanus_Project_Journal.md',
                'protocols': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\01-Core-Protocols',
                'pov': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents\\Bills_POV.md',
                'sessions': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\03-Session-Files',
                'all': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents'
            };
            
            const path = docs[docType];
            if (path) {
                try {
                    await window.electronAPI.runCommand(`explorer "${path}"`);
                    log(`Opened: ${docType}`, 'success');
                } catch (err) {
                    log(`Error opening ${docType}: ${err.message}`, 'error');
                }
            }
        }
        
        // ============================================
        // FOLDER NAVIGATION
        // ============================================
        async function openLocalFolder(folderName) {
            if (!window.electronAPI) {
                log('Folder opening requires Electron', 'error');
                return;
            }
            
            const folders = {
                'living-docs': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents',
                'protocols': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\01-Core-Protocols',
                'templates': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\02-Templates',
                'sessions': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\03-Session-Files',
                'documentation': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\04-Documentation',
                'scripts': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\05-Scripts',
                'command-center': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center'
            };
            
            const path = folders[folderName];
            if (path) {
                try {
                    await window.electronAPI.runCommand(`explorer "${path}"`);
                    log(`Opened folder: ${folderName}`, 'success');
                } catch (err) {
                    log(`Error opening folder: ${err.message}`, 'error');
                }
            }
        }
        
        function openDriveFolder(folderName) {
            const folders = {
                'main': 'https://drive.google.com/drive/folders/1ngKnGqz8YvHG5yzKPG6qVxSdPzqXHVJB',
                'living-docs': 'https://drive.google.com/drive/folders/YOUR_FOLDER_ID',
                'protocols': 'https://drive.google.com/drive/folders/YOUR_FOLDER_ID',
                'templates': 'https://drive.google.com/drive/folders/YOUR_FOLDER_ID',
                'sessions': 'https://drive.google.com/drive/folders/YOUR_FOLDER_ID'
            };
            
            const url = folders[folderName];
            if (url) {
                openExternal(url);
                log(`Opening ${folderName} in Google Drive`, 'info');
            }
        }
        
        // ============================================
        // DEVELOPER MODE
        // ============================================
        function toggleDevMode() {
            document.body.classList.toggle('developer-mode');
            const isActive = document.body.classList.contains('developer-mode');
            
            const toggle = document.getElementById('devToggle');
            const badge = document.getElementById('devBadge');
            
            if (isActive) {
                toggle.classList.add('active');
                badge.textContent = 'ON';
                badge.style.background = 'var(--green-badge)';
                log('Developer mode ENABLED', 'success');
            } else {
                toggle.classList.remove('active');
                badge.textContent = 'OFF';
                badge.style.background = 'var(--gray-mid)';
                log('Developer mode DISABLED', 'info');
            }
            
            // Save preference
            localStorage.setItem('developerMode', isActive);
        }
        
        // Enhanced preview functions
        function showPreview(file) {
            const previewContent = document.getElementById('previewContent');
            const previewActions = document.getElementById('previewActions');
            
            if (!file) {
                clearPreview();
                return;
            }
            
            // Determine file icon based on extension
            const ext = file.name.split('.').pop().toLowerCase();
            let icon = 'fa-file';
            if (['pdf'].includes(ext)) icon = 'fa-file-pdf';
            else if (['doc', 'docx'].includes(ext)) icon = 'fa-file-word';
            else if (['xls', 'xlsx'].includes(ext)) icon = 'fa-file-excel';
            else if (['ppt', 'pptx'].includes(ext)) icon = 'fa-file-powerpoint';
            else if (['jpg', 'jpeg', 'png', 'gif'].includes(ext)) icon = 'fa-file-image';
            else if (['zip', 'rar', '7z'].includes(ext)) icon = 'fa-file-archive';
            else if (['txt', 'md'].includes(ext)) icon = 'fa-file-alt';
            
            previewContent.innerHTML = `
                <div class="preview-file-icon"><i class="fas ${icon}"></i></div>
                <div class="preview-file-name">${file.name}</div>
                <div class="preview-file-meta">${formatSize(file.size)}</div>
                <div class="preview-file-meta">${new Date(file.modified).toLocaleDateString()}</div>
            `;
            
            previewActions.style.display = 'flex';
        }
        
        function clearPreview() {
            const previewContent = document.getElementById('previewContent');
            const previewActions = document.getElementById('previewActions');
            
            previewContent.innerHTML = `
                <div class="preview-file-icon"><i class="fas fa-file"></i></div>
                <div>Select a file to preview</div>
            `;
            
            previewActions.style.display = 'none';
        }
        
        async function viewSelectedFile() {
            if (!selectedFile || !window.electronAPI) return;
            
            try {
                await window.electronAPI.runCommand(`start "" "${selectedFile.path}"`);
                log(`Opening: ${selectedFile.name}`, 'success');
            } catch (err) {
                log(`Error opening file: ${err.message}`, 'error');
            }
        }
        
        async function openFileLocation() {
            if (!selectedFile || !window.electronAPI) return;
            
            try {
                // Get directory path
                const dirPath = selectedFile.path.substring(0, selectedFile.path.lastIndexOf('\\'));
                await window.electronAPI.runCommand(`explorer "${dirPath}"`);
                log(`Opened folder: ${dirPath}`, 'success');
            } catch (err) {
                log(`Error opening folder: ${err.message}`, 'error');
            }
        }
        
        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', async () => {
            // Load developer mode preference
            
            log('Trajanus Enterprise Hub v2.0.0 initialized', 'success');
            log('All systems online. Ready for commands.', 'info');
            
            // Get platform info
            if (window.electronAPI) {
                const platform = await window.electronAPI.getPlatform();
                document.getElementById('platform').textContent = `Platform: ${platform.platform}`;
            }
            
            // Load files for current project
            loadProjectFiles(currentProject);
        });
    </script>
</body>
</html>
