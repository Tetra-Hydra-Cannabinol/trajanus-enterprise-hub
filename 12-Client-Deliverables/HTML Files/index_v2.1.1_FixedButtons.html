<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trajanus Enterprise Hub v2.0</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* ============================================
           COLOR SCHEME - Extracted from original
           ============================================ */
        :root {
            --brown-dark: #1f1410;
            --brown-mid: #3d2a1f;
            --brown-light: #5c4033;
            --cream: #FFF8F0;
            --orange-dark: #a85a1b;
            --orange-mid: #cc6e1f;
            --orange-light: #e8922a;
            --tan: #d4a574;
            --gray-dark: #2d2622;
            --gray-mid: #4a413a;
            --gray-light: #a89890;
            --green-badge: #28a745;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--brown-mid) 0%, var(--brown-dark) 100%);
            min-height: 100vh;
            display: flex;
            color: var(--cream);
        }
        
        /* ============================================
           SIDEBAR
           ============================================ */
        .sidebar {
            width: 320px;
            background: rgba(0,0,0,0.3);
            padding: 25px;
            display: flex;
            flex-direction: column;
            border-right: 1px solid rgba(255,255,255,0.1);
            overflow-y: auto;
        }
        
        .sidebar-header {
            text-align: center;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 25px;
        }
        
        .sidebar-header h1 {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--cream);
            letter-spacing: 1px;
        }
        
        .sidebar-header .tagline {
            font-size: 1.07rem;
            color: var(--orange-light);
            margin-top: 8px;
            font-style: italic;
        }
        
        .sidebar-header .ei-logo {
            width: 120px;
            height: 80px;
            margin: 5px auto 8px auto;
            display: block;
        }
        
        .sidebar-header .ei-logo svg {
            width: 100%;
            height: 100%;
        }
        
        .sidebar-header .version {
            font-size: 0.7rem;
            color: var(--gray-light);
            margin-top: 10px;
        }
        
        .project-section {
            margin-bottom: 30px;
        }
        
        .project-section h3 {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--gray-light);
            margin-bottom: 15px;
            padding-left: 12px;
        }
        
        .project-btn {
            width: 100%;
            padding: 18px;
            background: transparent;
            border: none;
            border-radius: 8px;
            color: var(--cream);
            text-align: left;
            cursor: pointer;
            font-size: 1.15rem;
            transition: all 0.2s;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .project-btn:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .project-btn.active {
            background: rgba(255,255,255,0.15);
            border-left: 4px solid var(--orange-light);
        }
        
        .project-btn.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
        
        .project-btn.drag-over {
            border-top: 3px solid var(--orange-light);
        }
        
        .project-btn {
            cursor: grab;
        }
        
        .project-btn:active {
            cursor: grabbing;
        }
        
        .sidebar-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 700;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .sidebar-badge.dev {
            background: var(--orange-mid);
            color: #fff;
        }
        
        .sidebar-badge.deployed {
            background: var(--green-badge);
            color: #fff;
        }
        
        .sidebar-footer {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .quick-access-section {
            margin-top: 20px;
            margin-bottom: 15px;
        }
        
        .quick-access-section h3 {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--gray-light);
            margin-bottom: 15px;
            padding-left: 12px;
        }
        
        .quick-access-btn {
            width: 100%;
            padding: 12px 18px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: var(--cream);
            text-align: left;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .quick-access-btn:hover {
            background: rgba(255,255,255,0.1);
            border-color: var(--orange-mid);
        }
        
        .living-docs-menu {
            margin-top: 8px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .living-doc-item {
            width: 100%;
            padding: 10px 12px;
            background: transparent;
            border: none;
            border-radius: 6px;
            color: var(--cream);
            text-align: left;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
            margin-bottom: 4px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .living-doc-item:hover {
            background: rgba(232,146,42,0.2);
        }
        
        .living-doc-item .btn-label {
            font-weight: bold;
            font-size: 0.9rem;
            color: var(--cream);
        }
        
        .living-doc-item .btn-description {
            font-size: 0.7rem;
            color: var(--gray-light);
            line-height: 1.2;
        }
        
        /* ============================================
           MAIN CONTENT
           ============================================ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: auto;
        }
        
        .header {
            background: var(--cream);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header-title h2 {
            color: var(--brown-mid);
            font-size: 1.5rem;
        }
        
        .header-title .breadcrumb {
            color: var(--gray-mid);
            font-size: 0.85rem;
            margin-top: 3px;
        }
        
        /* Clock - Horizontal bar */
        .clock {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            background: linear-gradient(90deg, #cc6e1f, #e8922a);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            min-width: 320px;
        }
        
        .clock-left {
            display: flex;
            align-items: baseline;
            gap: 15px;
        }
        
        .clock-date {
            font-size: 15px;
            font-weight: 400;
            color: #fff;
            letter-spacing: 1px;
        }
        
        .clock-time {
            font-size: 15px;
            font-weight: 300;
            color: #fff;
        }
        
        .workspace {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* ============================================
           APP LAUNCHERS
           ============================================ */
        .app-launcher-section {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .app-group {
            background: var(--brown-dark);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 15px;
            flex: 1;
            min-width: 200px;
        }
        
        .app-group-header {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray-light);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .app-group-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .app-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 10px 12px;
            background: var(--brown-dark);
            border: 2px solid var(--brown-light);
            border-radius: 4px;
            color: var(--cream);
            cursor: pointer;
            font-size: 10px;
            transition: all 0.15s;
            min-width: 56px;
        }
        
        .app-btn i {
            font-size: 18px;
            color: var(--orange-light);
        }
        
        .app-btn:hover {
            background: var(--orange-mid);
            border-color: var(--orange-mid);
            color: var(--brown-dark);
        }
        
        .app-btn:hover i {
            color: var(--brown-dark);
        }
        
        /* ============================================
           SESSION CONTROLS
           ============================================ */
        .tool-section {
            background: var(--brown-dark);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 20px;
        }
        
        .tool-section-header {
            font-size: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #FFFFFF;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .button-grid {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: flex-start;
        }
        
        .button-grid .session-btn {
            flex: 0 0 auto;
        }
        
        .session-btn {
            padding: 14px 24px;
            min-height: 52px;
            height: auto;
            min-width: 220px;
            max-width: 280px;
            width: auto;
            background: linear-gradient(180deg, #e8922a 0%, #cc6e1f 100%);
            color: #1f1410;
            border: 1px solid #9d6639;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3),
                        0 2px 4px rgba(0, 0, 0, 0.2),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3),
                        inset 0 -2px 0 rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            gap: 4px;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
        }
        
        .session-btn:hover {
            background: linear-gradient(180deg, #f5a03a 0%, #d47b2f 100%);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.35),
                        0 3px 6px rgba(0, 0, 0, 0.25),
                        inset 0 1px 0 rgba(255, 255, 255, 0.4),
                        inset 0 -2px 0 rgba(0, 0, 0, 0.25);
            transform: translateY(-2px);
            border-color: #b8753c;
        }
        
        .session-btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4),
                        inset 0 3px 8px rgba(0, 0, 0, 0.3);
            background: linear-gradient(180deg, #cc6e1f 0%, #b85e19 100%);
        }
        
        .btn-label {
            font-weight: bold;
            font-size: 0.95rem;
        }
        
        .btn-description {
            font-size: 0.7rem;
            color: rgba(45, 24, 16, 0.7);
            line-height: 1.3;
            font-weight: normal;
        }
        
        /* Tooltips */
        [data-tooltip] {
            position: relative;
            cursor: help;
        }
        
        [data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 12px;
            background: rgba(0,0,0,0.95);
            color: #fff;
            font-size: 0.75rem;
            white-space: nowrap;
            border-radius: 6px;
            z-index: 1000;
            margin-bottom: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        [data-tooltip]:hover::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: rgba(0,0,0,0.95);
            z-index: 1000;
            margin-bottom: 2px;
        }
        
        /* Section Introduction */
        .section-intro {
            background: rgba(232,146,42,0.15);
            border: 1px solid rgba(232,146,42,0.3);
            border-left: 3px solid var(--orange-mid);
            padding: 12px 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            color: rgba(255,255,255,0.85);
            font-size: 0.85rem;
            line-height: 1.5;
        }
        
        .section-intro strong {
            color: var(--orange-light);
            font-weight: 600;
        }
        
        /* ============================================
           TERMINAL
           ============================================ */
        .terminal {
            background: #1e1e1e;
            border-radius: 10px;
            overflow: hidden;
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 300px;
        }
        
        .terminal-header {
            background: #2d2d2d;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .terminal-tabs {
            display: flex;
            gap: 5px;
            flex: 1;
        }
        
        .terminal-tab {
            padding: 6px 15px;
            background: rgba(255,255,255,0.05);
            border: none;
            border-radius: 5px 5px 0 0;
            color: #fff;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
            white-space: nowrap;
        }
        
        .terminal-tab:hover {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }
        
        .terminal-tab.active {
            background: var(--orange-mid);
            color: #fff;
        }
        
        .terminal-tab .close-tab {
            margin-left: 8px;
            opacity: 0.6;
        }
        
        .terminal-tab .close-tab:hover {
            opacity: 1;
        }
        
        /* Permanent Tabs - Always visible, can't be closed, equal width */
        .terminal-tab.permanent-tab {
            background: rgba(204, 110, 31, 0.15);
            border-left: 2px solid #cc6e1f;
            font-weight: 500;
            color: #fff;
            min-width: 160px;
            text-align: center;
        }
        
        .terminal-tab.permanent-tab:hover {
            background: rgba(204, 110, 31, 0.25);
            color: #fff;
        }
        
        .terminal-tab.permanent-tab.active {
            background: var(--orange-mid);
            border-left: 2px solid #e8922a;
            color: #fff;
        }
        
        .terminal-tab-add {
            background: none;
            border: 1px dashed rgba(255,255,255,0.3);
            border-radius: 5px;
            color: var(--gray-light);
            cursor: pointer;
            padding: 4px 10px;
            font-size: 0.9rem;
        }
        
        .terminal-tab-add:hover {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }
        
        .terminal-actions {
            margin-left: auto;
        }
        
        .terminal-clear {
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 4px;
            color: var(--gray-light);
            cursor: pointer;
            padding: 5px 12px;
            font-size: 0.75rem;
        }
        
        .terminal-clear:hover {
            background: rgba(255,255,255,0.2);
            color: #fff;
        }
        
        .terminal-bodies {
            position: relative;
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .terminal-body {
            display: none;
            padding: 15px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 0.85rem;
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            line-height: 1.6;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        
        .terminal-body.active {
            display: block;
        }
        
        .terminal-body .info { color: #9cdcfe; }
        .terminal-body .success { color: #4ec9b0; }
        .terminal-body .error { color: #f14c4c; }
        .terminal-body .warning { color: #cca700; }
        
        /* ============================================
           STATUS BAR
           ============================================ */
        .status-bar {
            background: rgba(0,0,0,0.3);
            padding: 8px 20px;
            display: flex;
            gap: 30px;
            font-size: 0.75rem;
            color: var(--gray-light);
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ec9b0;
        }
        
        /* ============================================
           RIGHT PANEL - PROJECT FILES
           ============================================ */
        .right-panel {
            width: 400px;
            min-width: 280px;
            max-width: 800px;
            background: rgba(0,0,0,0.3);
            border-left: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            resize: horizontal;
        }
        
        .right-panel-header {
            padding: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .right-panel-header h3 {
            font-size: 0.85rem;
            color: var(--cream);
        }
        
        .panel-section {
            padding: 10px 15px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .panel-section h4 {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray-light);
            margin-bottom: 10px;
        }
        
        .file-list {
            max-height: 250px;
            overflow-y: auto;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            padding: 8px 10px;
            margin: 2px 0;
            background: rgba(255,255,255,0.03);
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .file-item:hover {
            background: rgba(255,255,255,0.08);
        }
        
        .file-item.selected {
            background: rgba(204,110,31,0.2);
            border-left: 2px solid var(--orange-mid);
        }
        
        .file-icon {
            margin-right: 10px;
            font-size: 1rem;
            color: var(--orange-light);
        }
        
        /* ============================================
           QCM SUBMITTAL REVIEW WORKSPACE STYLES
           ============================================ */
        
        .qcm-workspace-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .qcm-workspace-header {
            padding: 10px 15px;
            border-bottom: 1px solid rgba(204, 110, 31, 0.3);
            flex-shrink: 0;
        }
        
        .qcm-workspace {
            display: grid;
            grid-template-columns: 1fr 1fr 1.2fr;
            gap: 15px;
            padding: 15px;
            flex: 1;
            overflow: hidden;
            min-height: 0;
        }
        
        .qcm-panel {
            background: rgba(45, 24, 16, 0.6);
            border: 1px solid rgba(204, 110, 31, 0.3);
            border-radius: 6px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 0;
        }
        
        .panel-header {
            font-weight: bold;
            color: var(--orange-light);
            margin-bottom: 15px;
            font-size: 1.1rem;
            border-bottom: 1px solid rgba(204, 110, 31, 0.3);
            padding-bottom: 8px;
            flex-shrink: 0;
        }
        
        .qcm-file-browser .file-list,
        .qcm-selected-queue .selected-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 10px;
        }
        
        .breadcrumb {
            background: rgba(31, 20, 16, 0.8);
            padding: 8px 12px;
            border-radius: 4px;
            margin-bottom: 15px;
            font-size: 0.85rem;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 5px;
            flex-wrap: wrap;
            flex-shrink: 0;
        }
        
        .breadcrumb-item {
            color: var(--orange-light);
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .breadcrumb-item:hover {
            color: #fff;
        }
        
        .breadcrumb-item:not(:last-child):after {
            content: " >";
            color: var(--gray-light);
            margin-left: 5px;
        }
        
        .template-select {
            width: 100%;
            padding: 10px;
            background: rgba(31, 20, 16, 0.8);
            color: var(--cream);
            border: 1px solid rgba(204, 110, 31, 0.3);
            border-radius: 4px;
            font-size: 0.9rem;
            margin-bottom: 15px;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .template-select:focus {
            outline: none;
            border-color: var(--orange-light);
        }
        
        .report-item:hover {
            background: rgba(204, 110, 31, 0.2) !important;
            border-color: var(--orange-light) !important;
            transform: translateX(3px);
        }
        
        .instructions-area {
            flex: 1;
            background: rgba(31, 20, 16, 0.8);
            color: #fff;
            border: 1px solid rgba(204, 110, 31, 0.3);
            border-radius: 4px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            resize: none;
            line-height: 1.5;
        }
        
        .instructions-area:focus {
            outline: none;
            border-color: var(--orange-light);
        }
        
        .instructions-area::placeholder {
            color: var(--gray-light);
            opacity: 0.6;
        }
        
        .char-count {
            margin-top: 8px;
            font-size: 0.75rem;
            color: #fff;
            text-align: right;
            flex-shrink: 0;
        }
        
        .queue-summary {
            margin-top: 10px;
            padding: 10px;
            background: rgba(31, 20, 16, 0.8);
            border-radius: 4px;
            font-size: 0.85rem;
            color: #fff;
            border-top: 1px solid rgba(204, 110, 31, 0.3);
            flex-shrink: 0;
        }
        
        .qcm-file-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 6px;
            background: rgba(31, 20, 16, 0.6);
            border: 1px solid rgba(204, 110, 31, 0.2);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .qcm-file-item:hover {
            background: rgba(204, 110, 31, 0.15);
            border-color: rgba(204, 110, 31, 0.4);
        }
        
        .qcm-file-item input[type="checkbox"] {
            margin-right: 10px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }
        
        .qcm-file-info {
            flex: 1;
        }
        
        .qcm-file-name {
            color: #fff;
            font-size: 0.9rem;
            margin-bottom: 4px;
        }
        
        .qcm-file-meta {
            font-size: 0.75rem;
            color: #fff;
        }
        
        .qcm-selected-item {
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(31, 20, 16, 0.6);
            border: 1px solid rgba(204, 110, 31, 0.3);
            border-radius: 4px;
        }
        
        .qcm-selected-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }
        
        .qcm-selected-name {
            color: #fff;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .qcm-remove-btn {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.4);
            color: #ff6b6b;
            padding: 4px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.2s;
        }
        
        .qcm-remove-btn:hover {
            background: rgba(220, 53, 69, 0.4);
            border-color: rgba(220, 53, 69, 0.6);
        }
        
        .qcm-selected-meta {
            font-size: 0.75rem;
            color: #fff;
        }
        
        .qcm-actions {
            display: flex;
            gap: 10px;
            padding: 15px;
            border-top: 1px solid rgba(204, 110, 31, 0.3);
            background: rgba(45, 24, 16, 0.8);
            flex-shrink: 0;
        }
        
        .qcm-primary {
            background: linear-gradient(180deg, #e8922a 0%, #cc6e1f 100%);
            font-weight: 600;
        }
        
        .qcm-primary:hover {
            background: linear-gradient(180deg, #f5a23f 0%, #d97a29 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(232, 146, 42, 0.4);
        }
        
        /* Review Results Panel */
        .qcm-review-panel {
            background: rgba(31, 20, 16, 0.95);
            border: 2px solid var(--orange-light);
            border-radius: 6px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(204, 110, 31, 0.5);
        }
        
        .review-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--orange-light);
        }
        
        .review-status {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .review-status.analyzing {
            background: rgba(232, 146, 42, 0.2);
            color: #e8922a;
            border: 1px solid rgba(232, 146, 42, 0.4);
        }
        
        .review-status.waiting {
            background: rgba(128, 128, 128, 0.2);
            color: #999;
            border: 1px solid rgba(128, 128, 128, 0.4);
        }
        
        .review-status.complete {
            background: rgba(40, 167, 69, 0.2);
            color: #4caf50;
            border: 1px solid rgba(40, 167, 69, 0.4);
        }
        
        .review-content {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            background: rgba(45, 24, 16, 0.6);
            border-radius: 4px;
            line-height: 1.6;
        }
        
        .review-section {
            margin-bottom: 25px;
        }
        
        .review-section-title {
            color: var(--orange-light);
            font-weight: bold;
            font-size: 1rem;
            margin-bottom: 10px;
            padding-bottom: 6px;
            border-bottom: 1px solid rgba(204, 110, 31, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .review-section-content {
            color: var(--cream);
            font-size: 0.9rem;
        }
        
        .review-finding {
            padding: 10px;
            margin: 8px 0;
            border-radius: 4px;
            border-left: 3px solid;
        }
        
        .review-finding.pass {
            background: rgba(40, 167, 69, 0.1);
            border-left-color: #4caf50;
        }
        
        .review-finding.warning {
            background: rgba(255, 193, 7, 0.1);
            border-left-color: #ffc107;
        }
        
        .review-finding.fail {
            background: rgba(220, 53, 69, 0.1);
            border-left-color: #dc3545;
        }
        
        .review-finding-icon {
            display: inline-block;
            margin-right: 8px;
            font-weight: bold;
        }
        
        .review-recommendation {
            padding: 15px;
            margin-top: 20px;
            background: rgba(232, 146, 42, 0.15);
            border: 2px solid var(--orange-mid);
            border-radius: 6px;
            text-align: center;
        }
        
        .review-recommendation-label {
            color: var(--gray-light);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        .review-recommendation-value {
            color: var(--orange-light);
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .review-actions-bar {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(204, 110, 31, 0.3);
        }
        
        .review-actions-bar .session-btn {
            flex: 1;
            font-size: 0.85rem;
            padding: 8px 12px;
        }
        
        .loading-spinner {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }
        
        .spinner {
            border: 4px solid rgba(204, 110, 31, 0.2);
            border-top: 4px solid var(--orange-mid);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            margin-top: 20px;
            color: var(--orange-light);
            font-weight: 500;
        }
        
        .deficiency-item {
            background: rgba(220, 53, 69, 0.1);
            border-left: 3px solid #dc3545;
            padding: 12px;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .deficiency-number {
            font-weight: bold;
            color: #dc3545;
            margin-bottom: 6px;
        }
        
        .deficiency-description {
            color: var(--cream);
            margin-bottom: 6px;
        }
        
        .deficiency-meta {
            font-size: 0.8rem;
            color: var(--gray-light);
        }
        
        
        .file-info {
            flex: 1;
            overflow: hidden;
        }
        
        .file-name {
            font-size: 0.8rem;
            color: var(--cream);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .file-meta {
            font-size: 0.65rem;
            color: var(--gray-light);
        }
        
        .file-actions {
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .file-item:hover .file-actions {
            opacity: 1;
        }
        
        .file-action-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: var(--cream);
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 0.65rem;
            cursor: pointer;
        }
        
        .file-action-btn:hover {
            background: var(--orange-mid);
        }
        
        .add-files-btn {
            width: 100%;
            padding: 8px 12px;
            background: linear-gradient(145deg, #d4a574, #b8895a);
            color: #2d1810;
            border: 1px solid #e8b88a;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            box-shadow: 0 2px 0 #8b6b42;
            transition: all 0.1s ease;
            margin-top: 8px;
        }
        
        .add-files-btn:hover {
            background: linear-gradient(145deg, #e8b88a, #d4a574);
            transform: translateY(1px);
            box-shadow: 0 1px 0 #8b6b42;
        }
        
        .empty-state {
            text-align: center;
            padding: 15px;
            color: var(--gray-light);
            font-size: 0.8rem;
        }
        
        /* Project-specific sections */
        .project-tools {
            display: none;
        }
        
        .project-tools.active {
            display: block;
        }
        
        /* Developer mode */
        .dev-mode-only {
            display: none;
        }
        
        body.developer-mode .dev-mode-only {
            display: block;
        }
        
        .dev-toggle {
            width: 100%;
            padding: 12px 18px;
            background: var(--brown-light);
            border: 1px solid var(--orange-dark);
            border-radius: 6px;
            color: var(--cream);
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .dev-toggle:hover {
            background: var(--orange-dark);
        }
        
        .dev-toggle.active {
            background: var(--orange-mid);
            border-color: var(--orange-light);
        }
        
        .dev-badge {
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.6rem;
            background: var(--green-badge);
        }
        
        /* User Guides Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal {
            background: var(--brown-mid);
            border-radius: 12px;
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            color: var(--cream);
            font-size: 1.2rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--gray-light);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-close:hover {
            color: #fff;
        }
        
        .modal-body {
            padding: 20px;
            overflow-y: auto;
            max-height: 60vh;
        }
        
        .search-box {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 6px;
            color: #fff;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .search-box:focus {
            outline: none;
            border-color: var(--orange-mid);
        }
        
        .guide-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .guide-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid var(--orange-dark);
        }
        
        .guide-item:hover {
            background: rgba(0,0,0,0.3);
            border-left-color: var(--orange-light);
        }
        
        .guide-item.hidden {
            display: none;
        }
        
        .guide-name {
            color: var(--cream);
            font-size: 0.9rem;
        }
        
        .guide-btn {
            padding: 6px 12px;
            background: var(--orange-mid);
            border: none;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
            font-size: 0.75rem;
        }
        
        .guide-btn:hover {
            background: var(--orange-light);
        }
        
        /* File browser item with 3 buttons */
        .file-browser-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 6px;
            margin-bottom: 8px;
            border-left: 3px solid var(--orange-dark);
        }
        
        .file-browser-item:hover {
            background: rgba(0,0,0,0.3);
        }
        
        .file-browser-buttons {
            display: flex;
            gap: 8px;
        }
        
        .file-browser-buttons .guide-btn {
            padding: 6px 10px;
            font-size: 0.7rem;
        }
        
        /* Preview pane */
        .preview-pane {
            flex: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            min-height: 180px;
        }
        
        .preview-pane h4 {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray-light);
            margin-bottom: 10px;
        }
        
        .preview-content {
            flex: 1;
            background: rgba(0,0,0,0.3);
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--gray-light);
            font-size: 0.8rem;
            padding: 15px;
            text-align: center;
            overflow: hidden;
        }
        
        .preview-file-icon {
            font-size: 3rem;
            color: var(--orange-light);
            margin-bottom: 10px;
        }
        
        .preview-file-name {
            color: var(--cream);
            font-size: 0.85rem;
            margin-bottom: 5px;
            word-break: break-all;
        }
        
        .preview-file-meta {
            color: var(--gray-light);
            font-size: 0.7rem;
        }
        
        .preview-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        
        .preview-btn {
            flex: 1;
            padding: 8px 12px;
            background: linear-gradient(145deg, #d4a574, #b8895a);
            color: #2d1810;
            border: 1px solid #e8b88a;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            box-shadow: 0 2px 0 #8b6b42;
            transition: all 0.1s ease;
        }
        
        .preview-btn:hover {
            background: linear-gradient(145deg, #e8b88a, #d4a574);
            transform: translateY(1px);
            box-shadow: 0 1px 0 #8b6b42;
        }
        
        .preview-btn.primary {
            background: linear-gradient(145deg, #2d8a4e, #1a5c2a);
            border-color: #28a745;
        }
        
        .preview-btn.primary:hover {
            background: linear-gradient(145deg, #34ce57, #2d8a4e);
        }
        
        /* ============================================
           FILE PICKER MODAL
           ============================================ */
        .file-picker-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .file-picker-container {
            background: var(--brown-dark);
            border-radius: 12px;
            width: 90%;
            max-width: 900px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }
        
        .file-picker-header {
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .file-picker-header h3 {
            color: var(--cream);
            font-size: 1.3rem;
            margin: 0;
        }
        
        .file-picker-header .close-btn {
            background: none;
            border: none;
            color: var(--cream);
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            line-height: 1;
        }
        
        .file-picker-header .close-btn:hover {
            color: var(--orange-light);
        }
        
        .file-picker-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .file-picker-left {
            flex: 1;
            padding: 20px;
            border-right: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .file-picker-right {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .file-picker-actions {
            margin-bottom: 15px;
        }
        
        .picker-btn {
            padding: 12px 20px;
            background: linear-gradient(145deg, var(--orange-mid), var(--orange-dark));
            border: 1px solid var(--orange-light);
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .picker-btn:hover {
            background: linear-gradient(145deg, var(--orange-light), var(--orange-mid));
            transform: translateY(-1px);
        }
        
        .selected-files-list {
            flex: 1;
            overflow-y: auto;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 15px;
        }
        
        .no-files-msg {
            color: var(--gray-light);
            text-align: center;
            padding: 40px 20px;
            font-style: italic;
        }
        
        .selected-file-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .selected-file-item:hover {
            background: rgba(232,146,42,0.1);
            border-color: var(--orange-mid);
        }
        
        .selected-file-item.active {
            background: rgba(232,146,42,0.2);
            border-color: var(--orange-light);
        }
        
        .file-item-info {
            flex: 1;
        }
        
        .file-item-name {
            color: var(--cream);
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .file-item-details {
            color: var(--gray-light);
            font-size: 0.8rem;
        }
        
        .file-item-remove {
            background: rgba(255,0,0,0.2);
            border: 1px solid rgba(255,0,0,0.4);
            color: #ff6b6b;
            padding: 4px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        
        .file-item-remove:hover {
            background: rgba(255,0,0,0.3);
        }
        
        .file-preview-header {
            color: var(--cream);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .file-preview-area {
            flex: 1;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 20px;
            overflow-y: auto;
        }
        
        .no-preview-msg {
            color: var(--gray-light);
            text-align: center;
            padding: 60px 20px;
            font-style: italic;
        }
        
        .file-preview-content {
            color: var(--cream);
        }
        
        .preview-image {
            max-width: 100%;
            border-radius: 6px;
        }
        
        .preview-text {
            font-family: 'Consolas', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        
        .file-picker-footer {
            padding: 20px 25px;
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        .picker-btn-secondary {
            padding: 12px 24px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: var(--cream);
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .picker-btn-secondary:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .picker-btn-primary {
            padding: 12px 24px;
            background: linear-gradient(145deg, #2d8a4e, #1a5c2a);
            border: 1px solid #28a745;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .picker-btn-primary:hover:not(:disabled) {
            background: linear-gradient(145deg, #34ce57, #2d8a4e);
            transform: translateY(-1px);
        }
        
        .picker-btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* ============================================
           FILE BROWSER MODAL
           ============================================ */
        .file-browser-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .file-browser-container {
            background: var(--brown-dark);
            border-radius: 12px;
            width: 90%;
            max-width: 1100px;
            height: 80vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 50px rgba(0,0,0,0.7);
        }
        
        .file-browser-header {
            padding: 20px 25px;
            border-bottom: 2px solid var(--orange-mid);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(232,146,42,0.1);
        }
        
        .file-browser-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .file-browser-title h3 {
            color: var(--orange-light);
            font-size: 1.4rem;
            margin: 0;
            font-weight: 700;
        }
        
        .file-browser-path {
            color: var(--gray-light);
            font-size: 0.85rem;
            margin-top: 4px;
            font-family: 'Consolas', monospace;
        }
        
        .file-browser-close {
            background: none;
            border: none;
            color: var(--cream);
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 35px;
            height: 35px;
            line-height: 1;
            transition: all 0.2s;
        }
        
        .file-browser-close:hover {
            color: var(--orange-light);
            transform: rotate(90deg);
        }
        
        .file-browser-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .file-list-panel {
            flex: 1;
            padding: 20px;
            border-right: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .file-preview-panel {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .file-search {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 6px;
            color: var(--cream);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .file-search:focus {
            outline: none;
            border-color: var(--orange-mid);
        }
        
        .file-list {
            flex: 1;
            overflow-y: auto;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 10px;
        }
        
        .file-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            padding: 12px 15px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .file-item:hover {
            background: rgba(232,146,42,0.15);
            border-color: var(--orange-mid);
            transform: translateX(4px);
        }
        
        .file-item.selected {
            background: rgba(232,146,42,0.25);
            border-color: var(--orange-light);
        }
        
        .file-icon {
            font-size: 1.5rem;
            min-width: 30px;
            text-align: center;
        }
        
        .file-info {
            flex: 1;
        }
        
        .file-name {
            color: var(--cream);
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 0.95rem;
        }
        
        .file-meta {
            color: var(--gray-light);
            font-size: 0.75rem;
            display: flex;
            gap: 15px;
        }
        
        .preview-header {
            color: var(--orange-light);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .preview-content {
            flex: 1;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 20px;
            overflow-y: auto;
        }
        
        .preview-placeholder {
            color: var(--gray-light);
            text-align: center;
            padding: 60px 20px;
            font-style: italic;
        }
        
        .preview-text {
            color: var(--cream);
            font-family: 'Consolas', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            white-space: pre-wrap;
        }
        
        .preview-image {
            max-width: 100%;
            border-radius: 6px;
        }
        
        .preview-metadata {
            color: var(--cream);
            line-height: 1.8;
        }
        
        .preview-metadata strong {
            color: var(--orange-light);
            display: inline-block;
            min-width: 120px;
        }
        
        .file-browser-footer {
            padding: 20px 25px;
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.2);
        }
        
        .file-browser-info {
            color: var(--gray-light);
            font-size: 0.9rem;
        }
        
        .file-browser-actions {
            display: flex;
            gap: 12px;
        }
        
        .fb-btn {
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s;
            border: none;
        }
        
        .fb-btn-view {
            background: linear-gradient(145deg, var(--orange-mid), var(--orange-dark));
            border: 1px solid var(--orange-light);
            color: #fff;
        }
        
        .fb-btn-view:hover:not(:disabled) {
            background: linear-gradient(145deg, var(--orange-light), var(--orange-mid));
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(232,146,42,0.3);
        }
        
        .fb-btn-download {
            background: linear-gradient(145deg, #4a90e2, #357abd);
            border: 1px solid #5fa3ef;
            color: #fff;
        }
        
        .fb-btn-download:hover:not(:disabled) {
            background: linear-gradient(145deg, #5fa3ef, #4a90e2);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74,144,226,0.3);
        }
        
        .fb-btn-upload {
            background: linear-gradient(145deg, #2d8a4e, #1a5c2a);
            border: 1px solid #28a745;
            color: #fff;
        }
        
        .fb-btn-upload:hover:not(:disabled) {
            background: linear-gradient(145deg, #34ce57, #2d8a4e);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(45,138,78,0.3);
        }
        
        .fb-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
    </style>
</head>
<body>
    <!-- SIDEBAR -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h1>TRAJANUS USA</h1>
            <div class="tagline">Engineered Intelligence</div>
            <div class="ei-logo">
                <svg viewBox="0 0 120 80" xmlns="http://www.w3.org/2000/svg">
                    <!-- Orbit 1 (0 degrees) -->
                    <ellipse cx="60" cy="40" rx="28" ry="17.5" 
                        fill="none" stroke="#d4a574" stroke-width="1.5" opacity="0.8"/>
                    
                    <!-- Orbit 2 (120 degrees) -->
                    <ellipse cx="60" cy="40" rx="28" ry="17.5" 
                        fill="none" stroke="#d4a574" stroke-width="1.5" opacity="0.8"
                        transform="rotate(120 60 40)"/>
                    
                    <!-- EI Text -->
                    <text x="60" y="45" 
                        font-family="-apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"
                        font-size="19" 
                        font-weight="500"
                        fill="#e8922a" 
                        text-anchor="middle">EI</text>
                    
                    <!-- Small TM (tight against I) -->
                    <text x="70" y="38" 
                        font-family="-apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"
                        font-size="8" 
                        font-weight="400"
                        fill="#e8922a"></text>
                </svg>
            </div>
            <div class="version">v3.0.0  November 2025</div>
        </div>
        
        <div class="project-section">
            <h3>Projects in Development</h3>
            <button class="project-btn" data-project="enterprise-hub" id="enterpriseHubBtn">
                <span>Enterprise Hub</span>
                <span class="sidebar-badge dev">IN DEVELOPMENT</span>
            </button>
            <button class="project-btn" data-project="website">
                <span>Website Builder</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="pm-toolkit">
                <span>PM Toolkit</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="qcm-toolkit">
                <span>QCM Toolkit</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="route-optimizer">
                <span>Route Optimizer</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="traffic-studies">
                <span>Traffic Studies</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
            <button class="project-btn" data-project="pe-services">
                <span>P.E. Services</span>
                <span class="sidebar-badge dev">BETA ACCESS</span>
            </button>
        </div>
        
        <div class="project-section">
            <h3>Deployed Projects</h3>
            <button class="project-btn" data-project="pm-working">
                <span>PM Toolkit</span>
                <span class="sidebar-badge deployed">v1 ACTIVE</span>
            </button>
            <button class="project-btn" data-project="qcm-working">
                <span>QCM Toolkit</span>
                <span class="sidebar-badge deployed">v1 ACTIVE</span>
            </button>
            <button class="project-btn" data-project="traffic-studies">
                <span>Traffic Studies</span>
                <span class="sidebar-badge deployed">v1 ACTIVE</span>
            </button>
            <button class="project-btn" data-project="pe-services">
                <span>P.E. Services</span>
                <span class="sidebar-badge deployed">v1 ACTIVE</span>
            </button>
        </div>
        
        <!-- Living Documents Quick Access -->
        <div class="quick-access-section">
            <h3>Living Documents</h3>
            <button class="quick-access-btn" onclick="toggleLivingDocsMenu()" id="livingDocsBtn">
                <span>Quick Access</span>
                <span style="float: right;"></span>
            </button>
            <div class="living-docs-menu" id="livingDocsMenu" style="display: none;">
                <button class="living-doc-item" onclick="openLivingDoc('diary')">
                    <div class="btn-label">Daily Diary</div>
                    <div class="btn-description">Personal daily journal</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('journal')">
                    <div class="btn-label">Project Journal</div>
                    <div class="btn-description">Technical project notes</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('protocols')">
                    <div class="btn-label">Core Protocols</div>
                    <div class="btn-description">Operational procedures</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('pov')">
                    <div class="btn-label">Bill's POV</div>
                    <div class="btn-description">Perspective and approach</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('sessions')">
                    <div class="btn-label">Session Summaries</div>
                    <div class="btn-description">Past session handoffs</div>
                </button>
                <button class="living-doc-item" onclick="openLivingDoc('all')">
                    <div class="btn-label">All Living Documents</div>
                    <div class="btn-description">Open main folder</div>
                </button>
            </div>
        </div>
        
        <div class="sidebar-footer">
            <button class="project-btn" onclick="openExternal('https://console.anthropic.com')">
                Anthropic Console
            </button>
            <button class="project-btn" onclick="openExternal('https://drive.google.com')">
                Google Drive
            </button>
        </div>
    </div>
    
    <!-- MAIN CONTENT -->
    <div class="main-content">
        <!-- Header with Clock -->
        <div class="header">
            <div class="header-title">
                <h2 id="projectTitle">Website Builder</h2>
                <div class="breadcrumb">Projects in Development > Website Builder</div>
            </div>
            <div class="clock">
                <div class="clock-left">
                    <div class="clock-date" id="clockDate">30 Nov 2025</div>
                    <div class="clock-time" id="clockTime">00:00:00</div>
                </div>
            </div>
        </div>
        
        <!-- Workspace -->
        <div class="workspace">
            
            <!-- DEVELOPER TOOLKIT PROJECT -->
            <div class="project-tools" data-project="developer-toolkit" style="display: none;">
            
            <div class="section-intro">
                <strong>Developer Toolkit v1.0.0</strong>  Development utilities, learning resources, and code tools
            </div>
            
            <!-- SESSION MANAGEMENT -->
            <div class="tool-section">
                <div class="tool-section-header">Session Management</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Tools for managing AI sessions and handoffs between work periods.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => log('Opening handoff prompt generator...', 'info'))"
                            data-tooltip="Creates detailed context for next Claude session">
                        <div class="btn-label">Mission Brief</div>
                        <div class="btn-description">Generate handoff prompt for new session</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => log('Running memory refresh...', 'info'))"
                            data-tooltip="Loads key protocols into Claude's context">
                        <div class="btn-label">Sync Memory</div>
                        <div class="btn-description">Refresh Claude's memory with key protocols</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => log('Starting EOS routine...', 'warning'))"
                            data-tooltip="Runs full end-of-session protocol with documentation">
                        <div class="btn-label">Perform EOS Protocols</div>
                        <div class="btn-description">Run end-of-session routine and handoff</div>
                    </button>
                </div>
            </div>
            
            <!-- FILE OPERATIONS -->
            <div class="tool-section">
                <div class="tool-section-header">File Operations</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Convert between document formats for compatibility and storage.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => runConversion('md-to-docx'))"
                            data-tooltip="Convert Markdown  Word format">
                        <div class="btn-label">MD to DOCX</div>
                        <div class="btn-description">Convert Markdown files to Word documents</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => runConversion('docx-to-gdocs'))"
                            data-tooltip="Upload Word files to Google Drive">
                        <div class="btn-label">DOCX to Google Docs</div>
                        <div class="btn-description">Upload Word docs to Google Drive</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => runConversion('gdocs-to-docx'))"
                            data-tooltip="Download Google Docs as Word files">
                        <div class="btn-label">Google Docs to DOCX</div>
                        <div class="btn-description">Export Google Docs as Word files</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => runConversion('batch-convert'))"
                            data-tooltip="Process multiple Markdown files at once">
                        <div class="btn-label">Batch Convert MD</div>
                        <div class="btn-description">Convert multiple Markdown files at once</div>
                    </button>
                </div>
            </div>
            
            <!-- QUICK ACCESS -->
            <div class="tool-section">
                <div class="tool-section-header">Quick Access</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Fast navigation to frequently used folders and documents.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => showUserGuides())"
                            data-tooltip="Opens searchable protocol library">
                        <div class="btn-label">User Guides</div>
                        <div class="btn-description">Searchable protocol documents library</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('living-docs'))"
                            data-tooltip="Opens: 02-Living-Documents">
                        <div class="btn-label">Living Documents</div>
                        <div class="btn-description">Active project documentation</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('protocols'))"
                            data-tooltip="Opens: 01-Core-Protocols">
                        <div class="btn-label">Core Protocols</div>
                        <div class="btn-description">Standard operating procedures</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('documentation'))"
                            data-tooltip="Opens: 04-Documentation">
                        <div class="btn-label">Documentation</div>
                        <div class="btn-description">Development reference guides</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('scripts'))"
                            data-tooltip="Opens: 05-Scripts">
                        <div class="btn-label">Scripts</div>
                        <div class="btn-description">Automation and utility scripts</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openLocalFolder('sessions'))"
                            data-tooltip="Opens: 03-Session-Files">
                        <div class="btn-label">Session Files</div>
                        <div class="btn-description">Session summaries and handoffs</div>
                    </button>
                </div>
            </div>
            
            <!-- REFERENCE RESOURCES -->
            <div class="tool-section">
                <div class="tool-section-header">Reference Resources</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Industry standards, building codes, and technical references.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://www.wbdg.org/ffc/dod/unified-facilities-guide-specifications-ufgs'))"
                            data-tooltip="DoD Unified Facilities Guide Specifications">
                        <div class="btn-label">UFGS</div>
                        <div class="btn-description">DoD construction specifications</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://up.codes/'))"
                            data-tooltip="Searchable database of all building codes">
                        <div class="btn-label">UpCodes</div>
                        <div class="btn-description">All codes in one searchable database</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://www.usgs.gov/'))"
                            data-tooltip="U.S. Geological Survey - seismic & soil data">
                        <div class="btn-label">USGS</div>
                        <div class="btn-description">Geological and seismic data</div>
                    </button>
                    <button class="session-btn" 
                            onclick="openExternal('https://www.thesaurus.com')"
                            data-tooltip="Word reference and synonyms">
                        <div class="btn-label">Thesaurus</div>
                        <div class="btn-description">Word reference and synonyms</div>
                    </button>
                </div>
            </div>
            
            <!-- LEARNING RESOURCES -->
            <div class="tool-section">
                <div class="tool-section-header">Learning Resources</div>
                <div class="section-intro" style="margin-top: -10px; margin-bottom: 15px;">
                    Coding tutorials and technical documentation for skill development.
                </div>
                <div class="button-grid">
                    <button class="session-btn" 
                            onclick="devCheck(() => showCodingResources('html'))"
                            data-tooltip="HTML tutorials for beginners">
                        <div class="btn-label">HTML Basics</div>
                        <div class="btn-description">Learn HTML structure and markup</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => showCodingResources('css'))"
                            data-tooltip="CSS styling and layout tutorials">
                        <div class="btn-label">CSS Basics</div>
                        <div class="btn-description">Learn styling and layout</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => showCodingResources('python'))"
                            data-tooltip="Python automation and scripting">
                        <div class="btn-label">Python Basics</div>
                        <div class="btn-description">Learn automation and scripting</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => showCodingResources('javascript'))"
                            data-tooltip="JavaScript for interactivity">
                        <div class="btn-label">JavaScript Basics</div>
                        <div class="btn-description">Learn interactivity and logic</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://www.w3schools.com/'))"
                            data-tooltip="Interactive tutorials for all languages">
                        <div class="btn-label">W3Schools</div>
                        <div class="btn-description">Interactive tutorials for all languages</div>
                    </button>
                    <button class="session-btn" 
                            onclick="devCheck(() => openExternal('https://stackoverflow.com/'))"
                            data-tooltip="Q&A community for programming problems">
                        <div class="btn-label">Stack Overflow</div>
                        <div class="btn-description">Q&A for programming problems</div>
                    </button>
                </div>
            </div>
            
            </div>
            <!-- END DEVELOPER TOOLKIT PROJECT -->
            
            <!-- TRAFFIC STUDIES PROJECT -->
            <div class="project-tools" data-project="traffic-studies" style="display: none;">
                <div class="section-intro">
                    <strong>Traffic Studies v1</strong>  Tools and resources for traffic impact analysis and transportation planning.
                </div>
                
                <div class="tool-section">
                    <div class="tool-section-header">Traffic Analysis Tools</div>
                    <div class="button-grid">
                        <button class="session-btn" onclick="log('Traffic study tools coming soon...', 'info')">
                            <div class="btn-label">Traffic Impact Analysis</div>
                            <div class="btn-description">Analyze traffic patterns and impacts</div>
                        </button>
                        <button class="session-btn" onclick="log('Level of service tools coming soon...', 'info')">
                            <div class="btn-label">Level of Service</div>
                            <div class="btn-description">Calculate intersection LOS ratings</div>
                        </button>
                        <button class="session-btn" onclick="log('Report generator coming soon...', 'info')">
                            <div class="btn-label">Report Generator</div>
                            <div class="btn-description">Create traffic study reports</div>
                        </button>
                    </div>
                </div>
            </div>
            <!-- END TRAFFIC STUDIES PROJECT -->
            
            <!-- P.E. SERVICES PROJECT -->
            <div class="project-tools" data-project="pe-services" style="display: none;">
                <div class="section-intro">
                    <strong>P.E. Services v1.0.0</strong>  Professional engineering plan review and calculation tools
                </div>
                
                <div class="tool-section">
                    <div class="tool-section-header">Engineering Review Tools</div>
                    <div class="button-grid">
                        <button class="session-btn" onclick="log('Plan review tools coming soon...', 'info')">
                            <div class="btn-label">Plan Review</div>
                            <div class="btn-description">Review and markup engineering plans</div>
                        </button>
                        <button class="session-btn" onclick="log('Calculation tools coming soon...', 'info')">
                            <div class="btn-label">Engineering Calculations</div>
                            <div class="btn-description">Perform structural and civil calculations</div>
                        </button>
                        <button class="session-btn" onclick="log('Stamp tools coming soon...', 'info')">
                            <div class="btn-label">PE Stamp Manager</div>
                            <div class="btn-description">Manage professional engineer stamps</div>
                        </button>
                    </div>
                </div>
            </div>
            <!-- END P.E. SERVICES PROJECT -->
            
            <!-- PROJECT-SPECIFIC TOOLS -->
            
            <!-- Enterprise Hub Tools -->
            <div class="tool-section project-tools" data-project="enterprise-hub" style="display: none;">
            
            <div class="section-intro">
                <strong>Enterprise Hub v3.3.0</strong>  Central command for file management, developer tools, and system operations
            </div>
            
            <div class="tool-section-header">Quick Access Tools</div>
            <div class="button-grid">
                <button class="session-btn" onclick="openExternal('https://drive.google.com/drive/folders/FOLDER_ID_NEEDED')">
                    <div class="btn-label">Google Drive Root</div>
                    <div class="btn-description">Open main Drive folder</div>
                </button>
                <button class="session-btn" onclick="openExternal('https://claude.ai')">
                    <div class="btn-label">Claude AI</div>
                    <div class="btn-description">Open Claude interface</div>
                </button>
                <button class="session-btn" onclick="openExternal('https://console.anthropic.com')">
                    <div class="btn-label">Anthropic Console</div>
                    <div class="btn-description">API keys and usage</div>
                </button>
                <button class="session-btn" onclick="launchApp('vscode')">
                    <div class="btn-label">VS Code</div>
                    <div class="btn-description">Launch code editor</div>
                </button>
            </div>
            
            </div>
            
            <!-- PM Toolkit Tools -->
            <div class="tool-section project-tools" data-project="pm-toolkit">
                <div class="section-intro">
                    <strong>PM Toolkit v1.0.0</strong>  Comprehensive project management suite for construction oversight
                </div>
                <div class="tool-section-header">PM Toolkit Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="openLivingDocsBrowser()" style="background: linear-gradient(180deg, #9B7E52 0%, #7B6142 100%); font-weight: 600; grid-column: span 2;" title="Access all session summaries, daily journals, and protocol documents by date. Search, view, copy, and download any living document from the project history.">Living Documents Browser</button>
                    <div style="font-size: 0.85rem; color: #999; margin-top: -5px; margin-bottom: 10px; grid-column: span 2; text-align: center;">View session summaries and protocols by date</div>
                    <button class="session-btn" onclick="log('Schedule analysis tools under development...', 'info')">Schedule Navigator</button>
                    <button class="session-btn" onclick="log('Budget tracking tools under development...', 'info')">Budget Tracker</button>
                </div>
            </div>
            
            <!-- QCM Toolkit Tools -->
            <div class="tool-section project-tools" data-project="qcm-toolkit">
                <div class="section-intro">
                    <strong>QCM Toolkit v1.0.0</strong>  Quality control and inspection management system
                </div>
                <div class="tool-section-header">QCM Toolkit Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="openLivingDocsBrowser()" style="grid-column: span 2;" title="Access all session summaries, daily journals, and protocol documents by date. Search, view, copy, and download any living document from the project history.">Living Documents Browser</button>
                    <div style="font-size: 0.85rem; color: #999; margin-top: -5px; margin-bottom: 10px; grid-column: span 2; text-align: center;">View session summaries and protocols by date</div>
                    <button class="session-btn" onclick="openQCMWorkspace()">Submittal Review</button>
                    <button class="session-btn" onclick="openFileManager()">Add Project Files</button>
                </div>
            </div>
            
            
            <!-- Website Builder Tools -->
            <div class="tool-section project-tools active" data-project="website">
                <div class="section-intro">
                    <strong>Website Builder v1.0.0</strong>  Professional website development and content management tools
                </div>
                <div class="tool-section-header">Website Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="openLivingDocsBrowser()" style="background: linear-gradient(180deg, #9B7E52 0%, #7B6142 100%); font-weight: 600; grid-column: span 2;" title="Access all session summaries, daily journals, and protocol documents by date. Search, view, copy, and download any living document from the project history.">Living Documents Browser</button>
                    <div style="font-size: 0.85rem; color: #999; margin-top: -5px; margin-bottom: 10px; grid-column: span 2; text-align: center;">View session summaries and protocols by date</div>
                    <button class="session-btn" onclick="openExternal('https://trajanus-usa.com')">View Live Site</button>
                    <button class="session-btn" onclick="log('Content management tools under development...', 'info')">Content Editor</button>
                </div>
            </div>
            
            <!-- PM/QCM Working (Deployed) - Minimal tools -->
            <div class="tool-section project-tools" data-project="pm-working">
                <div class="section-intro">
                    <strong>PM Toolkit v2.1.3</strong>  Production: Managing 3 active projects - Guatemala SOUTHCOM, Fort Liberty, Fort Campbell
                </div>
                <div class="tool-section-header">PM Working - Active Contract</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="openLivingDocsBrowser()" style="background: linear-gradient(180deg, #9B7E52 0%, #7B6142 100%); font-weight: 600; grid-column: span 2;" title="Access all session summaries, daily journals, and protocol documents by date. Search, view, copy, and download any living document from the project history.">Living Documents Browser</button>
                    <div style="font-size: 0.85rem; color: #999; margin-top: -5px; margin-bottom: 10px; grid-column: span 2; text-align: center;">View session summaries and protocols by date</div>
                    <button class="session-btn" onclick="log('Accessing daily reports...', 'info')">Daily Reports</button>
                    <button class="session-btn" onclick="log('Accessing invoices...', 'info')">Invoices</button>
                </div>
            </div>
            
            <div class="tool-section project-tools" data-project="qcm-working">
                <div class="section-intro">
                    <strong>QCM Toolkit v2.0.5</strong>  Production: Active quality control on 2 DoD projects
                </div>
                <div class="tool-section-header">QCM Working - Active Contract</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="openLivingDocsBrowser()" style="background: linear-gradient(180deg, #9B7E52 0%, #7B6142 100%); font-weight: 600; grid-column: span 2;" title="Access all session summaries, daily journals, and protocol documents by date. Search, view, copy, and download any living document from the project history.">Living Documents Browser</button>
                    <div style="font-size: 0.85rem; color: #999; margin-top: -5px; margin-bottom: 10px; grid-column: span 2; text-align: center;">View session summaries and protocols by date</div>
                    <button class="session-btn" onclick="log('Accessing inspection logs...', 'info')">Inspection Logs</button>
                    <button class="session-btn" onclick="log('Accessing test results...', 'info')">Test Results</button>
                </div>
            </div>
            
            <!-- Route Optimizer Tools -->
            <div class="tool-section project-tools" data-project="route-optimizer">
                <div class="section-intro">
                    <strong>Route Optimizer v1.0.0</strong>  Transportation planning and route optimization algorithms
                </div>
                <div class="tool-section-header">Route Optimizer Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="openLivingDocsBrowser()" style="background: linear-gradient(180deg, #9B7E52 0%, #7B6142 100%); font-weight: 600; grid-column: span 2;" title="Access all session summaries, daily journals, and protocol documents by date. Search, view, copy, and download any living document from the project history.">Living Documents Browser</button>
                    <div style="font-size: 0.85rem; color: #999; margin-top: -5px; margin-bottom: 10px; grid-column: span 2; text-align: center;">View session summaries and protocols by date</div>
                    <button class="session-btn" onclick="log('Route optimization tools under development...', 'info')">Route Planner</button>
                    <button class="session-btn" onclick="log('TSP solver tools under development...', 'info')">TSP Solver</button>
                </div>
            </div>
            
            <!-- Traffic Studies Tools -->
            <div class="tool-section project-tools" data-project="traffic-studies">
                <div class="section-intro">
                    <strong>Traffic Studies v1.5.0</strong>  Production: Completed 12 studies, 3 in review
                </div>
                <div class="tool-section-header">Traffic Studies Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="openLivingDocsBrowser()" style="grid-column: span 2;" title="Access all session summaries, daily journals, and protocol documents by date. Search, view, copy, and download any living document from the project history.">Living Documents Browser</button>
                    <div style="font-size: 0.85rem; color: #999; margin-top: -5px; margin-bottom: 10px; grid-column: span 2; text-align: center;">View session summaries and protocols by date</div>
                    <button class="session-btn" onclick="openOperationalWorkspace('traffic-studies')">Open Traffic Workspace</button>
                </div>
            </div>
            
            <!-- P.E. Services Tools -->
            <div class="tool-section project-tools" data-project="pe-services">
                <div class="section-intro">
                    <strong>P.E. Services v1.3.1</strong>  Production: Professional stamp and review services active
                </div>
                <div class="tool-section-header">P.E. Services Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="openLivingDocsBrowser()" style="grid-column: span 2;" title="Access all session summaries, daily journals, and protocol documents by date. Search, view, copy, and download any living document from the project history.">Living Documents Browser</button>
                    <div style="font-size: 0.85rem; color: #999; margin-top: -5px; margin-bottom: 10px; grid-column: span 2; text-align: center;">View session summaries and protocols by date</div>
                    <button class="session-btn" onclick="openOperationalWorkspace('pe-legal-opinion')">Legal Opinion</button>
                    <button class="session-btn" onclick="openOperationalWorkspace('pe-review-stamp')">PE Review & Stamp</button>
                </div>
            </div>
            
            <!-- Memory/Recall Tools -->
            <div class="tool-section project-tools" data-project="memory">
                <div class="section-intro">
                    <strong>Memory/Recall v1.0.0</strong>  AI memory management and protocol automation
                </div>
                <div class="tool-section-header">Memory/Recall Tools</div>
                <div class="button-grid">
                    <button class="session-btn" onclick="openLivingDocsBrowser()" style="background: linear-gradient(180deg, #9B7E52 0%, #7B6142 100%); font-weight: 600; grid-column: span 2;" title="Access all session summaries, daily journals, and protocol documents by date. Search, view, copy, and download any living document from the project history.">Living Documents Browser</button>
                    <div style="font-size: 0.85rem; color: #999; margin-top: -5px; margin-bottom: 10px; grid-column: span 2; text-align: center;">View session summaries and protocols by date</div>
                    <button class="session-btn" onclick="log('Protocol management tools under development...', 'info')">Protocols</button>
                </div>
            </div>
            
            <!-- Terminal -->
            <div class="terminal">
                <div class="terminal-header">
                    <!-- PERMANENT TABS (LEFT SIDE) -->
                    <button class="terminal-tab permanent-tab active" data-tab="devtools" onclick="switchTab('devtools')" title="Session management, file operations, and dev utilities">
                        Developer Tools
                    </button>
                    <button class="terminal-tab permanent-tab" data-tab="codes" onclick="switchTab('codes')" title="Project management and quality control tools">
                        Codes and Standards
                    </button>
                    <button class="terminal-tab permanent-tab" data-tab="external" onclick="switchTab('external')" title="Third-party platforms and web resources">
                        External Programs
                    </button>
                    <!-- DYNAMIC TERMINAL TABS (RIGHT SIDE) -->
                    <div class="terminal-tabs" id="terminalTabs">
                        <!-- Terminal tab hidden but functional -->
                        <button class="terminal-tab active" data-tab="main" onclick="switchTab('main')" style="display: none;">
                            Terminal <span class="close-tab" onclick="closeTab(event, 'main')"></span>
                        </button>
                    </div>
                    <button class="terminal-tab-add" onclick="addTab()" title="New Terminal">+</button>
                    <div class="terminal-actions">
                        <button class="terminal-clear" onclick="clearTerminal()">Clear</button>
                    </div>
                </div>
                <div class="terminal-bodies" id="terminalBodies">
                    <div class="terminal-body" id="terminal-main" data-tab="main" style="display: none;">
                        <div class="success">[Ready] Trajanus Enterprise Hub v3.3.0 initialized</div>
                        <div class="info">[Ready] All systems online</div>
                    </div>
                    <!-- PERMANENT DEVELOPER TERMINAL -->
                    <div class="terminal-body active" id="terminal-devtools" data-tab="devtools">
                        <div class="success">[Ready] Developer Tools Terminal</div>
                        <div class="info">[Info] File management, session tools, and operations</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">FILE MANAGEMENT</div>
                            <button class="session-btn" onclick="openFileBrowser('living-docs')" style="margin: 4px;">Living Documents</button>
                            <button class="session-btn" onclick="openFileBrowser('sessions')" style="margin: 4px;">Session Library</button>
                            <button class="session-btn" onclick="openFileBrowser('templates')" style="margin: 4px;">Templates</button>
                            <button class="session-btn" onclick="openFileBrowser('command-center')" style="margin: 4px;">Command Center</button>
                            <button class="session-btn" onclick="openFileBrowser('protocols')" style="margin: 4px;">Core Protocols</button>
                            <button class="session-btn" onclick="openFileBrowser('learning')" style="margin: 4px;">Learning Folder</button>
                            <button class="session-btn" onclick="openFileBrowser('scripts')" style="margin: 4px;">Scripts</button>
                            <button class="session-btn" onclick="openFileBrowser('documentation')" style="margin: 4px;">Documentation</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">SESSION MANAGEMENT</div>
                            <button class="session-btn" onclick="log('Opening handoff prompt generator...', 'info', 'devtools')" style="margin: 4px;">Mission Brief</button>
                            <button class="session-btn" onclick="openProtocolFile('sync')" style="margin: 4px;" title="Review all 47 operational protocols">Sync Protocols</button>
                            <button class="session-btn" onclick="openProtocolFile('deepdive')" style="margin: 4px;" title="Load Bill's POV and full context">Deep Dive Recall</button>
                            <button class="session-btn" onclick="log('Starting EOS routine...', 'warning', 'devtools')" style="margin: 4px;">Perform EOS Protocols</button>
                            <button class="session-btn" onclick="log('Update living docs - Coming soon', 'info', 'devtools')" style="margin: 4px;">Update Living Docs</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">FILE OPERATIONS</div>
                            <button class="session-btn" onclick="runConversion('md-to-docx')" style="margin: 4px;">MD to DOCX</button>
                            <button class="session-btn" onclick="runConversion('docx-to-gdocs')" style="margin: 4px;">DOCX to Google Docs</button>
                            <button class="session-btn" onclick="runConversion('gdocs-to-docx')" style="margin: 4px;">Google Docs to DOCX</button>
                            <button class="session-btn" onclick="runConversion('convert-latest')" style="margin: 4px;" title="Convert files modified in last 24 hours">Convert Latest (24hrs)</button>
                            <button class="session-btn" onclick="runConversion('convert-all')" style="margin: 4px;" title="Convert all markdown files to Google Docs">Convert All Files</button>
                        </div>
                    </div>
                    <!-- MS OFFICE TOOLS TERMINAL -->
                    <div class="terminal-body" id="terminal-msoffice" data-tab="msoffice">
                        <div class="success">[Ready] MS Office Tools & Templates</div>
                        <div class="info">[Info] Microsoft Office, templates, and document generation</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">MS OFFICE</div>
                            <button class="session-btn" onclick="log('Opening Word...', 'info', 'msoffice')" style="margin: 4px;">Word</button>
                            <button class="session-btn" onclick="log('Opening Excel...', 'info', 'msoffice')" style="margin: 4px;">Excel</button>
                            <button class="session-btn" onclick="log('Opening PowerPoint...', 'info', 'msoffice')" style="margin: 4px;">PowerPoint</button>
                            <button class="session-btn" onclick="log('Opening Outlook...', 'info', 'msoffice')" style="margin: 4px;">Outlook</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">TEMPLATES</div>
                            <button class="session-btn" onclick="log('Opening QCM template...', 'info', 'msoffice')" style="margin: 4px;">QCM Submittal Review</button>
                            <button class="session-btn" onclick="log('Opening daily journal...', 'info', 'msoffice')" style="margin: 4px;">Daily Journal</button>
                            <button class="session-btn" onclick="log('Opening schedule narrative...', 'info', 'msoffice')" style="margin: 4px;">Schedule Narrative</button>
                            <button class="session-btn" onclick="log('Opening meeting minutes...', 'info', 'msoffice')" style="margin: 4px;">Meeting Minutes</button>
                        </div>
                    </div>
                    <!-- CODES AND STANDARDS TERMINAL -->
                    <div class="terminal-body" id="terminal-codes" data-tab="codes">
                        <div class="success">[Ready] Codes and Standards Tools</div>
                        <div class="info">[Info] Project-specific tools and utilities</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">PM TOOLS</div>
                            <button class="session-btn" onclick="log('Opening schedule navigator...', 'info', 'codes')" style="margin: 4px;">Schedule Navigator</button>
                            <button class="session-btn" onclick="log('Opening budget tracker...', 'info', 'codes')" style="margin: 4px;">Budget Tracker</button>
                            <button class="session-btn" onclick="log('Opening RFI manager...', 'info', 'codes')" style="margin: 4px;">RFI Manager</button>
                            <button class="session-btn" onclick="log('Opening change orders...', 'info', 'codes')" style="margin: 4px;">Change Orders</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">QCM TOOLS</div>
                            <button class="session-btn" onclick="log('Opening submittal review...', 'info', 'codes')" style="margin: 4px;">Submittal Review</button>
                            <button class="session-btn" onclick="log('Opening inspection reports...', 'info', 'codes')" style="margin: 4px;">Inspection Reports</button>
                            <button class="session-btn" onclick="log('Opening deficiency tracker...', 'info', 'codes')" style="margin: 4px;">Deficiency Tracker</button>
                            <button class="session-btn" onclick="log('Opening closeout checklist...', 'info', 'codes')" style="margin: 4px;">Closeout Checklist</button>
                        </div>
                    </div>
                    <!-- PERMANENT EXTERNAL TERMINAL -->
                    <div class="terminal-body" id="terminal-external" data-tab="external">
                        <div class="success">[Ready] External Resources</div>
                        <div class="info">[Info] Third-party platforms and web resources</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">PLATFORMS</div>
                            <button class="session-btn" onclick="log('Opening Procore...', 'info', 'external')" style="margin: 4px;">Procore</button>
                            <button class="session-btn" onclick="log('Opening Primavera P6...', 'info', 'external')" style="margin: 4px;">Primavera P6</button>
                            <button class="session-btn" onclick="log('Opening RMS 3.0...', 'info', 'external')" style="margin: 4px;">RMS 3.0</button>
                            <button class="session-btn" onclick="log('Opening USACE site...', 'info', 'external')" style="margin: 4px;">USACE Portal</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">WEB RESOURCES</div>
                            <button class="session-btn" onclick="openExternal('https://drive.google.com/drive/folders/1ngKnGqz8YvHG5yzKPG6qVxSdPzqXHVJB')" style="margin: 4px;">Google Drive Root</button>
                            <button class="session-btn" onclick="openExternal('https://console.anthropic.com')" style="margin: 4px;">Anthropic Console</button>
                            <button class="session-btn" onclick="log('Opening Claude AI...', 'info', 'external')" style="margin: 4px;">Claude AI</button>
                            <button class="session-btn" onclick="log('Opening VS Code...', 'info', 'external')" style="margin: 4px;">VS Code</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">UTILITIES</div>
                            <button class="session-btn" onclick="showUserGuides()" style="margin: 4px;">User Guides</button>
                            <button class="session-btn" onclick="openExternal('https://www.thesaurus.com')" style="margin: 4px;">Thesaurus</button>
                        </div>
                    </div>
                    
                    <!-- REVIEW HISTORY TERMINAL -->
                    <div class="terminal-body" id="terminal-review-history" data-tab="review-history" style="display: none;">
                        <div class="success">[Ready] QCM Review History</div>
                        <div class="info">[Info] Past submittal reviews and analysis reports</div>
                        <div style="margin-top: 15px;" id="reviewHistoryList">
                            <div class="info" style="padding: 20px; text-align: center;">
                                No review history yet. Complete a submittal review to see it here.
                            </div>
                        </div>
                    </div>
                    
                    <!-- PERMANENT REFERENCE TERMINAL -->
                    <div class="terminal-body" id="terminal-reference" data-tab="reference">
                        <div class="success">[Ready] Reference Library</div>
                        <div class="info">[Info] Protocols, documentation, and learning resources</div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">PROTOCOLS</div>
                            <button class="session-btn" onclick="log('Opening operational protocols...', 'info', 'reference')" style="margin: 4px;">Operational Protocols</button>
                            <button class="session-btn" onclick="log('Opening Bill POV...', 'info', 'reference')" style="margin: 4px;">Bill POV</button>
                            <button class="session-btn" onclick="log('Opening commandments...', 'info', 'reference')" style="margin: 4px;">AI Commandments</button>
                            <button class="session-btn" onclick="log('Opening file structure...', 'info', 'reference')" style="margin: 4px;">File Structure Map</button>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background: rgba(168, 90, 27, 0.1); border-left: 3px solid #cc6e1f;">
                            <div style="color: #e8922a; font-weight: bold; margin-bottom: 8px;">LEARNING</div>
                            <button class="session-btn" onclick="log('Opening Python guide...', 'info', 'reference')" style="margin: 4px;">Python Resources</button>
                            <button class="session-btn" onclick="log('Opening JavaScript guide...', 'info', 'reference')" style="margin: 4px;">JavaScript Resources</button>
                            <button class="session-btn" onclick="log('Opening Electron docs...', 'info', 'reference')" style="margin: 4px;">Electron Docs</button>
                        </div>
                    </div>
                    
                    <!-- QCM SUBMITTAL REVIEW WORKSPACE -->
                    <div class="terminal-body qcm-workspace-container" id="terminal-qcm-submittal" data-tab="qcm-submittal" style="display: none;">
                        <div class="qcm-workspace-header">
                            <div class="success">[Ready] QCM Submittal Review Workspace</div>
                            <div class="info">[Info] Interactive workspace for document review with Trajanus EI</div>
                        </div>
                        
                        <div class="qcm-workspace">
                            <!-- Panel 1: Document Browser -->
                            <div class="qcm-panel qcm-file-browser">
                                <div class="panel-header">Document Browser</div>
                                <div class="breadcrumb" id="qcmBreadcrumb">
                                    <span class="breadcrumb-item">My Drive</span>
                                </div>
                                <div class="file-list" id="qcmFiles">
                                    <div class="info" style="padding: 20px; text-align: center;">
                                        Navigate to your project folder to select documents
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Panel 2: Report Templates -->
                            <div class="qcm-panel">
                                <div class="panel-header">Report Templates</div>
                                <div style="overflow-y: auto; flex: 1;">
                                    <div style="margin-bottom: 15px;">
                                        <div style="color: var(--orange-light); font-weight: 600; margin-bottom: 8px; padding: 8px; background: rgba(232,146,42,0.1); border-left: 3px solid var(--orange-light);">QCM Reports</div>
                                        <div style="display: flex; flex-direction: column; gap: 6px; padding: 0 10px;">
                                            <div class="report-item" onclick="selectReport('qcm-submittal')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Submittal Review Report</div>
                                            <div class="report-item" onclick="selectReport('qcm-inspection')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Daily Inspection Report</div>
                                            <div class="report-item" onclick="selectReport('qcm-deficiency')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Deficiency Log</div>
                                            <div class="report-item" onclick="selectReport('qcm-material')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Material Testing Report</div>
                                        </div>
                                    </div>
                                    <div style="margin-bottom: 15px;">
                                        <div style="color: var(--orange-light); font-weight: 600; margin-bottom: 8px; padding: 8px; background: rgba(232,146,42,0.1); border-left: 3px solid var(--orange-light);">Progress Reports</div>
                                        <div style="display: flex; flex-direction: column; gap: 6px; padding: 0 10px;">
                                            <div class="report-item" onclick="selectReport('progress-weekly')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Weekly Progress Report</div>
                                            <div class="report-item" onclick="selectReport('progress-monthly')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Monthly Status Report</div>
                                            <div class="report-item" onclick="selectReport('progress-milestone')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Milestone Completion</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div style="color: var(--orange-light); font-weight: 600; margin-bottom: 8px; padding: 8px; background: rgba(232,146,42,0.1); border-left: 3px solid var(--orange-light);">Compliance Documents</div>
                                        <div style="display: flex; flex-direction: column; gap: 6px; padding: 0 10px;">
                                            <div class="report-item" onclick="selectReport('compliance-rfi')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">RFI Response</div>
                                            <div class="report-item" onclick="selectReport('compliance-change')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Change Order Summary</div>
                                            <div class="report-item" onclick="selectReport('compliance-close')" style="padding: 10px; background: rgba(31,20,16,0.6); border: 1px solid rgba(204,110,31,0.3); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Closeout Documentation</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Panel 3: Trajanus EI -->
                            <div class="qcm-panel">
                                <div class="panel-header">Trajanus EI</div>
                                <div class="review-status waiting" id="qcmReviewStatus">WAITING</div>
                                <div class="review-content" id="qcmReviewContent" style="flex: 1; overflow-y: auto;">
                                    <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center; height: 100%;">
                                        <div style="font-size: 3rem; margin-bottom: 20px;"></div>
                                        <div style="font-size: 1.1rem; color: var(--orange-light); font-weight: 500; margin-bottom: 10px;">
                                            Trajanus EI Interface
                                        </div>
                                        <div style="font-size: 0.9rem; color: #fff; line-height: 1.6;">
                                            Select documents and choose a report template, then click<br>
                                            <strong>"Send to Trajanus for Review"</strong><br>
                                            to see detailed analysis results here.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="qcm-actions">
                            <button class="session-btn qcm-primary" onclick="sendToClaudeReview()">
                                Send to Trajanus for Review
                            </button>
                            <button class="session-btn" onclick="saveQCMSetup()">
                                Save Setup
                            </button>
                            <button class="session-btn" onclick="loadQCMSetup()">
                                 Load Saved Setup
                            </button>
                            <button class="session-btn" onclick="clearQCMWorkspace()">
                                Clear Workspace
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <span class="status-dot"></span>
                <span>System Ready</span>
            </div>
            <div class="status-item">
                <span id="platform">Platform: Loading...</span>
            </div>
            <div class="status-item">
                <span>v2.0.0</span>
            </div>
        </div>
    </div>
    
    <!-- RIGHT PANEL - PROJECT FILES -->
    <div class="right-panel">
        <div class="right-panel-header">
            <h3>Project Files</h3>
        </div>
        
        <div class="panel-section">
            <h4>Working Files</h4>
            <div class="file-list" id="workingFilesList">
                <div class="empty-state">No files yet</div>
            </div>
            <button class="add-files-btn" onclick="addFiles()">+ Add Files</button>
        </div>
        
        <div class="panel-section">
            <h4>Completed</h4>
            <div class="file-list" id="completedFilesList">
                <div class="empty-state">No completed files</div>
            </div>
        </div>
        
        <div class="preview-pane">
            <h4>Preview</h4>
            <div class="preview-content" id="previewContent">
                <div class="preview-file-icon"><i class="fas fa-file"></i></div>
                <div>Select a file to preview</div>
            </div>
            <div class="preview-actions" id="previewActions" style="display: none;">
                <button class="preview-btn" onclick="viewSelectedFile()" title="Open file in default application">
                    <i class="fas fa-eye"></i> View
                </button>
                <button class="preview-btn" onclick="openFileLocation()" title="Open file location in Explorer">
                    <i class="fas fa-folder-open"></i> Open Folder
                </button>
                <button class="preview-btn primary" onclick="moveToCompleted(selectedFile.index)" title="Mark as complete">
                    <i class="fas fa-check"></i> Complete
                </button>
            </div>
        </div>
    </div>
    
    <!-- USER GUIDES MODAL -->
    <div class="modal-overlay" id="userGuidesModal" onclick="closeUserGuides(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2> User Guides & Documentation</h2>
                <button class="modal-close" onclick="hideUserGuides()"></button>
            </div>
            <div class="modal-body">
                <input type="text" class="search-box" id="guideSearch" placeholder="Search guides..." onkeyup="filterGuides()">
                <div class="guide-list" id="guideList"></div>
            </div>
        </div>
    </div>
    
    <!-- LIVING DOCUMENTS MODAL -->
    <div class="modal-overlay" id="livingDocsModal" onclick="closeLivingDocs(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2> Living Documents</h2>
                <button class="modal-close" onclick="hideLivingDocs()"></button>
            </div>
            <div class="modal-body">
                <div class="guide-list" id="livingDocsList"></div>
            </div>
        </div>
    </div>
    
    <!-- UNIVERSAL FILE BROWSER MODAL -->
    <div class="modal-overlay" id="fileBrowserModal" onclick="closeFileBrowser(event)">
        <div class="modal" onclick="event.stopPropagation()" style="max-width: 900px;">
            <div class="modal-header">
                <h2 id="fileBrowserTitle"> Files</h2>
                <button class="modal-close" onclick="hideFileBrowser()"></button>
            </div>
            <div class="modal-body">
                <input type="text" class="search-box" id="fileBrowserSearch" placeholder="Search files..." onkeyup="filterBrowserFiles()">
                <div class="guide-list" id="fileBrowserList"></div>
            </div>
        </div>
    </div>
    
    <!-- CODING RESOURCES MODAL -->
    <div class="modal-overlay" id="codingResourcesModal" onclick="closeCodingResources(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 id="codingModalTitle"> Coding Resources</h2>
                <button class="modal-close" onclick="hideCodingResources()"></button>
            </div>
            <div class="modal-body">
                <div id="codingResourcesList"></div>
            </div>
        </div>
    </div>
    
    <!-- Enhanced File Picker Modal -->
    <div class="file-picker-modal" id="filePickerModal" style="display: none;">
        <div class="file-picker-container">
            <div class="file-picker-header">
                <h3>Add Files to Project</h3>
                <button class="close-btn" onclick="closeFilePicker()"></button>
            </div>
            <div class="file-picker-body">
                <div class="file-picker-left">
                    <div class="file-picker-actions">
                        <button class="picker-btn" onclick="triggerNativeFilePicker()">
                            Browse Files
                        </button>
                        <input type="file" id="nativeFilePicker" multiple style="display: none;" onchange="handleFileSelection(event)">
                    </div>
                    <div class="selected-files-list" id="selectedFilesList">
                        <div class="no-files-msg">No files selected</div>
                    </div>
                </div>
                <div class="file-picker-right">
                    <div class="file-preview-header">Preview</div>
                    <div class="file-preview-area" id="filePreviewArea">
                        <div class="no-preview-msg">Select a file to preview</div>
                    </div>
                </div>
            </div>
            <div class="file-picker-footer">
                <button class="picker-btn-secondary" onclick="closeFilePicker()">Cancel</button>
                <button class="picker-btn-primary" onclick="addSelectedFiles()" id="addFilesBtn" disabled>
                    Add <span id="fileCount">0</span> File(s)
                </button>
            </div>
        </div>
    </div>
    
    <!-- File Browser Modal -->
    <script>
        // ============================================
        // GLOBAL UTILITY FUNCTIONS (MUST BE FIRST!)
        // ============================================
        
        // Log function - needs to be global for onclick handlers
        window.log = function(message, type = 'info', tabId = null) {
            const terminal = tabId ? document.getElementById(`terminal-${tabId}`) : 
                             document.querySelector('.terminal-content[style*="display: block"]') ||
                             document.querySelector('.terminal-content');
            if (!terminal) {
                console.log(`[${type}] ${message}`);
                return;
            }
            const line = document.createElement('div');
            line.className = type;
            const timestamp = new Date().toLocaleTimeString('en-US', { hour12: false });
            line.textContent = `[${timestamp}] ${message}`;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        };
        
        // Clear terminal - needs to be global for onclick handlers
        window.clearTerminal = function() {
            const terminal = document.querySelector('.terminal-content[style*="display: block"]') ||
                           document.querySelector('.terminal-content');
            if (terminal) {
                terminal.innerHTML = '<div class="info">[Cleared] Terminal cleared</div>';
            }
        };
        
        // ============================================
        // CLOCK & SESSION TIMER
        // ============================================
        
        function updateClock() {
            const now = new Date();
            
            // Format date
            const day = now.getDate();
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const month = months[now.getMonth()];
            const year = now.getFullYear();
            document.getElementById('clockDate').textContent = `${day} ${month} ${year}`;
            
            // Format time
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            document.getElementById('clockTime').textContent = `${hours}:${minutes}:${seconds}`;
        }
        
        // ============================================
        // APP LAUNCHERS (PROVEN TO WORK)
        // ============================================
        const appPaths = {
            word: 'start winword',
            excel: 'start excel',
            powerpoint: 'start powerpnt',
            outlook: 'start outlook',
            vscode: 'code',
            notepad: 'notepad',
            powershell: 'start powershell'
        };
        
        async function launchApp(appName) {
            const appPath = appPaths[appName];
            if (!appPath) {
                log(`App not found: ${appName}`, 'error');
                return;
            }
            
            log(`Launching ${appName}...`, 'info');
            
            if (window.electronAPI) {
                try {
                    await window.electronAPI.runCommand(appPath);
                    log(`Launched: ${appName}`, 'success');
                } catch (err) {
                    log(` Error launching ${appName}: ${err.message}`, 'error');
                }
            } else {
                log(' Must run in Electron app', 'error');
            }
        }
        
        // ============================================
        // TERMINAL TABS
        // ============================================
        let activeTab = 'devtools';
        let tabCounter = 1;
        
        function getActiveTerminal() {
            return document.getElementById(`terminal-${activeTab}`);
        }
        
        function switchTab(tabId) {
            // Update tab buttons
            document.querySelectorAll('.terminal-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.tab === tabId) tab.classList.add('active');
            });
            
            // Update terminal bodies
            document.querySelectorAll('.terminal-body').forEach(body => {
                body.classList.remove('active');
            });
            document.getElementById(`terminal-${tabId}`).classList.add('active');
            
            activeTab = tabId;
        }
        
        function addTab(name = null) {
            tabCounter++;
            const tabId = `tab-${tabCounter}`;
            const tabName = name || `Terminal ${tabCounter}`;
            
            // Create tab button
            const tabBtn = document.createElement('button');
            tabBtn.className = 'terminal-tab';
            tabBtn.dataset.tab = tabId;
            tabBtn.onclick = () => switchTab(tabId);
            tabBtn.innerHTML = `${tabName} <span class="close-tab" onclick="closeTab(event, '${tabId}')"></span>`;
            document.getElementById('terminalTabs').appendChild(tabBtn);
            
            // Create terminal body
            const termBody = document.createElement('div');
            termBody.className = 'terminal-body';
            termBody.id = `terminal-${tabId}`;
            termBody.dataset.tab = tabId;
            termBody.innerHTML = `<div class="info">[Ready] New terminal opened</div>`;
            document.getElementById('terminalBodies').appendChild(termBody);
            
            // Switch to new tab
            switchTab(tabId);
            
            return tabId;
        }
        
        function closeTab(event, tabId) {
            event.stopPropagation();
            
            // Never allow closing permanent tabs or main tab
            const permanentTabs = ['devtools', 'codes', 'external', 'main'];
            if (permanentTabs.includes(tabId)) {
                log('Permanent tabs cannot be closed', 'warning', tabId);
                return;
            }
            
            const tabs = document.querySelectorAll('.terminal-tab');
            if (tabs.length <= 6) return; // Don't close if only main + 5 permanent tabs remain
            
            // Remove tab button and body
            document.querySelector(`.terminal-tab[data-tab="${tabId}"]`).remove();
            document.getElementById(`terminal-${tabId}`).remove();
            
            // If closing active tab, switch to first remaining tab
            if (activeTab === tabId) {
                const firstTab = document.querySelector('.terminal-tab');
                if (firstTab) switchTab(firstTab.dataset.tab);
            }
        }
        
        // Track open tool tabs (limit to 4)
        let toolTabCounter = 0;
        const MAX_TOOL_TABS = 4;
        
        // Create a workspace tab with custom content
        function createWorkspaceTab(name, contentHTML) {
            // Count existing tool tabs (exclude permanent and main tabs)
            const permanentTabs = ['devtools', 'codes', 'external', 'main', 'review-history'];
            const existingToolTabs = Array.from(document.querySelectorAll('.terminal-tab'))
                .filter(tab => !permanentTabs.includes(tab.dataset.tab));
            
            // Check if at limit
            if (existingToolTabs.length >= MAX_TOOL_TABS) {
                alert(`Maximum ${MAX_TOOL_TABS} tool tabs allowed. Please close a tab before opening a new one.`);
                return null;
            }
            
            toolTabCounter++;
            const tabId = `tool-${toolTabCounter}`;
            
            // Create tab button
            const tabBtn = document.createElement('button');
            tabBtn.className = 'terminal-tab';
            tabBtn.dataset.tab = tabId;
            tabBtn.onclick = () => switchTab(tabId);
            tabBtn.innerHTML = `${name} <span class="close-tab" onclick="closeTab(event, '${tabId}')"></span>`;
            document.getElementById('terminalTabs').appendChild(tabBtn);
            
            // Create terminal body
            const termBody = document.createElement('div');
            termBody.className = 'terminal-body';
            termBody.id = `terminal-${tabId}`;
            termBody.dataset.tab = tabId;
            termBody.innerHTML = contentHTML;
            document.getElementById('terminalBodies').appendChild(termBody);
            
            // Switch to new tab
            switchTab(tabId);
            
            log(`${name} workspace opened`, 'success', 'main');
            
            return tabId;
        }
        
        /* LOG FUNCTION MOVED TO TOP OF SCRIPT (line ~2530)
        function log(message, type = 'info', tabId = null) {
            const terminal = tabId ? document.getElementById(`terminal-${tabId}`) : getActiveTerminal();
            const line = document.createElement('div');
            line.className = type;
            const timestamp = new Date().toLocaleTimeString('en-US', { hour12: false });
            line.textContent = `[${timestamp}] ${message}`;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }
        */
        
        /* CLEARTERMINAL FUNCTION MOVED TO TOP OF SCRIPT (line ~2530)
        function clearTerminal() {
            const terminal = getActiveTerminal();
            terminal.innerHTML = '<div class="info">[Cleared] Terminal cleared</div>';
        }
        */
        
        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function openExternal(url) {
            if (window.electronAPI) {
                window.electronAPI.openExternal(url);
            } else {
                window.open(url, '_blank');
            }
        }
        
        // ============================================
        // PROJECT NAVIGATION
        // ============================================
        let currentProject = null; // Will be set to first project in list
        
        /* PASSWORD PROTECTION VARIABLES - COMMENTED OUT (NOT WORKING)
        // Clear unlock states for fresh testing
        sessionStorage.removeItem('devToolkitUnlocked');
        sessionStorage.removeItem('enterpriseHubUnlocked');
        let devToolkitUnlocked = false;
        let enterpriseHubUnlocked = false;
        END PASSWORD PROTECTION */
        
        // Wait for DOM to be ready
        window.addEventListener('DOMContentLoaded', () => {
            log(`Protected projects initial state: LOCKED`, 'info');
            
            // Initialize clock
            setInterval(updateClock, 1000);
            updateClock();
            
            // ============================================
            // DRAG AND DROP PROJECT REORDERING
            // ============================================
            
            // Restore saved project order from localStorage
            function restoreProjectOrder() {
                const devOrder = localStorage.getItem('projectOrder_dev');
                const deployedOrder = localStorage.getItem('projectOrder_deployed');
                
                if (devOrder) {
                    const order = JSON.parse(devOrder);
                    const container = document.querySelector('.project-section:first-of-type');
                    const h3 = container.querySelector('h3');
                    
                    // Reorder buttons based on saved order
                    order.forEach(projectId => {
                        const btn = container.querySelector(`[data-project="${projectId}"]`);
                        if (btn) container.appendChild(btn);
                    });
                    
                    // Put h3 back at top
                    container.insertBefore(h3, container.firstChild);
                }
                
                if (deployedOrder) {
                    const order = JSON.parse(deployedOrder);
                    const container = document.querySelectorAll('.project-section')[1];
                    const h3 = container.querySelector('h3');
                    
                    // Reorder buttons
                    order.forEach(projectId => {
                        const btn = container.querySelector(`[data-project="${projectId}"]`);
                        if (btn) container.appendChild(btn);
                    });
                    
                    // Put h3 back at top
                    container.insertBefore(h3, container.firstChild);
                }
            }
            
            // Save current project order to localStorage
            function saveProjectOrder(container, key) {
                const buttons = container.querySelectorAll('.project-btn[data-project]');
                const order = Array.from(buttons).map(btn => btn.dataset.project);
                localStorage.setItem(key, JSON.stringify(order));
            }
            
            // Set up drag and drop for project buttons (mouse-based, won't interfere with clicks)
            let draggedElement = null;
            let dragStartX = 0;
            let dragStartY = 0;
            let isDragging = false;
            let placeholder = null;
            
            // Function to switch to a project (called by both click and mouseup)
            function switchToProject(btn) {
                const project = btn.dataset.project;
                
                log(``, 'info');
                log(`CLICKED PROJECT: ${project}`, 'info');
                
                // Remove active from all
                document.querySelectorAll('.project-btn[data-project]').forEach(b => b.classList.remove('active'));
                // Add to clicked
                btn.classList.add('active');
                
                const projectName = btn.querySelector('span').textContent;
                currentProject = project;
                
                // Update header
                document.getElementById('projectTitle').textContent = projectName;
                
                // Show/hide project-specific tools
                document.querySelectorAll('.project-tools').forEach(section => {
                    section.style.display = 'none';
                });
                const activeTools = document.querySelector(`.project-tools[data-project="${project}"]`);
                if (activeTools) {
                    activeTools.style.display = 'block';
                }
                
                log(`Switched to: ${projectName}`, 'info');
                loadProjectFiles(project);
            }
            
            document.querySelectorAll('.project-btn[data-project]').forEach(btn => {
                btn.addEventListener('mousedown', (e) => {
                    // Only left mouse button
                    if (e.button !== 0) return;
                    
                    dragStartX = e.clientX;
                    dragStartY = e.clientY;
                    draggedElement = btn;
                    isDragging = false;
                    
                    const onMouseMove = (e) => {
                        const deltaX = Math.abs(e.clientX - dragStartX);
                        const deltaY = Math.abs(e.clientY - dragStartY);
                        
                        // Start dragging if moved > 10px
                        if (!isDragging && (deltaX > 10 || deltaY > 10)) {
                            isDragging = true;
                            draggedElement.classList.add('dragging');
                            
                            // Create placeholder
                            placeholder = document.createElement('div');
                            placeholder.style.height = draggedElement.offsetHeight + 'px';
                            placeholder.style.marginBottom = '8px';
                            placeholder.style.border = '2px dashed var(--orange-light)';
                            placeholder.style.borderRadius = '8px';
                            placeholder.style.opacity = '0.5';
                            draggedElement.parentNode.insertBefore(placeholder, draggedElement);
                        }
                        
                        if (isDragging) {
                            // Find element under cursor
                            const afterElement = getDragAfterElement(draggedElement.parentNode, e.clientY);
                            if (afterElement == null) {
                                draggedElement.parentNode.appendChild(draggedElement);
                            } else {
                                draggedElement.parentNode.insertBefore(draggedElement, afterElement);
                            }
                        }
                    };
                    
                    const onMouseUp = () => {
                        document.removeEventListener('mousemove', onMouseMove);
                        document.removeEventListener('mouseup', onMouseUp);
                        
                        if (isDragging) {
                            draggedElement.classList.remove('dragging');
                            if (placeholder) {
                                placeholder.remove();
                                placeholder = null;
                            }
                            
                            // Save order after drag completes
                            const container = draggedElement.closest('.project-section');
                            const isDev = container.querySelector('h3').textContent.includes('Development');
                            const key = isDev ? 'projectOrder_dev' : 'projectOrder_deployed';
                            saveProjectOrder(container, key);
                            
                            // Update default project to first in list
                            setDefaultProject();
                        } else {
                            // No drag happened - treat as click
                            switchToProject(btn);
                        }
                        
                        isDragging = false;
                        draggedElement = null;
                    };
                    
                    document.addEventListener('mousemove', onMouseMove);
                    document.addEventListener('mouseup', onMouseUp);
                });
            });
            
            function getDragAfterElement(container, y) {
                const draggableElements = [...container.querySelectorAll('.project-btn[data-project]:not(.dragging)')];
                
                return draggableElements.reduce((closest, child) => {
                    const box = child.getBoundingClientRect();
                    const offset = y - box.top - box.height / 2;
                    
                    if (offset < 0 && offset > closest.offset) {
                        return { offset: offset, element: child };
                    } else {
                        return closest;
                    }
                }, { offset: Number.NEGATIVE_INFINITY }).element;
            }
            
            // Restore saved order on load
            restoreProjectOrder();
            
            // Set default project to first project button in development section
            function setDefaultProject() {
                const firstProject = document.querySelector('.project-section:first-of-type .project-btn[data-project]');
                if (firstProject) {
                    currentProject = firstProject.dataset.project;
                    
                    // Remove active from all, add to first
                    document.querySelectorAll('.project-btn').forEach(b => b.classList.remove('active'));
                    firstProject.classList.add('active');
                    
                    // Update header
                    const projectName = firstProject.querySelector('span').textContent;
                    document.getElementById('projectTitle').textContent = projectName;
                    
                    // Show correct tools
                    document.querySelectorAll('.project-tools').forEach(section => {
                        section.style.display = 'none';
                    });
                    const activeTools = document.querySelector(`.project-tools[data-project="${currentProject}"]`);
                    if (activeTools) {
                        activeTools.style.display = 'block';
                    }
                    
                    // Load files for default project
                    loadProjectFiles(currentProject);
                }
            }
            
            // Set default project now
            setDefaultProject();
            
            // ============================================
            // END DRAG AND DROP
            // ============================================
            
        });
        
        // ============================================
        // FILE MANAGEMENT
        // ============================================
        let projectFiles = {};
        let selectedFile = null;
        
        // Load files for current project from localStorage
        function loadProjectFiles(project) {
            const saved = localStorage.getItem(`projectFiles_${project}`);
            const files = saved ? JSON.parse(saved) : { working: [], completed: [] };
            projectFiles = files;
            renderFileLists();
            clearPreview();
        }
        
        // Save files to localStorage
        function saveProjectFiles() {
            localStorage.setItem(`projectFiles_${currentProject}`, JSON.stringify(projectFiles));
        }
        
        let selectedFilesForUpload = [];
        let previewingFile = null;
        
        // Add files via file picker
        async function addFiles() {
            // Open enhanced file picker modal
            document.getElementById('filePickerModal').style.display = 'flex';
            selectedFilesForUpload = [];
            renderSelectedFiles();
        }
        
        function triggerNativeFilePicker() {
            document.getElementById('nativeFilePicker').click();
        }
        
        function handleFileSelection(event) {
            const files = Array.from(event.target.files);
            files.forEach(file => {
                // Check if file already selected
                if (!selectedFilesForUpload.find(f => f.name === file.name && f.size === file.size)) {
                    selectedFilesForUpload.push(file);
                }
            });
            renderSelectedFiles();
            // Reset input so same file can be selected again
            event.target.value = '';
        }
        
        function renderSelectedFiles() {
            const container = document.getElementById('selectedFilesList');
            const fileCount = document.getElementById('fileCount');
            const addBtn = document.getElementById('addFilesBtn');
            
            if (selectedFilesForUpload.length === 0) {
                container.innerHTML = '<div class="no-files-msg">No files selected</div>';
                fileCount.textContent = '0';
                addBtn.disabled = true;
            } else {
                container.innerHTML = selectedFilesForUpload.map((file, index) => `
                    <div class="selected-file-item ${previewingFile === index ? 'active' : ''}" 
                         onclick="previewFile(${index})">
                        <div class="file-item-info">
                            <div class="file-item-name">${file.name}</div>
                            <div class="file-item-details">${formatFileSize(file.size)}</div>
                        </div>
                        <button class="file-item-remove" onclick="event.stopPropagation(); removeSelectedFile(${index})">
                            Remove
                        </button>
                    </div>
                `).join('');
                fileCount.textContent = selectedFilesForUpload.length;
                addBtn.disabled = false;
            }
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        function removeSelectedFile(index) {
            selectedFilesForUpload.splice(index, 1);
            if (previewingFile === index) {
                previewingFile = null;
                clearPreviewArea();
            }
            renderSelectedFiles();
        }
        
        function previewFile(index) {
            previewingFile = index;
            const file = selectedFilesForUpload[index];
            const previewArea = document.getElementById('filePreviewArea');
            
            renderSelectedFiles(); // Update active state
            
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewArea.innerHTML = `
                        <div class="file-preview-content">
                            <img src="${e.target.result}" class="preview-image" alt="${file.name}">
                            <div style="margin-top: 15px; color: var(--gray-light); font-size: 0.9rem;">
                                <div><strong>Name:</strong> ${file.name}</div>
                                <div><strong>Size:</strong> ${formatFileSize(file.size)}</div>
                                <div><strong>Type:</strong> ${file.type}</div>
                            </div>
                        </div>
                    `;
                };
                reader.readAsDataURL(file);
            } else if (file.type.startsWith('text/') || file.name.endsWith('.md') || file.name.endsWith('.json')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewArea.innerHTML = `
                        <div class="file-preview-content">
                            <div style="margin-bottom: 15px; color: var(--gray-light); font-size: 0.9rem;">
                                <div><strong>Name:</strong> ${file.name}</div>
                                <div><strong>Size:</strong> ${formatFileSize(file.size)}</div>
                                <div><strong>Type:</strong> ${file.type || 'text/plain'}</div>
                            </div>
                            <div class="preview-text">${e.target.result.substring(0, 5000)}${e.target.result.length > 5000 ? '\n\n... (truncated)' : ''}</div>
                        </div>
                    `;
                };
                reader.readAsText(file);
            } else {
                previewArea.innerHTML = `
                    <div class="file-preview-content">
                        <div style="color: var(--gray-light); font-size: 0.9rem;">
                            <div><strong>Name:</strong> ${file.name}</div>
                            <div><strong>Size:</strong> ${formatFileSize(file.size)}</div>
                            <div><strong>Type:</strong> ${file.type || 'unknown'}</div>
                            <div style="margin-top: 30px; text-align: center; font-style: italic;">
                                Preview not available for this file type
                            </div>
                        </div>
                    </div>
                `;
            }
        }
        
        function clearPreviewArea() {
            document.getElementById('filePreviewArea').innerHTML = '<div class="no-preview-msg">Select a file to preview</div>';
        }
        
        function closeFilePicker() {
            document.getElementById('filePickerModal').style.display = 'none';
            selectedFilesForUpload = [];
            previewingFile = null;
            clearPreviewArea();
        }
        
        function addSelectedFiles() {
            if (selectedFilesForUpload.length === 0) return;
            
            selectedFilesForUpload.forEach(file => {
                projectFiles.working = projectFiles.working || [];
                projectFiles.working.push({
                    id: Date.now() + Math.random(),
                    name: file.name,
                    path: file.path || file.name, // Browser files don't have paths
                    size: file.size,
                    modified: file.lastModifiedDate || new Date(),
                    addedDate: new Date().toISOString()
                });
            });
            
            saveProjectFiles();
            renderFileLists();
            log(`Added ${selectedFilesForUpload.length} file(s) to working files`, 'success');
            closeFilePicker();
        }
        
        // ============================================
        // FILE BROWSER
        // ============================================
        let currentBrowserFolder = '';
        let currentBrowserFiles = [];
        // Note: selectedFile already declared in FILE MANAGEMENT section above
        
        const folderPaths = {
            'living-docs': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents',
            'sessions': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\03-Session-Files',
            'templates': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\06-Templates',
            'command-center': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center',
            'protocols': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\01-Core-Protocols',
            'learning': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\02-Learning',
            'scripts': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\05-Scripts',
            'documentation': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\04-Documentation'
        };
        
        const folderNames = {
            'living-docs': 'Living Documents',
            'sessions': 'Session Library',
            'templates': 'Templates',
            'command-center': 'Command Center',
            'protocols': 'Core Protocols',
            'learning': 'Learning Folder',
            'scripts': 'Scripts',
            'documentation': 'Documentation'
        };
        
        async function openFileBrowser(folderKey) {
            const modal = document.getElementById('fileBrowserModal');
            const title = document.getElementById('fileBrowserTitle');
            const list = document.getElementById('fileBrowserList');
            
            // Set title based on folder
            const folderNames = {
                'living-docs': ' Living Documents',
                'sessions': ' Session Library',
                'templates': ' Templates',
                'command-center': ' Command Center',
                'protocols': ' Core Protocols',
                'learning': ' Learning Folder',
                'scripts': ' Scripts',
                'documentation': ' Documentation'
            };
            
            title.textContent = folderNames[folderKey] || ' Files';
            modal.classList.add('active');
            
            // Show loading
            list.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">Loading files...</div>';
            
            // Get folder path
            const folderPaths = {
                'living-docs': 'G:\\My Drive\\00 - Trajanus USA\\03-Living-Documents',
                'sessions': 'G:\\My Drive\\00 - Trajanus USA\\07-Session-Journal',
                'templates': 'G:\\My Drive\\00 - Trajanus USA\\02-Templates',
                'command-center': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center',
                'protocols': 'G:\\My Drive\\00 - Trajanus USA\\01-Core-Protocols',
                'learning': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\02-Learning',
                'scripts': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\05-Scripts',
                'documentation': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\04-Documentation'
            };
            
            const path = folderPaths[folderKey];
            
            if (!window.electronAPI) {
                list.innerHTML = '<div style="text-align: center; padding: 40px; color: #ff6b6b;">File browser requires Electron environment</div>';
                return;
            }
            
            try {
                const result = await window.electronAPI.listDirectory(path);
                
                if (result.success && result.files) {
                    window.currentBrowserFiles = result.files;
                    renderFileBrowserList();
                } else {
                    list.innerHTML = '<div style="text-align: center; padding: 40px; color: #ff6b6b;">Error loading files</div>';
                }
            } catch (err) {
                list.innerHTML = `<div style="text-align: center; padding: 40px; color: #ff6b6b;">Error: ${err.message}</div>`;
            }
        }
        
        function renderFileBrowserList() {
            const list = document.getElementById('fileBrowserList');
            const searchTerm = (document.getElementById('fileBrowserSearch').value || '').toLowerCase();
            
            let files = window.currentBrowserFiles || [];
            
            if (searchTerm) {
                files = files.filter(f => f.name.toLowerCase().includes(searchTerm));
            }
            
            if (files.length === 0) {
                list.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">No files found</div>';
                return;
            }
            
            list.innerHTML = files.map(file => `
                <div class="file-browser-item">
                    <span class="guide-name">${file.name}</span>
                    <div class="file-browser-buttons">
                        <button class="guide-btn" style="background: #3498db;" onclick="previewFile('${file.path.replace(/\\/g, '\\\\')}', '${file.name}')">Preview</button>
                        <button class="guide-btn" style="background: #e67e22;" onclick="downloadAsDOCX('${file.path.replace(/\\/g, '\\\\')}', '${file.name}')">Download DOCX</button>
                        <button class="guide-btn" onclick="downloadAsGoogleDocs('${file.path.replace(/\\/g, '\\\\')}', '${file.name}')">Download G-Docs</button>
                    </div>
                </div>
            `).join('');
        }
        
        function filterBrowserFiles() {
            renderFileBrowserList();
        }
        
        function closeFileBrowser(event) {
            if (event.target === event.currentTarget) {
                hideFileBrowser();
            }
        }
        
        function hideFileBrowser() {
            document.getElementById('fileBrowserModal').classList.remove('active');
        }
        
        async function previewFile(path, name) {
            log(`Preview: ${name}`, 'info');
            // TODO: Implement preview
        }
        
        async function downloadAsDOCX(path, name) {
            log(`Download as DOCX: ${name}`, 'info');
            // TODO: Implement DOCX download
        }
        
        async function downloadAsGoogleDocs(path, name) {
            log(`Download as Google Docs: ${name}`, 'info');
            // TODO: Implement Google Docs upload
        }
        
        async function OLD_openFileBrowser(folderKey) {
            currentBrowserFolder = folderKey;
            const path = folderPaths[folderKey];
            const name = folderNames[folderKey];
            
            document.getElementById('fileBrowserTitle').textContent = name;
            document.getElementById('fileBrowserPath').textContent = path;
            document.getElementById('fileBrowserModal').style.display = 'flex';
            
            log(`Opening file browser: ${name}`, 'info');
            
            // Wait for modal to render before accessing its DOM elements
            await new Promise(resolve => requestAnimationFrame(resolve));
            
            // Load files from folder
            await loadFolderFiles(path);
        }
        
        async function loadFolderFiles(path) {
            if (!window.electronAPI) {
                log('File browser requires Electron', 'error');
                document.getElementById('fileList').innerHTML = '<div class="preview-placeholder">File browser requires Electron environment</div>';
                return;
            }
            
            try {
                document.getElementById('fileList').innerHTML = '<div class="preview-placeholder">Loading files...</div>';
                
                // Use Electron API to list directory
                const result = await window.electronAPI.listDirectory(path);
                
                if (result.success && result.files) {
                    currentBrowserFiles = result.files;
                    renderFileList();
                } else {
                    document.getElementById('fileList').innerHTML = '<div class="preview-placeholder">Error loading files</div>';
                    log(`Error loading files: ${result.error}`, 'error');
                }
            } catch (err) {
                document.getElementById('fileList').innerHTML = '<div class="preview-placeholder">Error loading files</div>';
                log(`Error loading folder: ${err.message}`, 'error');
            }
        }
        
        function renderFileList() {
            const container = document.getElementById('fileList');
            const searchTerm = document.getElementById('fileSearchInput').value.toLowerCase();
            
            let filteredFiles = currentBrowserFiles;
            if (searchTerm) {
                filteredFiles = currentBrowserFiles.filter(f => 
                    f.name.toLowerCase().includes(searchTerm)
                );
            }
            
            if (filteredFiles.length === 0) {
                container.innerHTML = '<div class="preview-placeholder">No files found</div>';
                return;
            }
            
            container.innerHTML = filteredFiles.map((file, index) => {
                const icon = getFileIcon(file.name, file.isDirectory);
                const size = file.isDirectory ? '-' : formatFileSize(file.size);
                const date = new Date(file.modified).toLocaleDateString();
                
                return `
                    <div class="file-item ${selectedFile === file ? 'selected' : ''}" 
                         onclick="selectFile(${index})">
                        <div class="file-icon">${icon}</div>
                        <div class="file-info">
                            <div class="file-name">${file.name}</div>
                            <div class="file-meta">
                                <span>${size}</span>
                                <span>${date}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function getFileIcon(filename, isDirectory) {
            if (isDirectory) return '[DIR]';
            
            const ext = filename.split('.').pop().toLowerCase();
            const iconMap = {
                'md': '[MD]',
                'txt': '[TXT]',
                'docx': '[DOC]',
                'doc': '[DOC]',
                'pdf': '[PDF]',
                'xlsx': '[XLS]',
                'xls': '[XLS]',
                'pptx': '[PPT]',
                'ppt': '[PPT]',
                'png': '[IMG]',
                'jpg': '[IMG]',
                'jpeg': '[IMG]',
                'gif': '[IMG]',
                'html': '[HTML]',
                'css': '[CSS]',
                'js': '[JS]',
                'py': '[PY]',
                'json': '[JSON]',
                'zip': '[ZIP]'
            };
            
            return iconMap[ext] || '[FILE]';
        }
        
        function selectFile(index) {
            selectedFile = currentBrowserFiles[index];
            renderFileList();
            showFilePreview(selectedFile);
            
            // Enable buttons
            document.getElementById('viewBtn').disabled = false;
            document.getElementById('downloadBtn').disabled = false;
            document.getElementById('fileBrowserInfo').textContent = `Selected: ${selectedFile.name}`;
            
            log(`Selected file: ${selectedFile.name}`, 'info');
        }
        
        async function showFilePreview(file) {
            const previewContent = document.getElementById('previewContent');
            
            if (file.isDirectory) {
                previewContent.innerHTML = `
                    <div class="preview-metadata">
                        <p><strong>Name:</strong> ${file.name}</p>
                        <p><strong>Type:</strong> Folder</p>
                        <p><strong>Modified:</strong> ${new Date(file.modified).toLocaleString()}</p>
                    </div>
                `;
                return;
            }
            
            const ext = file.name.split('.').pop().toLowerCase();
            
            // Text files - show preview
            if (['txt', 'md', 'json', 'html', 'css', 'js', 'py'].includes(ext)) {
                try {
                    const result = await window.electronAPI.readFile(file.path);
                    if (result.success) {
                        const preview = result.content.length > 5000 
                            ? result.content.substring(0, 5000) + '\n\n... (truncated)'
                            : result.content;
                        
                        previewContent.innerHTML = `
                            <div class="preview-metadata">
                                <p><strong>Name:</strong> ${file.name}</p>
                                <p><strong>Size:</strong> ${formatFileSize(file.size)}</p>
                                <p><strong>Modified:</strong> ${new Date(file.modified).toLocaleString()}</p>
                            </div>
                            <hr style="border: 1px solid rgba(255,255,255,0.1); margin: 15px 0;">
                            <div class="preview-text">${preview}</div>
                        `;
                    }
                } catch (err) {
                    showFileMetadata(file);
                }
            } else {
                // Other files - show metadata only
                showFileMetadata(file);
            }
        }
        
        function showFileMetadata(file) {
            const previewContent = document.getElementById('previewContent');
            previewContent.innerHTML = `
                <div class="preview-metadata">
                    <p><strong>Name:</strong> ${file.name}</p>
                    <p><strong>Type:</strong> ${file.name.split('.').pop().toUpperCase()} File</p>
                    <p><strong>Size:</strong> ${formatFileSize(file.size)}</p>
                    <p><strong>Modified:</strong> ${new Date(file.modified).toLocaleString()}</p>
                    <p><strong>Path:</strong> ${file.path}</p>
                    <p style="margin-top: 30px; text-align: center; color: var(--gray-light); font-style: italic;">
                        Preview not available for this file type
                    </p>
                </div>
            `;
        }
        
        async function viewSelectedFile() {
            if (!selectedFile) return;
            
            if (window.electronAPI) {
                const result = await window.electronAPI.openFile(selectedFile.path);
                if (result.success) {
                    log(`Opened file: ${selectedFile.name}`, 'success');
                } else {
                    log(`Error opening file: ${result.error}`, 'error');
                }
            } else {
                log('File viewing requires Electron', 'error');
            }
        }
        
        async function downloadSelectedFile() {
            if (!selectedFile) return;
            
            if (window.electronAPI) {
                const result = await window.electronAPI.saveFile(selectedFile.path);
                if (result.success) {
                    log(`Downloaded: ${selectedFile.name}`, 'success');
                } else {
                    log(`Error downloading: ${result.error}`, 'error');
                }
            } else {
                log('File download requires Electron', 'error');
            }
        }
        
        async function uploadToFolder() {
            const path = folderPaths[currentBrowserFolder];
            log(`Upload to: ${path} - Feature coming soon`, 'info');
            // TODO: Implement file upload
        }
        
        function closeFileBrowser() {
            document.getElementById('fileBrowserModal').style.display = 'none';
            selectedFile = null;
            currentBrowserFiles = [];
            document.getElementById('viewBtn').disabled = true;
            document.getElementById('downloadBtn').disabled = true;
            document.getElementById('fileBrowserInfo').textContent = 'No file selected';
            document.getElementById('previewContent').innerHTML = '<div class="preview-placeholder">Select a file to preview</div>';
        }
        
        // Search functionality
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('fileSearchInput');
            if (searchInput) {
                searchInput.addEventListener('input', renderFileList);
            }
        });
        
        
        // Render file lists
        function renderFileLists() {
            renderFileList('workingFilesList', 'working');
            renderFileList('completedFilesList', 'completed');
        }
        
        function renderFileList(containerId, listType) {
            const container = document.getElementById(containerId);
            const files = projectFiles[listType] || [];
            
            if (files.length === 0) {
                container.innerHTML = '<div class="empty-state">No files yet</div>';
                return;
            }
            
            container.innerHTML = files.map((file, index) => `
                <div class="file-item ${selectedFile && selectedFile.id === file.id ? 'selected' : ''}" 
                     onclick="selectFile('${listType}', ${index})">
                    <span class="file-icon"><i class="fas fa-file"></i></span>
                    <div class="file-info">
                        <div class="file-name" title="${file.name}">${file.name}</div>
                        <div class="file-meta">${formatSize(file.size)}</div>
                    </div>
                    <div class="file-actions">
                        ${listType === 'working' ? `
                            <button class="file-action-btn" onclick="event.stopPropagation(); moveToCompleted(${index})" title="Mark Complete"></button>
                        ` : ''}
                        <button class="file-action-btn" onclick="event.stopPropagation(); removeFile('${listType}', ${index})" title="Remove"></button>
                    </div>
                </div>
            `).join('');
        }
        
        function formatSize(bytes) {
            if (!bytes) return '';
            bytes = parseInt(bytes);
            if (bytes > 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
            if (bytes > 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return bytes + ' bytes';
        }
        
        function selectFile(listType, index) {
            const files = projectFiles[listType] || [];
            selectedFile = { ...files[index], listType, index };
            renderFileLists();
            showPreview(selectedFile);
            log(`Selected: ${selectedFile.name}`, 'info');
        }
        
        function moveToCompleted(index) {
            if (typeof index === 'object') {
                // Called from preview button with selectedFile
                index = selectedFile.index;
            }
            
            const file = projectFiles.working.splice(index, 1)[0];
            projectFiles.completed = projectFiles.completed || [];
            projectFiles.completed.push(file);
            selectedFile = null;
            saveProjectFiles();
            renderFileLists();
            clearPreview();
            log(`Completed: ${file.name}`, 'success');
        }
        
        function removeFile(listType, index) {
            const file = projectFiles[listType].splice(index, 1)[0];
            if (selectedFile && selectedFile.id === file.id) {
                selectedFile = null;
                clearPreview();
            }
            saveProjectFiles();
            renderFileLists();
            log(`Removed: ${file.name}`, 'info');
        }
        
        // ============================================
        // DEVELOPER ACCESS - HANDLED AT PROJECT LEVEL
        // ============================================
        function devCheck(callback) {
            // Access controlled by Developer Toolkit project unlock
            callback();
        }
        
        // ============================================
        // CODING RESOURCES SYSTEM
        // ============================================
        const codingResources = {
            html: {
                title: ' HTML Basics',
                emoji: '',
                resources: [
                    { name: 'HTML Tutorial (W3Schools)', url: 'https://www.w3schools.com/html/', type: 'Interactive Tutorial', level: 'Beginner' },
                    { name: 'HTML Basics (MDN)', url: 'https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/HTML_basics', type: 'Documentation', level: 'Beginner' },
                    { name: 'Learn HTML (Codecademy)', url: 'https://www.codecademy.com/learn/learn-html', type: 'Interactive Course', level: 'Beginner' },
                    { name: 'HTML Crash Course (YouTube)', url: 'https://www.youtube.com/watch?v=UB1O30fR-EE', type: 'Video Tutorial', level: 'Beginner' },
                    { name: 'HTML Cheat Sheet', url: 'https://htmlcheatsheet.com/', type: 'Quick Reference', level: 'All Levels' },
                    { name: 'HTML Elements Reference', url: 'https://developer.mozilla.org/en-US/docs/Web/HTML/Element', type: 'Reference', level: 'All Levels' }
                ]
            },
            css: {
                title: ' CSS Basics',
                emoji: '',
                resources: [
                    { name: 'CSS Tutorial (W3Schools)', url: 'https://www.w3schools.com/css/', type: 'Interactive Tutorial', level: 'Beginner' },
                    { name: 'Learn CSS (MDN)', url: 'https://developer.mozilla.org/en-US/docs/Learn/CSS', type: 'Documentation', level: 'Beginner' },
                    { name: 'CSS Flexbox Guide', url: 'https://css-tricks.com/snippets/css/a-guide-to-flexbox/', type: 'Visual Guide', level: 'Intermediate' },
                    { name: 'CSS Grid Guide', url: 'https://css-tricks.com/snippets/css/complete-guide-grid/', type: 'Visual Guide', level: 'Intermediate' },
                    { name: 'CSS Crash Course (YouTube)', url: 'https://www.youtube.com/watch?v=yfoY53QXEnI', type: 'Video Tutorial', level: 'Beginner' },
                    { name: 'CSS Tricks', url: 'https://css-tricks.com/', type: 'Articles & Tips', level: 'All Levels' },
                    { name: 'CSS Cheat Sheet', url: 'https://htmlcheatsheet.com/css/', type: 'Quick Reference', level: 'All Levels' }
                ]
            },
            python: {
                title: ' Python Basics',
                emoji: '',
                resources: [
                    { name: 'Python Tutorial (Official)', url: 'https://docs.python.org/3/tutorial/', type: 'Official Documentation', level: 'Beginner' },
                    { name: 'Learn Python (W3Schools)', url: 'https://www.w3schools.com/python/', type: 'Interactive Tutorial', level: 'Beginner' },
                    { name: 'Python for Beginners (Microsoft)', url: 'https://www.youtube.com/playlist?list=PLlrxD0HtieHhS8VzuMCfQD4uJ9yne1mE6', type: 'Video Series', level: 'Beginner' },
                    { name: 'Automate the Boring Stuff', url: 'https://automatetheboringstuff.com/', type: 'Free Online Book', level: 'Beginner' },
                    { name: 'Python Crash Course (YouTube)', url: 'https://www.youtube.com/watch?v=_uQrJ0TkZlc', type: 'Video Tutorial', level: 'Beginner' },
                    { name: 'Real Python', url: 'https://realpython.com/', type: 'Tutorials & Articles', level: 'All Levels' },
                    { name: 'Python Cheat Sheet', url: 'https://www.pythoncheatsheet.org/', type: 'Quick Reference', level: 'All Levels' }
                ]
            },
            javascript: {
                title: ' JavaScript Basics',
                emoji: '',
                resources: [
                    { name: 'JavaScript Tutorial (W3Schools)', url: 'https://www.w3schools.com/js/', type: 'Interactive Tutorial', level: 'Beginner' },
                    { name: 'JavaScript Basics (MDN)', url: 'https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/JavaScript_basics', type: 'Documentation', level: 'Beginner' },
                    { name: 'JavaScript for Beginners (YouTube)', url: 'https://www.youtube.com/watch?v=W6NZfCO5SIk', type: 'Video Tutorial', level: 'Beginner' },
                    { name: 'Learn JavaScript (Codecademy)', url: 'https://www.codecademy.com/learn/introduction-to-javascript', type: 'Interactive Course', level: 'Beginner' },
                    { name: 'JavaScript.info', url: 'https://javascript.info/', type: 'Modern Tutorial', level: 'Beginner to Advanced' },
                    { name: 'Eloquent JavaScript (Free Book)', url: 'https://eloquentjavascript.net/', type: 'Online Book', level: 'Beginner to Advanced' },
                    { name: 'JavaScript Cheat Sheet', url: 'https://htmlcheatsheet.com/js/', type: 'Quick Reference', level: 'All Levels' }
                ]
            }
        };
        
        function showCodingResources(language) {
            const modal = document.getElementById('codingResourcesModal');
            const title = document.getElementById('codingModalTitle');
            const list = document.getElementById('codingResourcesList');
            
            const resources = codingResources[language];
            if (!resources) return;
            
            title.textContent = resources.title;
            
            // Build resource list with categories
            let html = '<div style="margin-bottom: 20px; color: var(--gray-light); font-size: 0.9rem;">';
            html += 'Click any resource to open it in your browser:';
            html += '</div>';
            
            html += '<div class="guide-list">';
            
            resources.resources.forEach(resource => {
                html += `
                    <div class="guide-item" style="cursor: pointer;" onclick="openExternal('${resource.url}')">
                        <div>
                            <div class="guide-name">${resource.name}</div>
                            <div style="color: var(--gray-light); font-size: 0.75rem; margin-top: 4px;">
                                ${resource.type}  ${resource.level}
                            </div>
                        </div>
                        <button class="guide-btn" onclick="event.stopPropagation(); openExternal('${resource.url}')">Open</button>
                    </div>
                `;
            });
            
            html += '</div>';
            
            // Add learning path suggestion
            html += `
                <div style="margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 6px; border-left: 3px solid var(--orange-mid);">
                    <div style="color: var(--cream); font-weight: bold; margin-bottom: 8px;">Suggested Learning Path:</div>
                    <div style="color: var(--gray-light); font-size: 0.85rem; line-height: 1.5;">
                        ${getLearningPath(language)}
                    </div>
                </div>
            `;
            
            list.innerHTML = html;
            modal.classList.add('active');
        }
        
        function getLearningPath(language) {
            const paths = {
                html: '1 Start with W3Schools tutorial (hands-on practice)<br>2 Watch the YouTube crash course for overview<br>3 Read MDN docs for deeper understanding<br>4 Keep the cheat sheet handy while coding<br>5 Build a simple webpage to practice',
                css: '1 Start with W3Schools for basics (colors, fonts, spacing)<br>2 Learn Flexbox (for layouts)<br>3 Learn CSS Grid (for complex layouts)<br>4 Watch crash course to tie it together<br>5 Style your HTML practice page',
                python: '1 Start with W3Schools for syntax basics<br>2 Watch Microsoft\'s video series<br>3 Read "Automate the Boring Stuff" (practical projects)<br>4 Keep cheat sheet handy<br>5 Write scripts for your daily tasks',
                javascript: '1 Start with W3Schools for basics<br>2 Watch beginner YouTube tutorial<br>3 Read JavaScript.info (comprehensive)<br>4 Practice with interactive exercises<br>5 Add interactivity to your HTML/CSS pages'
            };
            return paths[language] || 'Start with beginner resources and work your way up!';
        }
        
        function hideCodingResources() {
            document.getElementById('codingResourcesModal').classList.remove('active');
        }
        
        function closeCodingResources(event) {
            if (event.target === event.currentTarget) {
                hideCodingResources();
            }
        }
        
        // ============================================
        // USER GUIDES SYSTEM
        // ============================================
        const userGuides = [
            // Core Protocols (Google Docs URLs - UPDATE THESE WITH YOUR ACTUAL URLS)
            { name: '6-Category System Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_1/edit', file: '6_Category_System_Guide.docx' },
            { name: 'End of Session Closeout', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_2/edit', file: 'End_Of_Session_Closeout.docx' },
            { name: 'File Systems User Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_3/edit', file: 'File_Systems_User_Guide.docx' },
            { name: 'Morning Session Startup', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_4/edit', file: 'Morning_Session_Startup.docx' },
            { name: 'Operational Protocols', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_5/edit', file: 'Operational_Protocols.docx' },
            { name: 'The Commandments of AI', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_6/edit', file: 'The_Commandments_of_AI.docx' },
            { name: 'Bill\'s Profile', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_7/edit', file: 'Bills_Profile.docx' },
            { name: 'START HERE - Implementation Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_8/edit', file: 'START_HERE_Implementation_Guide.md' },
            { name: 'Development Workflow', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_9/edit', file: 'DEVELOPMENT_WORKFLOW.md' },
            { name: 'Adding Utility Buttons Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_10/edit', file: 'ADDING_UTILITY_BUTTONS.md' },
            { name: 'Operational Protocol (MD)', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_11/edit', file: 'OPERATIONAL_PROTOCOL.md' },
            { name: 'Limitless Integration Guide', url: 'https://docs.google.com/document/d/YOUR_DOC_ID_12/edit', file: 'Limitless_Integration_Guide.md' }
        ];
        
        function showUserGuides() {
            const modal = document.getElementById('userGuidesModal');
            modal.classList.add('active');
            
            const guideList = document.getElementById('guideList');
            guideList.innerHTML = userGuides.map(guide => `
                <div class="guide-item" data-name="${guide.name.toLowerCase()}">
                    <span class="guide-name">${guide.name}</span>
                    <button class="guide-btn" onclick="event.stopPropagation(); openGuide('${guide.url}', '${guide.file}')">Open in Docs</button>
                </div>
            `).join('');
            
            // Clear search
            document.getElementById('guideSearch').value = '';
        }
        
        function hideUserGuides() {
            document.getElementById('userGuidesModal').classList.remove('active');
        }
        
        function closeUserGuides(event) {
            if (event.target === event.currentTarget) {
                hideUserGuides();
            }
        }
        
        function filterGuides() {
            const search = document.getElementById('guideSearch').value.toLowerCase();
            const items = document.querySelectorAll('.guide-item');
            
            items.forEach(item => {
                const name = item.dataset.name;
                if (name.includes(search)) {
                    item.classList.remove('hidden');
                } else {
                    item.classList.add('hidden');
                }
            });
        }
        
        async function openGuide(url, filename) {
            // If URL is configured (not default), open Google Doc
            if (url && !url.includes('YOUR_DOC_ID')) {
                openExternal(url);
                log(`Opened in Google Docs: ${filename}`, 'success');
                hideUserGuides();
            } else {
                // Fallback to local file if Google Doc URL not configured
                if (!window.electronAPI) {
                    log('File opening requires Electron', 'error');
                    return;
                }
                
                try {
                    const filePath = `G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\${filename}`;
                    await window.electronAPI.runCommand(`start "" "${filePath}"`);
                    log(`Opened local file: ${filename}`, 'success');
                    hideUserGuides();
                } catch (err) {
                    log(`Error opening guide: ${err.message}`, 'error');
                }
            }
        }
        
        // ============================================
        // FILE CONVERSION FUNCTIONS
        // ============================================
        async function runConversion(type) {
            if (!window.electronAPI) {
                log('Conversion requires Electron', 'error');
                return;
            }
            
            const scripts = {
                'md-to-docx': 'convert_md_to_docx.py',
                'docx-to-gdocs': 'convert_to_google_docs.py',
                'gdocs-to-docx': 'export_gdocs_to_docx.py'
            };
            
            try {
                // Handle batch conversions separately
                if (type === 'convert-latest') {
                    // Smart conversion - last 24 hours only
                    const psScript = 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\CONVERT_NEW_FILES_ONLY.ps1';
                    log('Starting smart conversion (last 24 hours)...', 'info');
                    // Use cmd /c wrapper to ensure PowerShell output is captured
                    await window.electronAPI.runCommand(`cmd /c powershell -NoProfile -ExecutionPolicy Bypass -File "${psScript}" 2>&1`);
                    log('Smart conversion complete', 'success');
                } else if (type === 'convert-all') {
                    // Full conversion - all markdown files
                    const pythonScript = 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\batch_convert_to_gdocs.py';
                    log('Starting full conversion (ALL files)...', 'warning');
                    await window.electronAPI.runCommand(`python "${pythonScript}"`);
                    log('Full conversion complete', 'success');
                } else {
                    // Single file conversions
                    const script = scripts[type];
                    if (!script) {
                        log(`Unknown conversion type: ${type}`, 'error');
                        return;
                    }
                    
                    const scriptPath = `G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\${script}`;
                    log(`Running conversion: ${type}...`, 'info');
                    
                    const result = await window.electronAPI.pickFiles();
                    if (result.success && result.files.length > 0) {
                        const filePath = result.files[0].path;
                        await window.electronAPI.runCommand(`python "${scriptPath}" "${filePath}"`);
                        log(`Conversion complete: ${result.files[0].name}`, 'success');
                    }
                }
            } catch (err) {
                log(`Conversion error: ${err.message}`, 'error');
            }
        }
        
        // ============================================
        // LIVING DOCUMENTS QUICK ACCESS
        // ============================================
        function toggleLivingDocsMenu() {
            const menu = document.getElementById('livingDocsMenu');
            const btn = document.getElementById('livingDocsBtn');
            const arrow = btn.querySelector('span:last-child');
            
            if (menu.style.display === 'none') {
                menu.style.display = 'block';
                arrow.textContent = '';
            } else {
                menu.style.display = 'none';
                arrow.textContent = '';
            }
        }
        
        async function openLivingDoc(docType) {
            const docs = {
                'diary': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents\\Bills_Daily_Journal.html',
                'journal': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents\\Trajanus_Project_Journal.md',
                'protocols': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\01-Core-Protocols',
                'pov': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents\\Bills_POV.md',
                'sessions': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\03-Session-Files',
                'all': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents'
            };
            
            const path = docs[docType];
            if (path) {
                try {
                    await window.electronAPI.runCommand(`explorer "${path}"`);
                    log(`Opened: ${docType}`, 'success');
                } catch (err) {
                    log(`Error opening ${docType}: ${err.message}`, 'error');
                }
            }
        }
        
        // ============================================
        // PROTOCOL FILE ACCESS
        // ============================================
        async function openProtocolFile(type) {
            const protocolFiles = {
                'sync': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\OPERATIONAL_PROTOCOLS_QUICK_REFERENCE.md',
                'deepdive': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\DEEP_DIVE_CONTEXT.md'
            };
            
            const path = protocolFiles[type];
            if (path) {
                try {
                    // Use cmd /c to open with default application
                    await window.electronAPI.runCommand(`cmd /c "${path}"`);
                    if (type === 'sync') {
                        log(' Sync Protocols: All 47 operational protocols loaded', 'success');
                    } else {
                        log(' Deep Dive Recall: Bill\'s POV and full context loaded', 'success');
                    }
                } catch (err) {
                    log(`Error opening protocol file: ${err.message}`, 'error');
                }
            }
        }
        
        // ============================================
        // FOLDER NAVIGATION
        // ============================================
        async function openLocalFolder(folderName) {
            if (!window.electronAPI) {
                log('Folder opening requires Electron', 'error');
                return;
            }
            
            const folders = {
                'living-docs': 'G:\\My Drive\\00 - Trajanus USA\\02-Living-Documents',
                'protocols': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\01-Core-Protocols',
                'templates': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\02-Templates',
                'sessions': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\03-Session-Files',
                'documentation': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\04-Documentation',
                'scripts': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center\\05-Scripts',
                'command-center': 'G:\\My Drive\\00 - Trajanus USA\\00-Command-Center'
            };
            
            const path = folders[folderName];
            if (path) {
                try {
                    await window.electronAPI.runCommand(`explorer "${path}"`);
                    log(`Opened folder: ${folderName}`, 'success');
                } catch (err) {
                    log(`Error opening folder: ${err.message}`, 'error');
                }
            }
        }
        
        function openDriveFolder(folderName) {
            const folders = {
                'main': 'https://drive.google.com/drive/folders/1ngKnGqz8YvHG5yzKPG6qVxSdPzqXHVJB',
                'living-docs': 'https://drive.google.com/drive/folders/YOUR_FOLDER_ID',
                'protocols': 'https://drive.google.com/drive/folders/YOUR_FOLDER_ID',
                'templates': 'https://drive.google.com/drive/folders/YOUR_FOLDER_ID',
                'sessions': 'https://drive.google.com/drive/folders/YOUR_FOLDER_ID'
            };
            
            const url = folders[folderName];
            if (url) {
                openExternal(url);
                log(`Opening ${folderName} in Google Drive`, 'info');
            }
        }
        
        // ============================================
        // DEVELOPER MODE
        // ============================================
        function toggleDevMode() {
            document.body.classList.toggle('developer-mode');
            const isActive = document.body.classList.contains('developer-mode');
            
            const toggle = document.getElementById('devToggle');
            const badge = document.getElementById('devBadge');
            
            if (isActive) {
                toggle.classList.add('active');
                badge.textContent = 'ON';
                badge.style.background = 'var(--green-badge)';
                log('Developer mode ENABLED', 'success');
            } else {
                toggle.classList.remove('active');
                badge.textContent = 'OFF';
                badge.style.background = 'var(--gray-mid)';
                log('Developer mode DISABLED', 'info');
            }
            
            // Save preference
            localStorage.setItem('developerMode', isActive);
        }
        
        // Enhanced preview functions
        function showPreview(file) {
            const previewContent = document.getElementById('previewContent');
            const previewActions = document.getElementById('previewActions');
            
            if (!file) {
                clearPreview();
                return;
            }
            
            // Determine file icon based on extension
            const ext = file.name.split('.').pop().toLowerCase();
            let icon = 'fa-file';
            if (['pdf'].includes(ext)) icon = 'fa-file-pdf';
            else if (['doc', 'docx'].includes(ext)) icon = 'fa-file-word';
            else if (['xls', 'xlsx'].includes(ext)) icon = 'fa-file-excel';
            else if (['ppt', 'pptx'].includes(ext)) icon = 'fa-file-powerpoint';
            else if (['jpg', 'jpeg', 'png', 'gif'].includes(ext)) icon = 'fa-file-image';
            else if (['zip', 'rar', '7z'].includes(ext)) icon = 'fa-file-archive';
            else if (['txt', 'md'].includes(ext)) icon = 'fa-file-alt';
            
            previewContent.innerHTML = `
                <div class="preview-file-icon"><i class="fas ${icon}"></i></div>
                <div class="preview-file-name">${file.name}</div>
                <div class="preview-file-meta">${formatSize(file.size)}</div>
                <div class="preview-file-meta">${new Date(file.modified).toLocaleDateString()}</div>
            `;
            
            previewActions.style.display = 'flex';
        }
        
        function clearPreview() {
            const previewContent = document.getElementById('previewContent');
            const previewActions = document.getElementById('previewActions');
            
            previewContent.innerHTML = `
                <div class="preview-file-icon"><i class="fas fa-file"></i></div>
                <div>Select a file to preview</div>
            `;
            
            previewActions.style.display = 'none';
        }
        
        async function viewSelectedFile() {
            if (!selectedFile || !window.electronAPI) return;
            
            try {
                await window.electronAPI.runCommand(`start "" "${selectedFile.path}"`);
                log(`Opening: ${selectedFile.name}`, 'success');
            } catch (err) {
                log(`Error opening file: ${err.message}`, 'error');
            }
        }
        
        async function openFileLocation() {
            if (!selectedFile || !window.electronAPI) return;
            
            try {
                // Get directory path
                const dirPath = selectedFile.path.substring(0, selectedFile.path.lastIndexOf('\\'));
                await window.electronAPI.runCommand(`explorer "${dirPath}"`);
                log(`Opened folder: ${dirPath}`, 'success');
            } catch (err) {
                log(`Error opening folder: ${err.message}`, 'error');
            }
        }
        
        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', async () => {
            // Load developer mode preference
            
            log('Trajanus Enterprise Hub v2.0.0 initialized', 'success');
            log('All systems online. Ready for commands.', 'info');
            
            // Get platform info
            if (window.electronAPI) {
                const platform = await window.electronAPI.getPlatform();
                document.getElementById('platform').textContent = `Platform: ${platform.platform}`;
            }
            
            // Load files for current project
            loadProjectFiles(currentProject);
        });
        
        // ============================================
        // QCM SUBMITTAL REVIEW WORKSPACE
        // ============================================
        
        let qcmSelectedFiles = [];
        let qcmCurrentFolder = 'root';
        let qcmMockFiles = [
            { id: '1', name: 'Shop_Drawings_Steel_Beams.pdf', size: 2457600, type: 'pdf', folder: 'submittals' },
            { id: '2', name: 'Product_Data_Concrete_Mix.pdf', size: 1153433, type: 'pdf', folder: 'submittals' },
            { id: '3', name: 'Spec_Section_03300_Concrete.pdf', size: 910234, type: 'pdf', folder: 'specs' },
            { id: '4', name: 'Contract_Drawings_S-201.pdf', size: 5612345, type: 'pdf', folder: 'drawings' },
            { id: '5', name: 'Structural_Details_Sheet_S-101.dwg', size: 3234567, type: 'dwg', folder: 'drawings' },
        ];
        
        // Template library
        const qcmTemplates = {
            'shop-drawing': `Review the selected shop drawings for:

1. COMPLIANCE
   - Contract specifications compliance
   - Design intent maintained
   - Material specifications match approved submittals

2. TECHNICAL ACCURACY
   - Dimensional accuracy against contract drawings
   - Fabrication details are constructible
   - Connection details are adequate
   - Load paths are clear and correct

3. COORDINATION
   - No conflicts with other trades
   - Field conditions accommodated
   - Proper clearances maintained

4. DEVIATIONS
   - Flag any deviations from contract requirements
   - Note substitutions or alternatives proposed
   - Identify items requiring clarification

Provide specific references to:
- Specification sections
- Drawing numbers and detail references
- Contract requirements

Recommendation: [Approve / Approve as Noted / Revise and Resubmit]`,

            'product-data': `Review the selected product data submittals for:

1. PRODUCT SPECIFICATIONS
   - Manufacturer and model match specified
   - Performance characteristics meet requirements
   - Physical properties comply with specs
   - Certifications and testing documentation included

2. MATERIALS & FINISHES
   - Materials match specification requirements
   - Finishes and colors as specified
   - Warranty information provided

3. INSTALLATION
   - Installation instructions included
   - Special requirements noted
   - Maintenance requirements documented

4. COMPLIANCE
   - Building code compliance verified
   - Industry standards met
   - Environmental requirements satisfied

Flag any:
- Non-compliant items
- Missing information
- Substitutions requiring approval

Recommendation: [Approve / Approve as Noted / Revise and Resubmit]`,

            'spec-compliance': `Compare submitted documents against specification requirements:

SPECIFICATION SECTION: [Enter section number and title]

Review for:
1. Materials compliance
2. Performance criteria met
3. Testing requirements satisfied
4. Installation methods conform
5. Quality standards achieved

For each requirement in the specification:
- State if compliant or non-compliant
- Provide specific page/section references
- Note any deviations or substitutions
- Identify missing information

Summary:
- Total requirements: [count]
- Compliant: [count]
- Non-compliant: [count]
- Clarifications needed: [count]

Recommendation: [Approve / Approve as Noted / Revise and Resubmit]`,

            'structural': `Review structural submittals for:

1. STRUCTURAL INTEGRITY
   - Load calculations verified
   - Member sizes adequate
   - Connection capacities sufficient
   - Deflection limits satisfied

2. CODE COMPLIANCE
   - Building code requirements met
   - Seismic provisions addressed
   - Wind load provisions correct
   - Special inspection requirements noted

3. DESIGN COORDINATION
   - Matches structural design intent
   - Compatible with architectural elements
   - MEP coordination addressed
   - Construction sequence feasible

4. DOCUMENTATION
   - Calculations provided and stamped
   - Material certifications included
   - Welding procedures specified
   - Testing requirements identified

Recommendation: [Approve / Approve as Noted / Revise and Resubmit]`,

            'mep': `Review MEP coordination submittals for:

1. SYSTEM COORDINATION
   - No conflicts between trades
   - Adequate clearances maintained
   - Access for maintenance provided
   - Routing optimized

2. DESIGN COMPLIANCE
   - Matches contract drawings
   - Capacity requirements met
   - Performance criteria satisfied
   - Equipment specifications correct

3. INSTALLATION
   - Installation details clear
   - Support requirements adequate
   - Connection details proper
   - Testing procedures defined

4. COORDINATION ISSUES
   - Identify conflicts with structure
   - Note conflicts with other systems
   - Flag access/maintenance concerns
   - Document clearance violations

Recommendation: [Approve / Approve as Noted / Revise and Resubmit]`
        };
        
        // ============================================
        // OPERATIONAL WORKSPACE CONFIGURATIONS
        // ============================================
        
        const operationalWorkspaces = {
            'traffic-studies': {
                name: 'Traffic Studies',
                userGuide: 'WORKSPACE GUIDE: 1) Browse/Upload traffic count data and site plans, 2) Configure analysis parameters (peak hours, vehicle types, LOS criteria), 3) Review selected data files, 4) Send to Claude for traffic analysis and recommendations, 5) Save configuration for repeat use',
                panel1: { title: 'Traffic Data Browser', icon: '' },
                panel2: { title: 'Analysis Parameters', icon: '' },
                panel3: { title: 'Selected Data', icon: '' },
                panel4: { title: 'Analysis Results', icon: '' },
                mockFiles: [
                    { id: 'tf1', name: 'AM_Peak_Counts.xlsx', size: 640000, type: 'xlsx', date: 'Nov 28, 2025' },
                    { id: 'tf2', name: 'PM_Peak_Counts.xlsx', size: 695000, type: 'xlsx', date: 'Nov 28, 2025' },
                    { id: 'tf3', name: 'Site_Plan.pdf', size: 1258000, type: 'pdf', date: 'Nov 25, 2025' },
                    { id: 'tf4', name: 'Intersection_Diagram.dwg', size: 912000, type: 'dwg', date: 'Nov 27, 2025' },
                    { id: 'tf5', name: 'ITE_Trip_Gen_Data.xlsx', size: 445000, type: 'xlsx', date: 'Nov 26, 2025' }
                ],
                templates: {
                    'tia': `Conduct Traffic Impact Analysis for the selected data:

1. EXISTING CONDITIONS
   - Analyze current traffic volumes
   - Calculate existing level of service (LOS)
   - Document baseline conditions
   - Identify operational issues

2. TRIP GENERATION
   - Apply ITE trip generation rates
   - Calculate daily trips
   - Determine peak hour trips
   - Consider pass-by and diverted trips

3. TRIP DISTRIBUTION
   - Analyze traffic patterns
   - Determine directional distribution
   - Consider access points
   - Evaluate route selection

4. LEVEL OF SERVICE ANALYSIS
   - Calculate intersection LOS (A-F scale)
   - Determine volume/capacity ratios
   - Assess delay times
   - Identify failing movements

5. RECOMMENDATIONS
   - Proposed mitigation measures
   - Signal timing adjustments
   - Turn lane requirements
   - Access management strategies

Provide specific data for:
- Intersection delay (seconds)
- V/C ratios
- LOS grades
- Queue lengths

Summary: [PASS / FAIL / MITIGATION REQUIRED]`,
                    'los': `Calculate Level of Service for selected intersections:

Analysis Methodology: HCM 6th Edition

For each intersection/approach:
1. Current volumes (vehicles per hour)
2. Lane configuration
3. Signal timing (if signalized)
4. Peak hour factor
5. Heavy vehicle percentage

Calculate:
- Control delay per approach
- Average intersection delay
- Volume/capacity (v/c) ratio
- Level of Service grade (A-F)
- 95th percentile queue length

LOS Criteria:
A: <10 sec delay, B: 10-20 sec, C: 20-35 sec
D: 35-55 sec, E: 55-80 sec, F: >80 sec

Identify:
- Failing movements (LOS E or F)
- Capacity deficiencies (v/c > 0.85)
- Safety concerns
- Improvement recommendations

Summary: Overall intersection LOS and recommendations`,
                    'tripgen': `Generate trip estimates using ITE Trip Generation Manual:

PROJECT DETAILS:
- Land use type: [Specify ITE code]
- Size/intensity: [Units]
- Trip generation equation or rate

CALCULATIONS:
1. Daily Trip Generation
   - Weekday trips
   - Weekend trips (if applicable)
   - Seasonal adjustments

2. Peak Hour Trips
   - AM peak hour (7-9 AM typical)
   - PM peak hour (4-6 PM typical)
   - Inbound vs outbound split

3. ADJUSTMENTS
   - Pass-by trips (%)
   - Diverted trips (%)
   - Internal capture (if mixed-use)
   - Transit/walk/bike mode split

4. NET NEW TRIPS
   - Total generated trips
   - Less pass-by/diverted
   - Equals net new trips to network

Results Table:
| Period | In | Out | Total |
|--------|-----|-----|-------|
| Daily  |     |     |       |
| AM Peak|     |     |       |
| PM Peak|     |     |       |

Summary: Net new trips requiring analysis`,
                    'capacity': `Analyze intersection capacity and performance:

INTERSECTION CONFIGURATION:
- Type: [AWSC / Signal / Roundabout]
- Number of approaches
- Lane configuration per approach
- Turn bay lengths

TRAFFIC VOLUMES:
- Current peak hour volumes
- Future year projections
- Background growth rate
- Site-generated traffic

CAPACITY ANALYSIS:
1. Calculate capacity per lane/movement
2. Determine volume/capacity ratios
3. Calculate control delay
4. Assign Level of Service
5. Check queue storage adequacy

DEFICIENCIES:
- Movements exceeding capacity
- Inadequate storage
- Safety concerns
- Operational issues

IMPROVEMENTS NEEDED:
- Additional lanes
- Signal modifications
- Turn restrictions
- Geometric changes

Summary: Capacity adequate [YES/NO] - Improvements: [LIST]`
                }
            },
            
            'pe-services': {
                name: 'P.E. Services',
                userGuide: 'WORKSPACE GUIDE: 1) Browse/Upload engineering plans, calculations, and specifications, 2) Configure review type and code requirements, 3) Review selected documents, 4) Send to Claude for professional engineering review, 5) Get code compliance assessment and stamp recommendation',
                panel1: { title: 'Engineering Documents', icon: '' },
                panel2: { title: 'Review Criteria', icon: '' },
                panel3: { title: 'Selected Documents', icon: '' },
                panel4: { title: 'Engineering Review', icon: '' },
                mockFiles: [
                    { id: 'pe1', name: 'Structural_Plans_S1-S10.pdf', size: 4404000, type: 'pdf', date: 'Nov 27, 2025' },
                    { id: 'pe2', name: 'Foundation_Calculations.pdf', size: 1887000, type: 'pdf', date: 'Nov 27, 2025' },
                    { id: 'pe3', name: 'Civil_Grading_Plans.pdf', size: 3251000, type: 'pdf', date: 'Nov 26, 2025' },
                    { id: 'pe4', name: 'Specifications_Div_2-3.pdf', size: 2625000, type: 'pdf', date: 'Nov 25, 2025' },
                    { id: 'pe5', name: 'Geotech_Report.pdf', size: 1956000, type: 'pdf', date: 'Nov 20, 2025' }
                ],
                templates: {
                    'structural': `Review structural plans and calculations for Professional Engineering compliance:

1. CODE COMPLIANCE
   - Building code edition verified
   - Occupancy classification correct
   - Construction type appropriate
   - Load requirements per code

2. STRUCTURAL DESIGN
   - Load calculations reviewed
   - Member sizing adequate
   - Connection design sufficient
   - Deflection limits satisfied
   - Seismic provisions correct

3. FOUNDATIONS
   - Soil bearing capacity verified
   - Foundation type appropriate
   - Reinforcement adequate
   - Settlement within limits

4. CALCULATIONS REVIEW
   - Design methodology sound
   - Load combinations correct
   - Material properties appropriate
   - Safety factors adequate
   - Units and dimensions checked

5. DRAWING REVIEW
   - General notes complete
   - Details clear and constructible
   - Dimensions complete
   - Specifications referenced
   - Legend and symbols clear

STAMP RECOMMENDATION:
- Ready for PE seal: [YES/NO]
- Deficiencies to address: [LIST]
- Code violations: [LIST]
- Engineering concerns: [LIST]

Professional Opinion: [APPROVE FOR SEAL / REVISIONS REQUIRED]`,
                    'civil': `Review civil engineering plans for compliance and constructibility:

1. SITE LAYOUT
   - Property boundaries verified
   - Setbacks met
   - Access adequate
   - Parking count correct
   - ADA compliance verified

2. GRADING & DRAINAGE
   - Positive drainage achieved
   - Slopes within limits
   - Retaining walls adequate
   - Erosion control planned
   - Stormwater management compliant

3. UTILITIES
   - Water service sized
   - Sewer capacity adequate
   - Storm drainage designed
   - Utility conflicts resolved

4. PAVEMENT DESIGN
   - Traffic loading appropriate
   - Pavement section adequate
   - Subgrade preparation specified
   - Materials specifications included

5. EROSION CONTROL
   - SWPPP requirements met
   - BMP selection appropriate
   - Sequencing logical
   - Maintenance plan included

CODE/REGULATION COMPLIANCE:
- Local ordinances: [LIST]
   - State regulations: [LIST]
- Environmental permits: [STATUS]

STAMP RECOMMENDATION: [APPROVE FOR SEAL / REVISIONS REQUIRED]`,
                    'calcs': `Verify engineering calculations for accuracy and compliance:

CALCULATION PACKAGE REVIEW:

1. METHODOLOGY
   - Design approach sound
   - Code provisions correctly applied
   - Load combinations per code
   - Safety factors appropriate

2. ASSUMPTIONS
   - Material properties reasonable
   - Boundary conditions realistic
   - Load assumptions conservative
   - Soil parameters verified

3. CALCULATIONS
   - Mathematical accuracy checked
   - Units consistent throughout
   - Significant figures appropriate
   - References cited

4. RESULTS
   - Member sizes adequate
   - Stresses within limits
   - Deflections acceptable
   - Stability verified

5. DOCUMENTATION
   - Calculations organized
   - Sketches included
   - Code references cited
   - Seal block present

VERIFICATION:
- Sample calculations spot-checked
- Critical elements verified
- Load path continuous
- Connection adequacy confirmed

RECOMMENDATION:
Calculations are [ADEQUATE / REQUIRE REVISION]
PE Seal: [READY / NOT READY]
Items to address: [LIST]`,
                    'opinion': `Professional Engineering Opinion Letter:

PROJECT: [Name and Location]
REVIEW DATE: [Date]
REVIEWER: [PE Name and License]

SCOPE OF REVIEW:
[List documents reviewed]

ENGINEERING ASSESSMENT:

1. CODE COMPLIANCE
   [Assessment of code conformance]

2. DESIGN ADEQUACY
   [Structural/civil design evaluation]

3. CONSTRUCTION FEASIBILITY
   [Constructibility assessment]

4. SAFETY CONSIDERATIONS
   [Life safety and structural safety]

FINDINGS:
- Compliant items: [LIST]
- Deficiencies: [LIST]
- Recommendations: [LIST]

PROFESSIONAL OPINION:
[Clear statement of engineering opinion regarding the adequacy, safety, and compliance of the reviewed work]

LIMITATIONS:
This review is based on the documents provided and does not include field verification or testing.

Respectfully submitted,
[PE Name], P.E.
License No.: [Number]
State: [State]
Date: [Date]

[SEAL PLACEMENT]`
                }
            },
            
            'pe-legal-opinion': {
                name: 'Legal Opinion',
                userGuide: 'WORKSPACE GUIDE: 1) Browse/Upload legal documents, contracts, and supporting materials, 2) Configure opinion parameters and jurisdictional requirements, 3) Review selected documents, 4) Send to Claude for legal analysis and opinion generation, 5) Get formatted professional opinion letter',
                panel1: { title: 'Legal Documents', icon: '' },
                panel2: { title: 'Opinion Parameters', icon: '' },
                panel3: { title: 'Selected Materials', icon: '' },
                panel4: { title: 'Legal Opinion', icon: '' },
                mockFiles: [
                    { id: 'lo1', name: 'Contract_Agreement.pdf', size: 485000, type: 'pdf', date: 'Nov 25, 2025' },
                    { id: 'lo2', name: 'Supporting_Documentation.pdf', size: 892000, type: 'pdf', date: 'Nov 26, 2025' },
                    { id: 'lo3', name: 'Applicable_Statutes.pdf', size: 256000, type: 'pdf', date: 'Nov 20, 2025' },
                    { id: 'lo4', name: 'Case_Precedents.pdf', size: 1245000, type: 'pdf', date: 'Nov 18, 2025' },
                    { id: 'lo5', name: 'Correspondence.pdf', size: 178000, type: 'pdf', date: 'Nov 28, 2025' }
                ],
                templates: {
                    'contract-review': `Provide legal opinion on contract documents:

MATTER: [Contract/Agreement Name]
CLIENT: [Client Name]
DATE: [Date]

DOCUMENTS REVIEWED:
[List all contract documents, amendments, exhibits]

SCOPE OF OPINION:
This opinion addresses the following legal issues:
1. [Legal issue #1]
2. [Legal issue #2]
3. [Legal issue #3]

APPLICABLE LAW:
- Governing jurisdiction: [State/Federal]
- Relevant statutes: [Citations]
- Applicable regulations: [Citations]
- Controlling case law: [Citations]

LEGAL ANALYSIS:

Issue 1: [Statement of Issue]
[Analysis of legal requirements, case law application, statutory interpretation]

Issue 2: [Statement of Issue]
[Analysis of legal requirements, case law application, statutory interpretation]

Issue 3: [Statement of Issue]
[Analysis of legal requirements, case law application, statutory interpretation]

FINDINGS AND CONCLUSIONS:
Based on review of the documents and applicable law:

1. [Finding on Issue 1 with legal basis]
2. [Finding on Issue 2 with legal basis]
3. [Finding on Issue 3 with legal basis]

OPINION:
It is my professional legal opinion that [clear statement of opinion on the matter]

LIMITATIONS:
This opinion is based solely on the documents provided and the law as it exists on [date]. This opinion does not address [list exclusions].

RECOMMENDATIONS:
[List recommended actions or modifications]

Respectfully submitted,
[Attorney Name]
[Bar Number]
[State Bar]
[Date]`,
                    'compliance-opinion': `Legal opinion on regulatory compliance:

SUBJECT: Compliance Analysis - [Matter]
CLIENT: [Client Name]  
DATE: [Date]

REGULATORY FRAMEWORK:
- Federal regulations: [CFR citations]
- State regulations: [State code citations]
- Local ordinances: [Municipal code citations]
- Industry standards: [Standards]

FACTUAL BACKGROUND:
[Summary of relevant facts and circumstances]

COMPLIANCE ANALYSIS:

Requirement 1: [Regulatory requirement]
Current Status: [Compliant/Non-Compliant/Partial]
Analysis: [Detailed analysis of compliance status]
Supporting Authority: [Regulations, guidance, case law]

Requirement 2: [Regulatory requirement]
Current Status: [Compliant/Non-Compliant/Partial]
Analysis: [Detailed analysis of compliance status]
Supporting Authority: [Regulations, guidance, case law]

Requirement 3: [Regulatory requirement]
Current Status: [Compliant/Non-Compliant/Partial]
Analysis: [Detailed analysis of compliance status]
Supporting Authority: [Regulations, guidance, case law]

DEFICIENCIES IDENTIFIED:
[List all non-compliant items with regulatory citations]

LEGAL RISKS:
- Enforcement actions: [Assessment]
- Penalties and fines: [Potential exposure]
- Civil liability: [Assessment]
- Remediation costs: [Estimate]

OPINION:
Based on this compliance analysis, it is my legal opinion that [statement of overall compliance status and risk assessment]

RECOMMENDATIONS:
1. [Corrective action #1 with timeline]
2. [Corrective action #2 with timeline]
3. [Corrective action #3 with timeline]

[Attorney Name]
[Bar Number]
[Date]`,
                    'dispute-opinion': `Legal opinion on dispute resolution:

MATTER: [Dispute Description]
PARTIES: [List parties involved]
DATE: [Date]

DISPUTE OVERVIEW:
[Summary of the dispute, claims, and counterclaims]

RELEVANT CONTRACTS/AGREEMENTS:
[List applicable agreements with key provisions]

LEGAL ISSUES:
1. [Primary legal issue]
2. [Secondary legal issue]
3. [Related legal issues]

ANALYSIS OF LEGAL POSITION:

Party A Position:
[Analysis of legal arguments and supporting authority]
Strengths: [Assessment]
Weaknesses: [Assessment]

Party B Position:
[Analysis of legal arguments and supporting authority]
Strengths: [Assessment]
Weaknesses: [Assessment]

APPLICABLE LAW:
- Contract law principles: [Analysis]
- Statutory provisions: [Citations and analysis]
- Case precedents: [Relevant cases and holdings]

LIKELIHOOD OF SUCCESS:
Based on legal analysis:
- Plaintiff/Claimant: [Assessment with reasoning]
- Defendant/Respondent: [Assessment with reasoning]

RESOLUTION OPTIONS:

Litigation:
- Merits: [Assessment]
- Risks: [Identification]
- Costs: [Estimate]
- Timeline: [Estimate]

Alternative Dispute Resolution:
- Mediation: [Viability assessment]
- Arbitration: [Applicability and analysis]
- Settlement: [Feasibility]

OPINION:
It is my professional legal opinion that [recommendation on optimal dispute resolution strategy with legal reasoning]

RECOMMENDED COURSE OF ACTION:
[Specific recommended steps with rationale]

[Attorney Name]
[Bar Number]
[Date]`,
                    'due-diligence': `Legal due diligence opinion:

TRANSACTION: [Transaction Description]
CLIENT: [Client Name]
TARGET: [Target Entity]
DATE: [Date]

SCOPE OF REVIEW:
Documents reviewed in due diligence:
- Corporate formation documents
- Material contracts
- Intellectual property
- Real property
- Regulatory compliance
- Litigation and claims
- Employment matters
- Financial records

CORPORATE STATUS:
- Entity type and formation: [Analysis]
- Good standing: [Status and verification]
- Capitalization: [Review]
- Governance: [Assessment]

MATERIAL CONTRACTS:
[Analysis of key agreements with risk assessment]

INTELLECTUAL PROPERTY:
[Analysis of IP ownership, registrations, and risks]

REAL PROPERTY:
[Analysis of property ownership, encumbrances, zoning]

REGULATORY COMPLIANCE:
[Analysis of compliance with applicable regulations]

LITIGATION AND CLAIMS:
[Summary of pending, threatened, and potential claims]

IDENTIFIED ISSUES:
1. [Issue #1 with risk assessment]
2. [Issue #2 with risk assessment]
3. [Issue #3 with risk assessment]

OPINION:
Based on this legal due diligence review, it is my opinion that:
[Summary opinion on transaction risks and viability]

RISK RATING: [High/Medium/Low]

RECOMMENDATIONS:
- Deal structure modifications: [If applicable]
- Representations and warranties: [Required]
- Conditions precedent: [Recommended]
- Indemnification provisions: [Suggested]
- Purchase price adjustments: [If warranted]

[Attorney Name]
[Bar Number]
[Date]`
                }
            },
            
            'pe-review-stamp': {
                name: 'PE Review & Stamp',
                userGuide: 'WORKSPACE GUIDE: 1) Browse/Upload engineering plans, calculations, and specifications, 2) Configure review criteria and code requirements, 3) Review selected documents, 4) Send to Claude for comprehensive PE review, 5) Get engineering assessment with stamp recommendation',
                panel1: { title: 'Engineering Documents', icon: '' },
                panel2: { title: 'Review Criteria', icon: '' },
                panel3: { title: 'Selected Documents', icon: '' },
                panel4: { title: 'PE Review & Recommendation', icon: '' },
                mockFiles: [
                    { id: 'pe1', name: 'Structural_Plans_S1-S10.pdf', size: 4404000, type: 'pdf', date: 'Nov 27, 2025' },
                    { id: 'pe2', name: 'Foundation_Calculations.pdf', size: 1887000, type: 'pdf', date: 'Nov 27, 2025' },
                    { id: 'pe3', name: 'Civil_Grading_Plans.pdf', size: 3251000, type: 'pdf', date: 'Nov 26, 2025' },
                    { id: 'pe4', name: 'Specifications_Div_2-3.pdf', size: 2625000, type: 'pdf', date: 'Nov 25, 2025' },
                    { id: 'pe5', name: 'Geotech_Report.pdf', size: 1956000, type: 'pdf', date: 'Nov 20, 2025' }
                ],
                templates: {
                    'full-review': `Comprehensive Professional Engineering Review with Stamp Recommendation:

PROJECT: [Project Name and Location]
REVIEW DATE: [Date]
REVIEWER: [PE Name], P.E. License #[Number]

DOCUMENTS REVIEWED:
[Complete list of all documents including plans, calculations, specifications, reports]

CODE COMPLIANCE REVIEW:

Building Code: [Edition]
- Occupancy classification: [Verified/Issues]
- Construction type: [Verified/Issues]
- Height and area: [Verified/Issues]

Structural Design Code: [ASCE 7, ACI, AISC, etc.]
- Load combinations: [Verified/Issues]
- Seismic design: [Verified/Issues]
- Wind design: [Verified/Issues]

Civil Engineering Codes:
- Stormwater management: [Verified/Issues]
- Grading and drainage: [Verified/Issues]
- Erosion control: [Verified/Issues]

STRUCTURAL ANALYSIS:

Foundation Design:
- Bearing capacity adequate: [YES/NO]
- Settlement within limits: [YES/NO]
- Reinforcement adequate: [YES/NO]
- Details complete: [YES/NO]

Structural Frame:
- Member sizing verified: [YES/NO]
- Connections adequate: [YES/NO]
- Deflection acceptable: [YES/NO]
- Load path continuous: [YES/NO]

CALCULATIONS VERIFICATION:
- Design methodology sound: [Assessment]
- Load assumptions reasonable: [Assessment]
- Material properties appropriate: [Assessment]
- Safety factors adequate: [Assessment]
- Mathematical accuracy: [Spot check results]

DRAWINGS REVIEW:

Completeness:
- General notes adequate: [YES/NO]
- Details sufficient: [YES/NO]
- Dimensions complete: [YES/NO]
- Specifications referenced: [YES/NO]

Constructibility:
- Details are buildable: [YES/NO]
- Sequencing logical: [YES/NO]
- Conflicts resolved: [YES/NO]

DEFICIENCIES IDENTIFIED:
[Numbered list of all deficiencies with specific references]

1. [Deficiency with plan sheet and detail reference]
   Severity: [Critical/Major/Minor]
   Code Reference: [If applicable]
   Recommendation: [Specific corrective action]

2. [Continue for all deficiencies]

ENGINEERING ASSESSMENT:
[Professional assessment of overall design adequacy]

STAMP RECOMMENDATION:

APPROVE FOR PE SEAL: [YES/NO]

Conditions for approval:
[List any conditions that must be met before sealing]

Items requiring revision before seal:
[List critical items that must be corrected]

PROFESSIONAL OPINION:
Based on this comprehensive engineering review, it is my professional opinion that these documents are:

[READY FOR PE SEAL / REQUIRE REVISIONS BEFORE SEAL / NOT ADEQUATE FOR SEAL]

Reasoning: [Clear explanation of recommendation]

Respectfully submitted,

[PE Name], P.E.
License No.: [Number]
State: [State]
Date: [Date]

[SEAL LOCATION]`,
                    'stamp-only': `PE Stamp Review - Final Check Before Sealing:

PROJECT: [Project Name]
PE: [Name], License #[Number]
DATE: [Date]

PRE-SEAL CHECKLIST:

Document Completeness:
- All sheets present: [YES/NO]
- Title block complete: [YES/NO]
- Seal block present: [YES/NO]
- Revision block current: [YES/NO]
- Index sheet included: [YES/NO]

Technical Review:
- Calculations verified: [YES/NO]
- Code compliance confirmed: [YES/NO]
- Details checked: [YES/NO]
- Conflicts resolved: [YES/NO]
- Constructibility verified: [YES/NO]

Professional Responsibility:
- Within area of competence: [YES/NO]
- Adequate information provided: [YES/NO]
- No known errors: [YES/NO]
- Client authorization obtained: [YES/NO]

SEAL APPLICATION:

Documents to be sealed:
[List all sheets/pages to receive PE seal]

Seal statement:
"I hereby certify that this [plan/calculation/report] was prepared by me or under my direct supervision and that I am a duly Licensed Professional Engineer under the laws of the State of [State]"

FINAL VERIFICATION:
All pre-seal requirements satisfied: [YES/NO]

RECOMMENDATION:
[PROCEED WITH SEAL / DO NOT SEAL - ADDRESS ITEMS BELOW]

Items requiring attention before sealing:
[List any remaining items]

[PE Name], P.E.
License: [Number]
Date: [Date]`,
                    'third-party': `Third-Party PE Review for Approval Authority:

REVIEWING FOR: [Approval Authority - Building Dept, Owner, etc.]
PROJECT: [Project Name and Address]
REVIEWING PE: [Name], License #[Number]
DATE: [Date]

ORIGINAL DESIGN PE: [Name], License #[Number]

DOCUMENTS UNDER REVIEW:
[List all sealed documents being reviewed]

SCOPE OF THIRD-PARTY REVIEW:
This independent review assesses:
- Code compliance
- Design adequacy
- Calculation accuracy
- Drawing completeness
- Constructibility

FINDINGS:

Code Compliance:
[Assessment of compliance with all applicable codes]

Structural Adequacy:
[Assessment of structural design and calculations]

Design Standards:
[Assessment against industry standards of practice]

Constructibility:
[Assessment of whether design can be practically built]

ISSUES IDENTIFIED:

Critical Issues (Must be corrected):
[List with specific references]

Major Issues (Should be corrected):
[List with specific references]

Minor Issues (Recommended corrections):
[List with specific references]

RECOMMENDATIONS TO APPROVAL AUTHORITY:

[RECOMMEND APPROVAL / RECOMMEND APPROVAL WITH CONDITIONS / RECOMMEND REJECTION]

Basis for recommendation:
[Detailed reasoning for recommendation]

Conditions for approval (if applicable):
[Specific conditions that must be met]

PROFESSIONAL OPINION:
As an independent reviewing Professional Engineer, it is my opinion that these documents [are/are not] adequate for approval and issuance of permit.

[Detailed supporting reasoning]

Respectfully submitted,

[Reviewing PE Name], P.E.
License: [Number]
State: [State]
Date: [Date]

[SEAL]`,
                    'plan-check': `Plan Check Review for Building Department:

JURISDICTION: [Building Department]
PROJECT: [Address and Description]
PERMIT APPLICATION: [Number]
REVIEWER: [PE Name], License #[Number]
DATE: [Date]

SUBMITTAL COMPLETENESS:
- Application form complete: [YES/NO]
- All required plans included: [YES/NO]
- Calculations provided: [YES/NO]
- Specifications included: [YES/NO]
- Original PE seal present: [YES/NO]
- Geotechnical report: [YES/NO]
- Energy calculations: [YES/NO]

CODE REVIEW:

Building Code: [Edition]
Occupancy: [Classification]
Construction Type: [Type]
Sprinklers: [Required/Not Required]
Height: [Feet/Stories]
Area: [Square Feet]

Complies with code: [YES/NO/WITH CONDITIONS]

Structural Code Review:
[Detailed review of structural code compliance]

Civil Code Review:
[Detailed review of civil/site code compliance]

PLAN CHECK COMMENTS:

Corrections Required:
[Numbered list of required corrections with sheet references]

Clarifications Needed:
[List of items requiring clarification]

Additional Information Required:
[List of additional submittals needed]

PLAN CHECK RESULT:

[APPROVED / APPROVED WITH CONDITIONS / CORRECTIONS REQUIRED]

Conditions of approval:
[List all conditions]

Corrections must be addressed:
[List all required corrections]

Resubmittal required for:
[List items requiring resubmittal]

NEXT STEPS:
[Instructions for applicant]

Building Department Reviewer:
[Name], P.E.
License: [Number]
Date: [Date]`
                }
            }
        };
        
        // Open QCM workspace
        function openQCMWorkspace() {
            // Get the template workspace HTML
            const templateWorkspace = document.getElementById('terminal-qcm-submittal');
            const workspaceHTML = templateWorkspace.innerHTML;
            
            // Create new tab with workspace content
            const tabId = createWorkspaceTab('Submittal Review', workspaceHTML);
            
            if (tabId) {
                // Initialize workspace in new tab after short delay (let DOM render)
                setTimeout(() => {
                    const newTab = document.getElementById(`terminal-${tabId}`);
                    if (newTab) {
                        // Load mock files in this specific tab instance
                        loadQCMFilesInTab(tabId);
                        
                        // Setup event listeners for this tab
                        setupQCMEventListenersInTab(tabId);
                    }
                }, 100);
            }
        }
        
        // Open operational workspace with full functionality
        function openOperationalWorkspace(workspaceKey) {
            const config = operationalWorkspaces[workspaceKey];
            if (!config) {
                log('Workspace configuration not found: ' + workspaceKey, 'error', 'devtools');
                return;
            }
            
            // Generate workspace HTML with file upload capability
            const workspaceHTML = `
                <div class="qcm-workspace-container" style="height: 100%; display: flex; flex-direction: column;">
                    <div class="qcm-workspace-header">
                        <div class="success">[Ready] ${config.name} Workspace</div>
                        <div class="info">${config.userGuide}</div>
                    </div>
                    
                    <div class="qcm-workspace">
                        <!-- Panel 1: File Browser with Upload -->
                        <div class="qcm-panel qcm-file-browser">
                            <div class="panel-header">${config.panel1.title}</div>
                            <div style="padding: 10px; background: rgba(232,146,42,0.1); border-bottom: 1px solid rgba(232,146,42,0.3);">
                                <input type="text" id="fileSearch-${workspaceKey}" placeholder="Search files..." style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(232,146,42,0.5); color: #fff; border-radius: 4px; margin-bottom: 8px;">
                                <input type="file" id="fileUpload-${workspaceKey}" multiple style="display: none;">
                                <button class="session-btn" onclick="document.getElementById('fileUpload-${workspaceKey}').click()" style="width: 100%; padding: 8px; font-size: 0.9rem;">
                                    Upload Files
                                </button>
                            </div>
                            <div class="file-list" id="fileList-${workspaceKey}">
                                <!-- Files loaded here -->
                            </div>
                        </div>
                        
                        <!-- Panel 2: Configuration -->
                        <div class="qcm-panel qcm-instructions">
                            <div class="panel-header">${config.panel2.title}</div>
                            <select id="templateSelect-${workspaceKey}" class="template-select">
                                <option value="">Select template...</option>
                                ${Object.keys(config.templates).map(key => 
                                    `<option value="${key}">${key.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')}</option>`
                                ).join('')}
                            </select>
                            <textarea id="instructions-${workspaceKey}" class="instructions-area" placeholder="Enter configuration parameters or use a template...">${''}</textarea>
                            <div class="char-count" id="charCount-${workspaceKey}">0 characters</div>
                        </div>
                        
                        <!-- Panel 3: Selected Queue -->
                        <div class="qcm-panel qcm-selected-queue">
                            <div class="panel-header">${config.panel3.title}</div>
                            <div id="selectedQueue-${workspaceKey}" class="selected-files-list">
                                <div class="info" style="padding: 20px; text-align: center; color: #999;">
                                    No files selected
                                </div>
                            </div>
                            <div class="queue-summary" id="queueSummary-${workspaceKey}">
                                Total: 0 files
                            </div>
                        </div>
                        
                        <!-- Panel 4: Response (Always Visible) -->
                        <div class="qcm-panel qcm-review-panel">
                            <div class="review-header">
                                <div class="panel-header">${config.panel4.title}</div>
                                <div class="review-status waiting" id="status-${workspaceKey}">WAITING</div>
                            </div>
                            <div class="review-content" id="response-${workspaceKey}">
                                <div style="text-align: center; padding: 40px 20px; color: #999;">
                                    <div style="font-size: 1.2rem; margin-bottom: 15px;">Ready for Analysis</div>
                                    <div style="font-size: 0.9rem; line-height: 1.6;">
                                        Select files and configure parameters, then click "Send to Claude" to receive detailed analysis and recommendations.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="qcm-actions">
                        <button class="qcm-primary" onclick="sendToAnalysis('${workspaceKey}')">
                            Send to Claude for Analysis
                        </button>
                        <button class="session-btn" onclick="saveWorkspaceConfig('${workspaceKey}')">
                            Save Configuration
                        </button>
                        <button class="session-btn" onclick="loadWorkspaceConfig('${workspaceKey}')">
                            Load Configuration
                        </button>
                        <button class="session-btn" onclick="clearWorkspace('${workspaceKey}')">
                            Clear Workspace
                        </button>
                    </div>
                </div>
            `;
            
            // Create tab with workspace
            const tabId = createWorkspaceTab(config.name, workspaceHTML);
            
            if (tabId) {
                setTimeout(() => {
                    initializeOperationalWorkspace(workspaceKey, tabId);
                }, 100);
            }
        }
        
        // Initialize operational workspace
        function initializeOperationalWorkspace(workspaceKey, tabId) {
            const config = operationalWorkspaces[workspaceKey];
            const tab = document.getElementById(`terminal-${tabId}`);
            if (!tab || !config) return;
            
            // Load mock files
            const fileList = tab.querySelector(`#fileList-${workspaceKey}`);
            if (fileList) {
                fileList.innerHTML = config.mockFiles.map(file => `
                    <div class="qcm-file-item">
                        <input type="checkbox" onchange="toggleFileSelection('${workspaceKey}', '${file.id}')">
                        <div class="qcm-file-info">
                            <div class="qcm-file-name">${getFileIcon(file.type)} ${file.name}</div>
                            <div class="qcm-file-meta">${formatSize(file.size)} | ${file.type.toUpperCase()}</div>
                        </div>
                    </div>
                `).join('');
            }
            
            // Setup template selector
            const templateSelect = tab.querySelector(`#templateSelect-${workspaceKey}`);
            const instructionsArea = tab.querySelector(`#instructions-${workspaceKey}`);
            if (templateSelect && instructionsArea) {
                templateSelect.addEventListener('change', function() {
                    if (this.value && config.templates[this.value]) {
                        instructionsArea.value = config.templates[this.value];
                        updateCharCount(workspaceKey, tabId);
                    }
                });
            }
            
            // Setup character counter
            if (instructionsArea) {
                instructionsArea.addEventListener('input', () => updateCharCount(workspaceKey, tabId));
                updateCharCount(workspaceKey, tabId);
            }
            
            // Setup file search
            const fileSearch = tab.querySelector(`#fileSearch-${workspaceKey}`);
            if (fileSearch) {
                fileSearch.addEventListener('input', function() {
                    filterFiles(workspaceKey, tabId, this.value);
                });
            }
            
            // Setup file upload
            const fileUpload = tab.querySelector(`#fileUpload-${workspaceKey}`);
            if (fileUpload) {
                fileUpload.addEventListener('change', function() {
                    handleFileUpload(workspaceKey, tabId, this.files);
                });
            }
            
            // Initialize workspace state
            if (!window.workspaceStates) window.workspaceStates = {};
            window.workspaceStates[workspaceKey] = {
                selectedFiles: [],
                uploadedFiles: [],
                config: config
            };
            
            log(`${config.name} workspace opened successfully`, 'success', 'devtools');
        }
        
        // Toggle file selection
        function toggleFileSelection(workspaceKey, fileId) {
            if (!window.workspaceStates[workspaceKey]) return;
            
            const state = window.workspaceStates[workspaceKey];
            const config = state.config;
            
            // Find file in mock files or uploaded files
            const file = config.mockFiles.find(f => f.id === fileId) || 
                        state.uploadedFiles.find(f => f.id === fileId);
            
            if (!file) return;
            
            const index = state.selectedFiles.findIndex(f => f.id === fileId);
            if (index > -1) {
                state.selectedFiles.splice(index, 1);
            } else {
                state.selectedFiles.push(file);
            }
            
            updateSelectedQueue(workspaceKey);
        }
        
        // Update selected files queue
        function updateSelectedQueue(workspaceKey) {
            const state = window.workspaceStates[workspaceKey];
            if (!state) return;
            
            const queue = document.querySelector(`#selectedQueue-${workspaceKey}`);
            const summary = document.querySelector(`#queueSummary-${workspaceKey}`);
            
            if (!queue) return;
            
            if (state.selectedFiles.length === 0) {
                queue.innerHTML = '<div class="info" style="padding: 20px; text-align: center; color: #999;">No files selected</div>';
            } else {
                queue.innerHTML = state.selectedFiles.map((file, idx) => `
                    <div class="qcm-selected-item">
                        <div style="display: flex; align-items: center; justify-content: space-between;">
                            <div style="flex: 1;">
                                <div class="qcm-selected-name">${idx + 1}. ${file.name}</div>
                                <div class="qcm-selected-meta">${formatSize(file.size)}</div>
                            </div>
                            <button onclick="toggleFileSelection('${workspaceKey}', '${file.id}')" style="background: none; border: none; color: #e8922a; cursor: pointer; font-size: 1.2rem; padding: 5px 10px;"></button>
                        </div>
                    </div>
                `).join('');
            }
            
            if (summary) {
                const totalSize = state.selectedFiles.reduce((sum, f) => sum + f.size, 0);
                summary.textContent = `Total: ${state.selectedFiles.length} files (${formatSize(totalSize)})`;
            }
        }
        
        // Filter files by search
        function filterFiles(workspaceKey, tabId, searchTerm) {
            const state = window.workspaceStates[workspaceKey];
            if (!state) return;
            
            const tab = document.getElementById(`terminal-${tabId}`);
            if (!tab) return;
            
            const fileList = tab.querySelector(`#fileList-${workspaceKey}`);
            if (!fileList) return;
            
            const allFiles = [...state.config.mockFiles, ...state.uploadedFiles];
            const filteredFiles = allFiles.filter(file => 
                file.name.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            fileList.innerHTML = filteredFiles.map(file => `
                <div class="qcm-file-item">
                    <input type="checkbox" 
                           ${state.selectedFiles.find(f => f.id === file.id) ? 'checked' : ''}
                           onchange="toggleFileSelection('${workspaceKey}', '${file.id}')">
                    <div class="qcm-file-info">
                        <div class="qcm-file-name">${getFileIcon(file.type)} ${file.name}</div>
                        <div class="qcm-file-meta">${formatSize(file.size)} | ${file.type.toUpperCase()}</div>
                    </div>
                </div>
            `).join('');
        }
        
        // Handle file upload
        function handleFileUpload(workspaceKey, tabId, files) {
            const state = window.workspaceStates[workspaceKey];
            if (!state) return;
            
            Array.from(files).forEach(file => {
                const fileObj = {
                    id: 'upload-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),
                    name: file.name,
                    size: file.size,
                    type: file.name.split('.').pop().toLowerCase(),
                    date: new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }),
                    uploaded: true,
                    fileObject: file
                };
                
                state.uploadedFiles.push(fileObj);
            });
            
            // Refresh file list
            const tab = document.getElementById(`terminal-${tabId}`);
            if (tab) {
                const fileList = tab.querySelector(`#fileList-${workspaceKey}`);
                if (fileList) {
                    const allFiles = [...state.config.mockFiles, ...state.uploadedFiles];
                    fileList.innerHTML = allFiles.map(file => `
                        <div class="qcm-file-item">
                            <input type="checkbox" onchange="toggleFileSelection('${workspaceKey}', '${file.id}')">
                            <div class="qcm-file-info">
                                <div class="qcm-file-name">${getFileIcon(file.type)} ${file.name}${file.uploaded ? ' (Uploaded)' : ''}</div>
                                <div class="qcm-file-meta">${formatSize(file.size)} | ${file.type.toUpperCase()}</div>
                            </div>
                        </div>
                    `).join('');
                }
            }
            
            log(`Uploaded ${files.length} file(s) to ${state.config.name}`, 'success', 'devtools');
        }
        
        // Update character count
        function updateCharCount(workspaceKey, tabId) {
            const tab = document.getElementById(`terminal-${tabId}`);
            if (!tab) return;
            
            const instructionsArea = tab.querySelector(`#instructions-${workspaceKey}`);
            const charCount = tab.querySelector(`#charCount-${workspaceKey}`);
            
            if (instructionsArea && charCount) {
                charCount.textContent = `${instructionsArea.value.length} characters`;
            }
        }
        
        // Send to Claude for analysis
        function sendToAnalysis(workspaceKey) {
            const state = window.workspaceStates[workspaceKey];
            if (!state) return;
            
            const instructionsArea = document.querySelector(`#instructions-${workspaceKey}`);
            const status = document.querySelector(`#status-${workspaceKey}`);
            const response = document.querySelector(`#response-${workspaceKey}`);
            
            if (!instructionsArea || !status || !response) return;
            
            if (state.selectedFiles.length === 0) {
                alert('Please select at least one file for analysis');
                return;
            }
            
            if (!instructionsArea.value.trim()) {
                alert('Please provide analysis parameters or select a template');
                return;
            }
            
            // Show analyzing state
            status.textContent = 'ANALYZING';
            status.className = 'review-status analyzing';
            response.innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <div class="spinner"></div>
                    <div style="margin-top: 20px; color: #e8922a;">Analyzing ${state.selectedFiles.length} file(s)...</div>
                </div>
            `;
            
            // Log to terminal
            log('ANALYSIS REQUEST', 'success', 'devtools');
            log(`Workspace: ${state.config.name}`, 'info', 'devtools');
            log(`Files: ${state.selectedFiles.length}`, 'info', 'devtools');
            state.selectedFiles.forEach(f => log(`  - ${f.name}`, 'info', 'devtools'));
            log('Sending to Claude...', 'info', 'devtools');
            
            // Simulate Claude response (in production, this would call actual API)
            setTimeout(() => {
                status.textContent = 'COMPLETE';
                status.className = 'review-status complete';
                response.innerHTML = generateMockAnalysis(workspaceKey, state);
                log('Analysis complete', 'success', 'devtools');
            }, 3000);
        }
        
        // Generate mock analysis response
        function generateMockAnalysis(workspaceKey, state) {
            return `
                <div class="review-section">
                    <div class="review-section-title">Analysis Summary</div>
                    <div style="padding: 15px; line-height: 1.8;">
                        <strong>Workspace:</strong> ${state.config.name}<br>
                        <strong>Files Analyzed:</strong> ${state.selectedFiles.length}<br>
                        <strong>Date:</strong> ${new Date().toLocaleDateString()}<br>
                        <strong>Status:</strong> <span style="color: #4ade80;">Complete</span>
                    </div>
                </div>
                
                <div class="review-section">
                    <div class="review-section-title">Documents Reviewed</div>
                    ${state.selectedFiles.map(file => `
                        <div style="padding: 10px; margin: 5px 0; background: rgba(232,146,42,0.05); border-left: 3px solid rgba(232,146,42,0.3);">
                            ${getFileIcon(file.type)} <strong>${file.name}</strong><br>
                            <span style="color: #999; font-size: 0.9rem;">${formatSize(file.size)} | ${file.type.toUpperCase()}</span>
                        </div>
                    `).join('')}
                </div>
                
                <div class="review-section">
                    <div class="review-section-title">Key Findings</div>
                    <div class="review-finding pass">
                        <strong>Analysis Complete:</strong> All ${state.selectedFiles.length} document(s) processed successfully using specified parameters.
                    </div>
                    <div style="padding: 15px; line-height: 1.8; color: #fff;">
                        This is a demonstration of the ${state.config.name} workspace. In production, this panel would display 
                        Claude's detailed analysis based on your configuration parameters and selected files.
                        The analysis would include findings, recommendations, and actionable insights specific to this workspace type.
                    </div>
                </div>
                
                <div class="review-section">
                    <div class="review-section-title">Recommendation</div>
                    <div class="review-recommendation">
                        <div style="font-size: 1.3rem; font-weight: 600; margin-bottom: 10px;">ANALYSIS READY FOR REVIEW</div>
                        <div style="font-size: 0.95rem;">
                            Full ${state.config.name} analysis capabilities will be available in production release.
                            Current workspace demonstrates complete 4-panel layout with file upload, search, and template functionality.
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; padding: 20px; color: #999; font-size: 0.9rem;">
                    Analysis completed at ${new Date().toLocaleTimeString()}
                </div>
            `;
        }
        
        // Save workspace configuration
        function saveWorkspaceConfig(workspaceKey) {
            const state = window.workspaceStates[workspaceKey];
            if (!state) return;
            
            const instructions = document.querySelector(`#instructions-${workspaceKey}`);
            if (!instructions) return;
            
            const config = {
                workspace: workspaceKey,
                selectedFiles: state.selectedFiles.map(f => f.id),
                instructions: instructions.value,
                savedDate: new Date().toISOString()
            };
            
            localStorage.setItem(`workspace_${workspaceKey}`, JSON.stringify(config));
            log(`Configuration saved for ${state.config.name}`, 'success', 'devtools');
            alert('Configuration saved successfully');
        }
        
        // Load workspace configuration
        function loadWorkspaceConfig(workspaceKey) {
            const saved = localStorage.getItem(`workspace_${workspaceKey}`);
            if (!saved) {
                alert('No saved configuration found');
                return;
            }
            
            const config = JSON.parse(saved);
            const instructions = document.querySelector(`#instructions-${workspaceKey}`);
            if (instructions) {
                instructions.value = config.instructions;
                updateCharCount(workspaceKey, null);
            }
            
            log(`Configuration loaded for ${workspaceKey}`, 'success', 'devtools');
            alert('Configuration loaded successfully');
        }
        
        // Clear workspace
        function clearWorkspace(workspaceKey) {
            if (!confirm('Clear all selections and parameters?')) return;
            
            const state = window.workspaceStates[workspaceKey];
            if (state) {
                state.selectedFiles = [];
                updateSelectedQueue(workspaceKey);
            }
            
            const instructions = document.querySelector(`#instructions-${workspaceKey}`);
            if (instructions) {
                instructions.value = '';
                updateCharCount(workspaceKey, null);
            }
            
            const templateSelect = document.querySelector(`#templateSelect-${workspaceKey}`);
            if (templateSelect) {
                templateSelect.value = '';
            }
            
            log(`Workspace cleared: ${state.config.name}`, 'info', 'devtools');
        }
        
        // Living Documents Browser
        function openLivingDocsBrowser() {
            const modal = document.getElementById('livingDocsModal');
            modal.classList.add('active');
            
            // Populate with living documents from 03-Living-Documents folder
            const docList = document.getElementById('livingDocsList');
            docList.innerHTML = livingDocuments.map(doc => `
                <div class="guide-item">
                    <span class="guide-name">${doc.name}</span>
                    <button class="guide-btn" onclick="event.stopPropagation(); openExternal('${doc.url}')">Open in Docs</button>
                </div>
            `).join('');
        }
        
        function closeLivingDocs(event) {
            if (event.target === event.currentTarget) {
                document.getElementById('livingDocsModal').classList.remove('active');
            }
        }
        
        function hideLivingDocs() {
            document.getElementById('livingDocsModal').classList.remove('active');
        }
        
        // Living Documents list - same format as User Guides
        const livingDocuments = [
            { name: 'Personal Diary (Master)', url: 'https://docs.google.com/document/d/1wyxrv-OjzuTGoCVy6zzbrX8yeuJdjVX5/edit' },
            { name: 'Technical Journal (Master)', url: 'https://docs.google.com/document/d/1RTATUsJCKpMtvOlqJfQtWRrsefJHTROe/edit' },
            { name: 'Operational Journal (Master)', url: 'https://docs.google.com/document/d/1BnwIfeZ4WbXhgYA9EBi9zJGknSQbkHBL/edit' },
            { name: 'Code Repository (Master)', url: 'https://docs.google.com/document/d/1TXVkYtvijvUU8vKaqmf1U3KCBXO2EoE1/edit' },
            { name: 'Bills POV Updates (Master)', url: 'https://docs.google.com/document/d/16omGyTL9lAZTqFRMDFC5Y7tApl5CNXiG/edit' },
            { name: 'Protocol Violations (Master)', url: 'https://docs.google.com/document/d/1GlL-MZnJZMIkezGruxd_3BgDTEVsGv2H/edit' },
            { name: 'Enterprise Hub Version Log', url: 'https://docs.google.com/document/d/1VrvljG8FMsHALWRHvD5tSWh0jSEsLPr9/edit' },
            { name: 'Master Documentation Index', url: 'https://docs.google.com/document/d/1B0N5coRrwTlfCS_3bQYfCZmZsJ1eKDD6suUe_NnbmWw/edit' },
            { name: 'Trajanus Hub Status', url: 'https://docs.google.com/document/d/1pGcmgi_R8Tyjz_4uMdYn9L58kiN6dCosb3HhjEo6djs/edit' },
            { name: 'Operational Protocols Quick Reference', url: 'https://docs.google.com/document/d/1KWErzNHmm-77jlXX7C5EiYCqVodnHtvMihejKjSyzsU/edit' },
            { name: 'Deep Dive Context', url: 'https://docs.google.com/document/d/1SfS4GGSu_0RCCZvqK6mqT6YF7IpqULhHrlDQzBH_aRg/edit' }
        ];
        
        function OLD_openLivingDocsBrowser_REMOVED() {
            // Check if browser already open
            if (document.getElementById('livingDocsBrowserOverlay')) {
                log('Living Documents Browser already open', 'warning', 'devtools');
                return;
            }
            
            // Create overlay
            const overlay = document.createElement('div');
            overlay.id = 'livingDocsBrowserOverlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.85);
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            `;
            
            // Create browser panel
            const panel = document.createElement('div');
            panel.style.cssText = `
                background: #1a1a1a;
                border: 2px solid #9B7E52;
                border-radius: 8px;
                width: 90%;
                max-width: 1200px;
                height: 85%;
                display: flex;
                flex-direction: column;
                box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            `;
            
            panel.innerHTML = `
                <div style="background: linear-gradient(180deg, #9B7E52 0%, #7B6142 100%); padding: 20px; border-radius: 6px 6px 0 0; display: flex; align-items: center; justify-content: space-between;">
                    <div>
                        <h2 style="margin: 0; color: #fff; font-size: 1.5rem; font-weight: 600;">LIVING DOCUMENTS BROWSER</h2>
                        <div style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-top: 5px;">Session summaries, daily journals, and protocol documents</div>
                    </div>
                    <button onclick="closeLivingDocsBrowser()" style="background: rgba(255,255,255,0.2); border: none; color: #fff; font-size: 1.8rem; width: 40px; height: 40px; border-radius: 4px; cursor: pointer; line-height: 1;"></button>
                </div>
                
                <div style="padding: 20px; border-bottom: 1px solid rgba(155,126,82,0.3);">
                    <div style="display: grid; grid-template-columns: 1fr auto auto; gap: 15px; align-items: center;">
                        <input type="text" id="livingDocsSearch" placeholder="Search by filename, date, or content..." style="padding: 12px; background: rgba(0,0,0,0.4); border: 1px solid rgba(155,126,82,0.5); color: #fff; border-radius: 4px; font-size: 1rem;">
                        <select id="livingDocsSort" style="padding: 12px; background: rgba(0,0,0,0.4); border: 1px solid rgba(155,126,82,0.5); color: #fff; border-radius: 4px;">
                            <option value="newest">Newest First</option>
                            <option value="oldest">Oldest First</option>
                            <option value="alpha">Alphabetical</option>
                        </select>
                        <button onclick="refreshLivingDocs()" class="session-btn" style="background: linear-gradient(180deg, #e8922a 0%, #cc6e1f 100%); padding: 12px 20px;">Refresh</button>
                    </div>
                </div>
                
                <div id="livingDocsList" style="flex: 1; overflow-y: auto; padding: 20px;">
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        <div style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;">[LOADING]</div>
                        <div style="font-size: 1.2rem;">Loading living documents...</div>
                    </div>
                </div>
                
                <div style="padding: 15px 20px; background: rgba(0,0,0,0.3); border-top: 1px solid rgba(155,126,82,0.3); display: flex; justify-content: space-between; align-items: center; border-radius: 0 0 6px 6px;">
                    <div id="livingDocsCount" style="color: #999; font-size: 0.9rem;">0 documents</div>
                    <button onclick="closeLivingDocsBrowser()" class="session-btn" style="background: rgba(155,126,82,0.3);">Close</button>
                </div>
            `;
            
            overlay.appendChild(panel);
            document.body.appendChild(overlay);
            
            // Load documents
            loadLivingDocuments();
            
            // Setup search
            document.getElementById('livingDocsSearch').addEventListener('input', filterLivingDocs);
            document.getElementById('livingDocsSort').addEventListener('change', sortLivingDocs);
            
            log('Opened Living Documents Browser', 'success', 'devtools');
        }
        
        // Close Living Documents Browser
        function closeLivingDocsBrowser() {
            const overlay = document.getElementById('livingDocsBrowserOverlay');
            if (overlay) {
                overlay.remove();
                log('Closed Living Documents Browser', 'info', 'devtools');
            }
        }
        
        // Load living documents from Google Drive
        async function loadLivingDocuments() {
            const listDiv = document.getElementById('livingDocsList');
            
            try {
                // Mock data for now - will connect to Google Drive API
                const mockDocs = [
                    { name: '2025-12-01_Session_Summary_Final.md', date: '2025-12-01T23:45:00Z', size: 46000, type: 'md' },
                    { name: '2025-12-01_Daily_Journal.md', date: '2025-12-01T22:30:00Z', size: 38000, type: 'md' },
                    { name: '2025-11-30_Session_Summary.md', date: '2025-11-30T23:20:00Z', size: 52000, type: 'md' },
                    { name: '2025-11-30_Daily_Journal.md', date: '2025-11-30T21:15:00Z', size: 41000, type: 'md' },
                    { name: '2025-11-29_Session_Summary.md', date: '2025-11-29T23:50:00Z', size: 48000, type: 'md' },
                    { name: 'Bills_POV_Master.docx', date: '2025-11-29T20:00:00Z', size: 91000, type: 'docx' },
                    { name: 'Operational_Protocols_v2.docx', date: '2025-11-28T19:30:00Z', size: 163000, type: 'docx' },
                    { name: '2025-11-27_Session_Summary.md', date: '2025-11-27T23:15:00Z', size: 55000, type: 'md' }
                ];
                
                // Store globally for filtering/sorting
                window.livingDocsData = mockDocs;
                
                renderLivingDocs(mockDocs);
                
            } catch (error) {
                listDiv.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #e74c3c;">
                        <div style="font-size: 3rem; margin-bottom: 20px;">[ERROR]</div>
                        <div style="font-size: 1.2rem; margin-bottom: 10px;">Failed to load living documents</div>
                        <div style="font-size: 0.9rem; color: #999;">${error.message}</div>
                    </div>
                `;
                log('Error loading living documents: ' + error.message, 'error', 'devtools');
            }
        }
        
        // Render living documents list
        function renderLivingDocs(docs) {
            const listDiv = document.getElementById('livingDocsList');
            const countDiv = document.getElementById('livingDocsCount');
            
            if (!docs || docs.length === 0) {
                listDiv.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        <div style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;">[EMPTY]</div>
                        <div style="font-size: 1.2rem;">No living documents found</div>
                        <div style="font-size: 0.9rem; margin-top: 10px;">Documents will appear here after End of Session uploads</div>
                    </div>
                `;
                countDiv.textContent = '0 documents';
                return;
            }
            
            // Group by date
            const grouped = {};
            docs.forEach(doc => {
                const date = new Date(doc.date);
                const dateKey = date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                if (!grouped[dateKey]) grouped[dateKey] = [];
                grouped[dateKey].push(doc);
            });
            
            // Render grouped list
            let html = '';
            for (const [dateKey, dateDocs] of Object.entries(grouped)) {
                html += `
                    <div style="margin-bottom: 30px;">
                        <div style="font-size: 1.2rem; font-weight: 600; color: #9B7E52; margin-bottom: 15px; padding-bottom: 8px; border-bottom: 2px solid rgba(155,126,82,0.3);">
                            ${dateKey}
                        </div>
                `;
                
                dateDocs.forEach(doc => {
                    const date = new Date(doc.date);
                    const time = date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
                    const size = formatSize(doc.size);
                    const icon = getFileIcon(doc.type);
                    
                    html += `
                        <div onclick="viewLivingDoc('${doc.name}')" style="
                            background: rgba(155,126,82,0.05);
                            border: 1px solid rgba(155,126,82,0.2);
                            border-radius: 4px;
                            padding: 15px;
                            margin-bottom: 10px;
                            cursor: pointer;
                            transition: all 0.2s;
                        " onmouseover="this.style.background='rgba(155,126,82,0.15)'; this.style.borderColor='rgba(155,126,82,0.4)'" onmouseout="this.style.background='rgba(155,126,82,0.05)'; this.style.borderColor='rgba(155,126,82,0.2)'">
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <div style="flex: 1;">
                                    <div style="font-size: 1.1rem; font-weight: 600; color: #fff; margin-bottom: 5px;">
                                        ${icon} ${doc.name}
                                    </div>
                                    <div style="font-size: 0.9rem; color: #999;">
                                        ${time} | ${size} | ${doc.type.toUpperCase()}
                                    </div>
                                </div>
                                <div style="color: #9B7E52; font-size: 1.5rem;"></div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
            }
            
            listDiv.innerHTML = html;
            countDiv.textContent = `${docs.length} document${docs.length !== 1 ? 's' : ''}`;
        }
        
        // Filter living docs by search term
        function filterLivingDocs() {
            const searchTerm = document.getElementById('livingDocsSearch').value.toLowerCase();
            const allDocs = window.livingDocsData || [];
            
            if (!searchTerm) {
                renderLivingDocs(allDocs);
                return;
            }
            
            const filtered = allDocs.filter(doc => 
                doc.name.toLowerCase().includes(searchTerm) ||
                new Date(doc.date).toLocaleDateString().includes(searchTerm)
            );
            
            renderLivingDocs(filtered);
        }
        
        // Sort living docs
        function sortLivingDocs() {
            const sortValue = document.getElementById('livingDocsSort').value;
            const allDocs = [...(window.livingDocsData || [])];
            
            if (sortValue === 'newest') {
                allDocs.sort((a, b) => new Date(b.date) - new Date(a.date));
            } else if (sortValue === 'oldest') {
                allDocs.sort((a, b) => new Date(a.date) - new Date(b.date));
            } else if (sortValue === 'alpha') {
                allDocs.sort((a, b) => a.name.localeCompare(b.name));
            }
            
            renderLivingDocs(allDocs);
        }
        
        // Refresh living docs
        function refreshLivingDocs() {
            log('Refreshing living documents...', 'info', 'devtools');
            loadLivingDocuments();
        }
        
        // View living document
        function viewLivingDoc(filename) {
            log(`Opening document: ${filename}`, 'info', 'devtools');
            
            // Create document viewer overlay
            const viewerOverlay = document.createElement('div');
            viewerOverlay.id = 'livingDocViewerOverlay';
            viewerOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.95);
                z-index: 10001;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            `;
            
            const viewerPanel = document.createElement('div');
            viewerPanel.style.cssText = `
                background: #1a1a1a;
                border: 2px solid #9B7E52;
                border-radius: 8px;
                width: 90%;
                max-width: 1000px;
                height: 90%;
                display: flex;
                flex-direction: column;
                box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            `;
            
            viewerPanel.innerHTML = `
                <div style="background: linear-gradient(180deg, #9B7E52 0%, #7B6142 100%); padding: 15px 20px; border-radius: 6px 6px 0 0; display: flex; align-items: center; justify-content: space-between;">
                    <div style="color: #fff; font-size: 1.2rem; font-weight: 600;">${filename}</div>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="copyDocContent()" class="session-btn" style="background: rgba(255,255,255,0.2); padding: 8px 15px;">Copy</button>
                        <button onclick="downloadDoc('${filename}')" class="session-btn" style="background: rgba(255,255,255,0.2); padding: 8px 15px;">Download</button>
                        <button onclick="closeDocViewer()" style="background: rgba(255,255,255,0.2); border: none; color: #fff; font-size: 1.5rem; width: 35px; height: 35px; border-radius: 4px; cursor: pointer; line-height: 1;"></button>
                    </div>
                </div>
                
                <div id="docContent" style="flex: 1; overflow-y: auto; padding: 30px; color: #fff; line-height: 1.8; font-size: 1rem; background: rgba(0,0,0,0.3);">
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        <div style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;">[LOADING]</div>
                        <div style="font-size: 1.2rem;">Loading document content...</div>
                    </div>
                </div>
                
                <div style="padding: 15px 20px; background: rgba(0,0,0,0.3); border-top: 1px solid rgba(155,126,82,0.3); text-align: right; border-radius: 0 0 6px 6px;">
                    <button onclick="closeDocViewer()" class="session-btn" style="background: rgba(155,126,82,0.3);">Back to List</button>
                </div>
            `;
            
            viewerOverlay.appendChild(viewerPanel);
            document.body.appendChild(viewerOverlay);
            
            // Load document content (mock for now)
            setTimeout(() => {
                const contentDiv = document.getElementById('docContent');
                contentDiv.innerHTML = `
                    <div style="max-width: 800px; margin: 0 auto;">
                        <h1 style="color: #9B7E52; margin-bottom: 20px;">${filename}</h1>
                        <div style="color: #999; margin-bottom: 30px; font-size: 0.9rem;">
                            This is a placeholder for document content. In production, this will load the actual document from Google Drive.
                        </div>
                        <div style="border-left: 3px solid #9B7E52; padding-left: 20px; margin: 20px 0;">
                            <p>Document content will be fetched from Google Drive and displayed here with proper formatting.</p>
                            <p>Markdown files will be rendered with syntax highlighting.</p>
                            <p>Word documents will be converted and displayed.</p>
                            <p>Users can copy content, download files, or return to the list.</p>
                        </div>
                    </div>
                `;
            }, 500);
        }
        
        // Close document viewer
        function closeDocViewer() {
            const viewer = document.getElementById('livingDocViewerOverlay');
            if (viewer) viewer.remove();
        }
        
        // Copy document content
        function copyDocContent() {
            const content = document.getElementById('docContent').innerText;
            navigator.clipboard.writeText(content).then(() => {
                log('Document content copied to clipboard', 'success', 'devtools');
                alert('Content copied to clipboard!');
            }).catch(err => {
                log('Failed to copy: ' + err, 'error', 'devtools');
            });
        }
        
        // Download document
        function downloadDoc(filename) {
            log(`Download requested: ${filename}`, 'info', 'devtools');
            alert('Download functionality will be implemented with Google Drive API integration');
        }

        
        // Original QCM workspace opener (preserved)
        function openQCMWorkspace() {
            // Get the template workspace HTML
            const templateWorkspace = document.getElementById('terminal-qcm-submittal');
            const workspaceHTML = templateWorkspace.innerHTML;
            
            // Create new tab with workspace content
            const tabId = createWorkspaceTab('Submittal Review', workspaceHTML);
            
            if (tabId) {
                // Initialize workspace in new tab after short delay (let DOM render)
                setTimeout(() => {
                    const newTab = document.getElementById(`terminal-${tabId}`);
                    if (newTab) {
                        // Load mock files in this specific tab instance
                        loadQCMFilesInTab(tabId);
                        
                        // Setup event listeners for this tab
                        setupQCMEventListenersInTab(tabId);
                    }
                }, 100);
            }
        }
        
        // Load QCM files in specific tab
        function loadQCMFilesInTab(tabId) {
            const tab = document.getElementById(`terminal-${tabId}`);
            if (!tab) return;
            
            const fileList = tab.querySelector('#qcmFiles');
            if (!fileList) return;
            
            const files = qcmMockFiles.map(file => `
                <div class="qcm-file-item">
                    <input type="checkbox" onchange="toggleQCMFileSelection('${file.id}')">
                    <div class="qcm-file-info">
                        <div class="qcm-file-name">${getFileIcon(file.type)} ${file.name}</div>
                        <div class="qcm-file-meta">${formatSize(file.size)} | ${file.type.toUpperCase()}</div>
                    </div>
                </div>
            `).join('');
            
            fileList.innerHTML = files;
        }
        
        // Setup event listeners in specific tab
        function setupQCMEventListenersInTab(tabId) {
            const tab = document.getElementById(`terminal-${tabId}`);
            if (!tab) return;
            
            const templateSelect = tab.querySelector('#qcmTemplateSelect');
            const instructionsArea = tab.querySelector('#qcmInstructions');
            
            if (templateSelect && instructionsArea) {
                // Template selection
                templateSelect.addEventListener('change', function() {
                    if (this.value && qcmTemplates[this.value]) {
                        instructionsArea.value = qcmTemplates[this.value];
                        updateCharCountInTab(tabId);
                    }
                });
                
                // Character count
                instructionsArea.addEventListener('input', () => updateCharCountInTab(tabId));
                updateCharCountInTab(tabId);
            }
        }
        
        // Update character count in specific tab
        function updateCharCountInTab(tabId) {
            const tab = document.getElementById(`terminal-${tabId}`);
            if (!tab) return;
            
            const instructionsArea = tab.querySelector('#qcmInstructions');
            const charCount = tab.querySelector('#qcmCharCount');
            
            if (instructionsArea && charCount) {
                charCount.textContent = `${instructionsArea.value.length} characters`;
            }
        }
        
        // Open File Manager workspace
        function openFileManager() {
            log('', 'info', 'main');
            log('FILE MANAGER', 'success', 'main');
            log('', 'info', 'main');
            log('This will open a file management workspace where you can:', 'info', 'main');
            log('   Browse project files from Google Drive', 'info', 'main');
            log('   Add files to workspace', 'info', 'main');
            log('   Organize project documents', 'info', 'main');
            log('   Send files to Claude for analysis', 'info', 'main');
            log('   Chat interface integration (right panel)', 'info', 'main');
            log('', 'info', 'main');
            log('Coming in Phase 2: Full file management interface', 'info', 'main');
            log('', 'info', 'main');
        }
        
        // Generic project workspace opener
        function openProjectWorkspace(projectName, projectIcon = '') {
            // Create simple workspace HTML
            const workspaceHTML = `
                <div class="qcm-workspace-container" style="height: 100%; display: flex; flex-direction: column;">
                    <div class="qcm-workspace-header">
                        <div class="success">[Ready] ${projectName} Workspace</div>
                        <div class="info">[Info] Interactive workspace for ${projectName} tools</div>
                    </div>
                    
                    <div style="flex: 1; padding: 20px; overflow-y: auto;">
                        <div style="max-width: 800px; margin: 0 auto;">
                            <div style="text-align: center; padding: 40px 20px;">
                                <div style="font-size: 4rem; margin-bottom: 20px;">${projectIcon}</div>
                                <div style="font-size: 1.5rem; color: var(--orange-light); font-weight: 600; margin-bottom: 15px;">
                                    ${projectName} Workspace
                                </div>
                                <div style="font-size: 1rem; color: #fff; line-height: 1.8; margin-bottom: 30px;">
                                    This workspace is ready for development. The full ${projectName} toolset
                                    will be implemented here with the same 4-panel + chat interface pattern
                                    established in the QCM Submittal Review workspace.
                                </div>
                            </div>
                            
                            <div style="background: rgba(232, 146, 42, 0.1); border-left: 3px solid var(--orange-mid); padding: 20px; border-radius: 6px; margin-top: 20px;">
                                <div style="color: var(--orange-light); font-weight: 600; margin-bottom: 12px;">
                                    Planned Features
                                </div>
                                <div style="color: #fff; line-height: 1.8;">
                                     4-panel workspace layout (Browse, Configure, Queue, Response)<br>
                                     Claude integration for analysis and assistance<br>
                                     File management and document processing<br>
                                     Template system for common workflows<br>
                                     Save/load workspace configurations<br>
                                     Review history and audit trail<br>
                                     Export capabilities (PDF, Excel, etc.)
                                </div>
                            </div>
                            
                            <div style="margin-top: 30px; text-align: center;">
                                <div style="color: var(--gray-light); font-size: 0.9rem;">
                                    Workspace opened successfully. Close this tab when finished.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Create tab
            const tabId = createWorkspaceTab(projectName, workspaceHTML);
            
            if (tabId) {
                log(`${projectName} workspace opened`, 'success', 'devtools');
            }
        }
        
        // Close QCM workspace (no longer needed - use tab close)
        function closeQCMWorkspace() {
            // This function is deprecated - tabs now close via closeTab
            log('Use the  button to close workspace tabs', 'info', 'main');
        }
        
        // Load files into browser
        function loadQCMFiles() {
            const fileList = document.getElementById('qcmFiles');
            
            const html = qcmMockFiles.map(file => `
                <div class="qcm-file-item" onclick="toggleQCMFileSelection('${file.id}')">
                    <input type="checkbox" id="qcm-file-${file.id}" onclick="event.stopPropagation(); toggleQCMFileSelection('${file.id}')">
                    <div class="qcm-file-info">
                        <div class="qcm-file-name">${getFileIcon(file.type)} ${file.name}</div>
                        <div class="qcm-file-meta">${formatSize(file.size)} | ${file.type.toUpperCase()}</div>
                    </div>
                </div>
            `).join('');
            
            fileList.innerHTML = html || '<div class="info" style="padding: 20px; text-align: center;">No files found</div>';
        }
        
        function getFileIcon(type) {
            const icons = {
                'pdf': '[PDF]',
                'dwg': '[DWG]',
                'docx': '[DOC]',
                'xlsx': '[XLS]',
                'md': '[MD]',
                'jpg': '[IMG]',
                'png': '[IMG]',
                'zip': '[ZIP]'
            };
            return icons[type] || '[FILE]';
        }
        
        // Toggle file selection
        function toggleQCMFileSelection(fileId) {
            const checkbox = document.getElementById(`qcm-file-${fileId}`);
            checkbox.checked = !checkbox.checked;
            
            const file = qcmMockFiles.find(f => f.id === fileId);
            if (!file) return;
            
            if (checkbox.checked) {
                // Add to selected
                if (!qcmSelectedFiles.find(f => f.id === fileId)) {
                    qcmSelectedFiles.push(file);
                }
            } else {
                // Remove from selected
                qcmSelectedFiles = qcmSelectedFiles.filter(f => f.id !== fileId);
            }
            
            updateQCMSelectedQueue();
        }
        
        // Update selected files queue
        function updateQCMSelectedQueue() {
            const selectedList = document.getElementById('qcmSelectedList');
            const selectedCount = document.getElementById('qcmSelectedCount');
            const totalSize = document.getElementById('qcmTotalSize');
            
            selectedCount.textContent = qcmSelectedFiles.length;
            
            if (qcmSelectedFiles.length === 0) {
                selectedList.innerHTML = '<div class="info" style="padding: 20px; text-align: center;">No documents selected yet</div>';
                totalSize.textContent = '0 MB';
                return;
            }
            
            const html = qcmSelectedFiles.map((file, index) => `
                <div class="qcm-selected-item">
                    <div class="qcm-selected-header">
                        <div class="qcm-selected-name">${index + 1}. ${getFileIcon(file.type)} ${file.name}</div>
                        <button class="qcm-remove-btn" onclick="removeQCMFile('${file.id}')"> Remove</button>
                    </div>
                    <div class="qcm-selected-meta">${formatSize(file.size)} | Modified: Nov 28, 2025</div>
                </div>
            `).join('');
            
            selectedList.innerHTML = html;
            
            // Calculate total size
            const total = qcmSelectedFiles.reduce((sum, file) => sum + file.size, 0);
            totalSize.textContent = formatSize(total);
        }
        
        // Remove file from queue
        function removeQCMFile(fileId) {
            qcmSelectedFiles = qcmSelectedFiles.filter(f => f.id !== fileId);
            const checkbox = document.getElementById(`qcm-file-${fileId}`);
            if (checkbox) checkbox.checked = false;
            updateQCMSelectedQueue();
        }
        
        // Setup event listeners
        function setupQCMEventListeners() {
            // Template selector
            const templateSelect = document.getElementById('qcmTemplateSelect');
            templateSelect.addEventListener('change', (e) => {
                const template = e.target.value;
                if (template && qcmTemplates[template]) {
                    document.getElementById('qcmInstructions').value = qcmTemplates[template];
                    updateCharCount();
                }
            });
            
            // Instructions textarea character count
            const instructions = document.getElementById('qcmInstructions');
            instructions.addEventListener('input', updateCharCount);
        }
        
        function updateCharCount() {
            const instructions = document.getElementById('qcmInstructions');
            const charCount = document.getElementById('qcmCharCount');
            charCount.textContent = instructions.value.length;
        }
        
        // Send to Claude for review
        function sendToClaudeReview() {
            if (qcmSelectedFiles.length === 0) {
                log('No documents selected', 'warning', 'qcm-submittal');
                alert('Please select at least one document to review');
                return;
            }
            
            const instructions = document.getElementById('qcmInstructions').value.trim();
            if (!instructions) {
                log('No review instructions provided', 'warning', 'qcm-submittal');
                alert('Please provide review instructions for Claude');
                return;
            }
            
            log('', 'info', 'qcm-submittal');
            log('SUBMITTAL REVIEW REQUEST', 'success', 'qcm-submittal');
            log(`Project: Guatemala SOUTHCOM`, 'info', 'qcm-submittal');
            log(`Date: ${new Date().toLocaleDateString()}`, 'info', 'qcm-submittal');
            log(`Reviewer: Claude AI`, 'info', 'qcm-submittal');
            log('', 'info', 'qcm-submittal');
            log(`Documents for Review (${qcmSelectedFiles.length}):`, 'info', 'qcm-submittal');
            qcmSelectedFiles.forEach(file => {
                log(`  - ${file.name}`, 'info', 'qcm-submittal');
            });
            log('', 'info', 'qcm-submittal');
            log('', 'info', 'qcm-submittal');
            log('Uploading files and sending to Claude...', 'success', 'qcm-submittal');
            
            // Show 4th panel with loading state
            showReviewPanel();
            
            // Simulate Claude analysis (in production, this would be actual API call)
            setTimeout(() => {
                displayReviewResults();
            }, 3000);
        }
        
        // Show the review panel and switch to 4-panel layout
        function showReviewPanel() {
            const reviewStatus = document.getElementById('qcmReviewStatus');
            const reviewContent = document.getElementById('qcmReviewContent');
            
            // Set loading state
            reviewStatus.textContent = 'ANALYZING';
            reviewStatus.className = 'review-status analyzing';
            
            reviewContent.innerHTML = `
                <div class="loading-spinner">
                    <div class="spinner"></div>
                    <div class="loading-text">Claude is analyzing ${qcmSelectedFiles.length} documents...</div>
                    <div style="margin-top: 10px; font-size: 0.85rem; color: #fff;">
                        This may take 30-60 seconds depending on document size
                    </div>
                </div>
            `;
        }
        
        // Display the review results
        function displayReviewResults() {
            const reviewStatus = document.getElementById('qcmReviewStatus');
            const reviewContent = document.getElementById('qcmReviewContent');
            
            // Update status
            reviewStatus.textContent = 'COMPLETE';
            reviewStatus.className = 'review-status complete';
            
            // Generate sample review (in production, this comes from Claude API)
            const review = generateSampleReview();
            
            // Display review
            reviewContent.innerHTML = review;
            
            // Log completion to terminal
            log('', 'success', 'qcm-submittal');
            log('REVIEW COMPLETE', 'success', 'qcm-submittal');
            log('Recommendation: APPROVE AS NOTED', 'info', 'qcm-submittal');
            log('Deficiencies: 3 items requiring correction', 'warning', 'qcm-submittal');
            log('View full review in right panel ', 'info', 'qcm-submittal');
            log('', 'success', 'qcm-submittal');
            
            // Save to review history
            saveToReviewHistory();
        }
        
        // Generate sample review HTML
        function generateSampleReview() {
            const date = new Date().toLocaleDateString();
            return `
                <div class="review-section">
                    <div class="review-section-title">Executive Summary</div>
                    <div class="review-section-content">
                        Reviewed ${qcmSelectedFiles.length} documents for Submittal 001 - Structural Steel.
                        Overall assessment indicates compliance with contract requirements with minor corrections needed.
                        <strong>3 items require attention prior to fabrication.</strong>
                    </div>
                </div>
                
                <div class="review-section">
                    <div class="review-section-title">Documents Reviewed</div>
                    <div class="review-section-content">
                        ${qcmSelectedFiles.map(file => `
                            <div style="padding: 6px 0;">
                                ${getFileIcon(file.type)} <strong>${file.name}</strong> (${formatSize(file.size)})
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="review-section">
                    <div class="review-section-title">Compliance Findings</div>
                    <div class="review-section-content">
                        <div class="review-finding pass">
                            <span class="review-finding-icon"></span>
                            <strong>PASS:</strong> Material specifications match Spec 05120 Section 2.1
                        </div>
                        <div class="review-finding pass">
                            <span class="review-finding-icon"></span>
                            <strong>PASS:</strong> Weld symbols comply with AWS D1.1 standards
                        </div>
                        <div class="review-finding pass">
                            <span class="review-finding-icon"></span>
                            <strong>PASS:</strong> Beam sizes match structural drawings S-201 through S-205
                        </div>
                        <div class="review-finding warning">
                            <span class="review-finding-icon"></span>
                            <strong>MINOR:</strong> Connection detail at Column B-3 shows (2) 3/4" bolts, 
                            contract drawings S-203 Detail 5/S-203 shows (4) 3/4" bolts. 
                            <strong>Action:</strong> Revise shop drawings to match contract.
                        </div>
                    </div>
                </div>
                
                <div class="review-section">
                    <div class="review-section-title">Dimensional Verification</div>
                    <div class="review-section-content">
                        <div class="review-finding pass">
                            <span class="review-finding-icon"></span>
                            W18x50 beam lengths verified against contract drawings
                        </div>
                        <div class="review-finding pass">
                            <span class="review-finding-icon"></span>
                            Connection dimensions within acceptable tolerance
                        </div>
                        <div class="review-finding warning">
                            <span class="review-finding-icon"></span>
                            <strong>MINOR:</strong> Elevation at Grid B-3 shown as +10'-6", contract shows +10'-8". 
                            <strong>Action:</strong> Verify correct elevation with structural engineer.
                        </div>
                    </div>
                </div>
                
                <div class="review-section">
                    <div class="review-section-title">Deficiencies Requiring Correction</div>
                    <div class="review-section-content">
                        <div class="deficiency-item">
                            <div class="deficiency-number">1. Connection Detail Bolt Count Discrepancy</div>
                            <div class="deficiency-description">
                                Shop drawings show (2) 3/4" bolts at Column B-3 connection, 
                                contract requires (4) 3/4" bolts per Detail 5/S-203.
                            </div>
                            <div class="deficiency-meta">
                                <strong>Reference:</strong> Sheet S-203 Detail 5/S-203 | 
                                <strong>Severity:</strong> MODERATE | 
                                <strong>Impact:</strong> Affects load capacity
                            </div>
                        </div>
                        
                        <div class="deficiency-item">
                            <div class="deficiency-number">2. Elevation Discrepancy at Grid B-3</div>
                            <div class="deficiency-description">
                                Beam elevation shown as +10'-6" on shop drawings, 
                                contract drawings show +10'-8" at same location.
                            </div>
                            <div class="deficiency-meta">
                                <strong>Reference:</strong> Sheet S-201 Grid B-3 | 
                                <strong>Severity:</strong> MINOR | 
                                <strong>Impact:</strong> May affect connections
                            </div>
                        </div>
                        
                        <div class="deficiency-item">
                            <div class="deficiency-number">3. Missing Weld Size Specification</div>
                            <div class="deficiency-description">
                                Connection plate detail on Shop Drawing Sheet 3, Detail A does not 
                                specify weld size for attachment to beam flange.
                            </div>
                            <div class="deficiency-meta">
                                <strong>Reference:</strong> Shop Drawing Sheet 3, Detail A | 
                                <strong>Severity:</strong> MINOR | 
                                <strong>Impact:</strong> Requires clarification
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="review-section">
                    <div class="review-section-title">Material Verification</div>
                    <div class="review-section-content">
                        <div class="review-finding pass">
                            <span class="review-finding-icon"></span>
                            Steel grade A992/A992M per specification requirements
                        </div>
                        <div class="review-finding pass">
                            <span class="review-finding-icon"></span>
                            Mill certifications referenced (to be provided with material delivery)
                        </div>
                        <div class="review-finding pass">
                            <span class="review-finding-icon"></span>
                            Welding procedures qualified per AWS D1.1
                        </div>
                    </div>
                </div>
                
                <div class="review-recommendation">
                    <div class="review-recommendation-label">RECOMMENDATION</div>
                    <div class="review-recommendation-value"> APPROVE AS NOTED</div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--cream);">
                        Fabrication may proceed upon correction of items 1-3 above. 
                        Submit revised shop drawings showing corrections. 
                        No resubmittal review required if only these items are corrected.
                    </div>
                </div>
                
                <div class="review-section">
                    <div class="review-section-title">Reviewer Notes</div>
                    <div class="review-section-content" style="font-style: italic; color: var(--gray-light);">
                        Connection at Column B-3 is critical load path. Verify bolt count with structural 
                        engineer before fabrication. All other details are compliant and constructible. 
                        Quality of shop drawings is excellent overall.
                    </div>
                </div>
                
                <div style="margin-top: 25px; padding: 15px; background: rgba(45, 24, 16, 0.6); border-radius: 4px; border-top: 1px solid rgba(204, 110, 31, 0.3); font-size: 0.85rem; color: var(--gray-light);">
                    <div><strong>Review completed:</strong> ${date} at ${new Date().toLocaleTimeString()}</div>
                    <div><strong>Reviewer:</strong> Claude AI (Structural Analysis Module)</div>
                    <div><strong>Next action:</strong> Contractor to submit revised drawings addressing items 1-3</div>
                </div>
            `;
        }
        
        // Save QCM setup
        function saveQCMSetup() {
            const setupName = prompt('Enter a name for this setup:', `Submittal Review ${new Date().toLocaleDateString()}`);
            if (!setupName) return;
            
            const setup = {
                name: setupName,
                date: new Date().toISOString(),
                files: qcmSelectedFiles,
                instructions: document.getElementById('qcmInstructions').value,
                template: document.getElementById('qcmTemplateSelect').value
            };
            
            // Save to localStorage
            const saved = JSON.parse(localStorage.getItem('qcm_setups') || '{}');
            const key = setupName.toLowerCase().replace(/[^a-z0-9]/g, '_');
            saved[key] = setup;
            localStorage.setItem('qcm_setups', JSON.stringify(saved));
            
            log(`Setup saved: ${setupName}`, 'success', 'qcm-submittal');
        }
        
        // Load QCM setup
        function loadQCMSetup() {
            const saved = JSON.parse(localStorage.getItem('qcm_setups') || '{}');
            const keys = Object.keys(saved);
            
            if (keys.length === 0) {
                alert('No saved setups found');
                return;
            }
            
            const setupList = keys.map((key, i) => `${i + 1}. ${saved[key].name}`).join('\n');
            const selection = prompt(`Select a setup to load:\n\n${setupList}\n\nEnter number:`);
            
            if (!selection) return;
            
            const index = parseInt(selection) - 1;
            if (index < 0 || index >= keys.length) {
                alert('Invalid selection');
                return;
            }
            
            const setup = saved[keys[index]];
            
            // Load template
            document.getElementById('qcmTemplateSelect').value = setup.template || '';
            
            // Load instructions
            document.getElementById('qcmInstructions').value = setup.instructions || '';
            updateCharCount();
            
            // Load files
            qcmSelectedFiles = setup.files || [];
            qcmSelectedFiles.forEach(file => {
                const checkbox = document.getElementById(`qcm-file-${file.id}`);
                if (checkbox) checkbox.checked = true;
            });
            updateQCMSelectedQueue();
            
            log(`Loaded setup: ${setup.name}`, 'success', 'qcm-submittal');
        }
        
        // Clear workspace
        function clearQCMWorkspace() {
            if (!confirm('Clear all selections and instructions?')) return;
            
            // Clear selections
            qcmSelectedFiles = [];
            document.querySelectorAll('.qcm-file-item input[type="checkbox"]').forEach(cb => cb.checked = false);
            updateQCMSelectedQueue();
            
            // Clear instructions
            document.getElementById('qcmInstructions').value = '';
            document.getElementById('qcmTemplateSelect').value = '';
            updateCharCount();
            
            log('Workspace cleared', 'success', 'qcm-submittal');
        }
        
        // Close review panel and return to 3-panel layout
        function closeReviewPanel() {
            const reviewStatus = document.getElementById('qcmReviewStatus');
            const reviewContent = document.getElementById('qcmReviewContent');
            
            // Reset to waiting state
            reviewStatus.textContent = 'WAITING';
            reviewStatus.className = 'review-status waiting';
            
            reviewContent.innerHTML = `
                <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 20px;"></div>
                    <div style="font-size: 1.1rem; color: var(--orange-light); font-weight: 500; margin-bottom: 10px;">
                        Claude Response Panel
                    </div>
                    <div style="font-size: 0.9rem; color: #fff; line-height: 1.6;">
                        Select documents and add review instructions, then click<br>
                        <strong>"Send to Claude for Review"</strong><br>
                        to see detailed analysis results here.
                    </div>
                </div>
            `;
            
            log('Review panel reset', 'info', 'qcm-submittal');
        }
        
        // Save review to Google Drive
        function saveReviewToDrive() {
            const date = new Date().toISOString().split('T')[0];
            const filename = `Submittal_001_Steel_Review_${date}.pdf`;
            
            log('', 'info', 'qcm-submittal');
            log('SAVING TO GOOGLE DRIVE', 'success', 'qcm-submittal');
            log(`Filename: ${filename}`, 'info', 'qcm-submittal');
            log(`Location: Guatemala_SOUTHCOM/Submittals/Reviews/`, 'info', 'qcm-submittal');
            log('', 'info', 'qcm-submittal');
            log('In production, this would:', 'success', 'qcm-submittal');
            log('  1. Generate PDF from review content', 'info', 'qcm-submittal');
            log('  2. Upload to specified Drive folder', 'info', 'qcm-submittal');
            log('  3. Share link with project team', 'info', 'qcm-submittal');
            log('  4. Update review log', 'info', 'qcm-submittal');
            log('', 'info', 'qcm-submittal');
            
            alert('Review saved to Google Drive!\n\nFilename: ' + filename + '\nLocation: Guatemala_SOUTHCOM/Submittals/Reviews/\n\n(In production, you would receive a Drive link)');
        }
        
        // Download review as PDF
        function downloadReviewPDF() {
            const date = new Date().toISOString().split('T')[0];
            const filename = `Submittal_001_Steel_Review_${date}.pdf`;
            
            log('Downloading review as PDF...', 'success', 'qcm-submittal');
            log(`Filename: ${filename}`, 'info', 'qcm-submittal');
            log('', 'info', 'qcm-submittal');
            log('In production, this would generate and download PDF', 'info', 'qcm-submittal');
            
            alert('PDF download initiated!\n\nFilename: ' + filename + '\n\n(In production, PDF would start downloading now)');
        }
        
        // Open review history terminal tab
        function openReviewHistory() {
            // Hide all terminal bodies
            document.querySelectorAll('.terminal-body').forEach(body => {
                body.style.display = 'none';
            });
            
            // Show review history tab
            document.getElementById('terminal-review-history').style.display = 'block';
            
            // Render review history
            renderReviewHistory();
            
            log('Review history opened', 'success', 'main');
        }
        
        // Save to review history
        function saveToReviewHistory() {
            const history = JSON.parse(localStorage.getItem('qcm_review_history') || '[]');
            
            const review = {
                id: 'rev_' + Date.now(),
                date: new Date().toISOString(),
                submittalName: 'Submittal 001 - Structural Steel',
                filesCount: qcmSelectedFiles.length,
                recommendation: 'APPROVE AS NOTED',
                deficiencies: 3,
                status: 'complete'
            };
            
            history.unshift(review); // Add to beginning
            
            // Keep only last 20 reviews
            if (history.length > 20) {
                history.length = 20;
            }
            
            localStorage.setItem('qcm_review_history', JSON.stringify(history));
        }
        
        // Render review history list
        function renderReviewHistory() {
            const history = JSON.parse(localStorage.getItem('qcm_review_history') || '[]');
            const historyList = document.getElementById('reviewHistoryList');
            
            if (history.length === 0) {
                historyList.innerHTML = `
                    <div class="info" style="padding: 20px; text-align: center;">
                        No review history yet. Complete a submittal review to see it here.
                    </div>
                `;
                return;
            }
            
            const html = history.map(review => {
                const date = new Date(review.date).toLocaleDateString();
                const time = new Date(review.date).toLocaleTimeString();
                
                let statusColor = '#4caf50'; // green
                if (review.recommendation.includes('REVISE')) statusColor = '#dc3545'; // red
                else if (review.recommendation.includes('NOTED')) statusColor = '#ffc107'; // yellow
                
                return `
                    <div style="padding: 15px; margin-bottom: 10px; background: rgba(45, 24, 16, 0.6); border-left: 3px solid ${statusColor}; border-radius: 4px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <div style="font-weight: bold; color: var(--orange-light);">${review.submittalName}</div>
                            <div style="font-size: 0.85rem; color: var(--gray-light);">${date} ${time}</div>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px; font-size: 0.85rem;">
                            <div>
                                <div style="color: var(--gray-light);">Documents</div>
                                <div style="color: var(--cream); font-weight: 500;">${review.filesCount} files</div>
                            </div>
                            <div>
                                <div style="color: var(--gray-light);">Deficiencies</div>
                                <div style="color: var(--cream); font-weight: 500;">${review.deficiencies} items</div>
                            </div>
                            <div>
                                <div style="color: var(--gray-light);">Recommendation</div>
                                <div style="color: ${statusColor}; font-weight: 500;">${review.recommendation}</div>
                            </div>
                        </div>
                        <div style="margin-top: 10px; display: flex; gap: 8px;">
                            <button class="session-btn" onclick="alert('In production: Re-open this review')" style="font-size: 0.75rem; padding: 4px 8px;">
                                 View
                            </button>
                            <button class="session-btn" onclick="alert('In production: Download PDF')" style="font-size: 0.75rem; padding: 4px 8px;">
                                PDF
                            </button>
                            <button class="session-btn" onclick="alert('In production: Open in Drive')" style="font-size: 0.75rem; padding: 4px 8px;">
                                 Drive Link
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            historyList.innerHTML = `
                <div style="margin-bottom: 15px; padding: 10px; background: rgba(232, 146, 42, 0.1); border-left: 3px solid var(--orange-mid); border-radius: 4px;">
                    <strong style="color: var(--orange-light);">Review History</strong>  ${history.length} review${history.length > 1 ? 's' : ''} completed
                </div>
                ${html}
            `;
        }
    </script>
</body>
</html>
